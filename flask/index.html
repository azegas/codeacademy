<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-02-22 Wed 19:33 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CodeAcademy Flask</title>
<meta name="author" content="arvydas" />
<meta name="description" content="CodeAcademy Flask notes" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">CodeAcademy Flask</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org7cf8bbd">1. Įžanga į Flask</a>
<ul>
<li><a href="#org008f098">1.1. Kaip sukurti minimalią svetainę:</a></li>
<li><a href="#org20ad674">1.2. Kaip puslapyje atvaizduoti įvestą kintamąjį:</a></li>
<li><a href="#org8fe5f62">1.3. Kaip sukurti ir panaudoti HTML šabloną:</a></li>
<li><a href="#org797a742">1.4. Kaip kintamuosius perkelti į šabloną:</a></li>
<li><a href="#org3126a4d">1.5. Kaip perduoti duomenis iš svetainės į programą:</a></li>
<li><a href="#orgf4d13b6">1.6. Naudojame base.html šabloną:</a></li>
<li><a href="#org5c592c9">1.7. Stiliui panaudojame "Bootstrap":</a></li>
<li><a href="#org6e02deb">1.8. Užduotys</a></li>
</ul>
</li>
<li><a href="#org261fd96">2. Flask 1 dalis</a>
<ul>
<li><a href="#org0826bd9">2.1. Susikurkime paprastą flask aplikaciją</a></li>
</ul>
</li>
<li><a href="#org3d6d855">3. Flask 2 dalis</a>
<ul>
<li><a href="#orgbb1fbe8">3.1. Dinaminiai maršrutai ir formos</a></li>
<li><a href="#orge14d2da">3.2. Uzduotis</a></li>
</ul>
</li>
<li><a href="#orga352e92">4. Flask 3 dalis</a>
<ul>
<li><a href="#org2d2ce98">4.1. Duomenų bazės sukūrimas</a></li>
<li><a href="#orgf4fd6bc">4.2. Duomenų bazės migracija</a></li>
<li><a href="#org886b244">4.3. Uzduotis</a></li>
</ul>
</li>
<li><a href="#org5a5b87a">5. Flask 4 dalis</a>
<ul>
<li><a href="#org7e904f0">5.1. One2Many</a></li>
<li><a href="#org9afe2d2">5.2. Many2Many</a></li>
<li><a href="#org5c4c7fe">5.3. Many2One ryšio įgyvendinimas su Flask</a></li>
<li><a href="#org788562b">5.4. One2Many ryšio įgyvendinimas su Flask</a></li>
<li><a href="#org55c833f">5.5. Many2Many ryšio įgyvendinimas su Flask</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org7cf8bbd" class="outline-2">
<h2 id="org7cf8bbd"><span class="section-number-2">1.</span> Įžanga į Flask</h2>
<div class="outline-text-2" id="text-1">
<p>
Flask yra populiariausias Python microframework. Jeigu projektas nėra
labai didelis, arba tiesiog norime pasidaryti kažkokį GUI per
naršyklę, kažką greitai prototipuoti, Flask yra labai geras
pasirinkimas. Su flask yra pakankamai paprasta kurti API's. Ši
paskaita bus greita įžanga, kitose nagrinėsime išsamiau.
</p>

<p>
Flask galima įdiegti su pip naudojant <code>pip install flask</code>.
</p>
</div>

<div id="outline-container-org008f098" class="outline-3">
<h3 id="org008f098"><span class="section-number-3">1.1.</span> Kaip sukurti minimalią svetainę:</h3>
<div class="outline-text-3" id="text-1-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask

<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">home</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> <span style="color: #b8bb26;">"&lt;h1&gt;&#268;ia mano naujas puslapis&lt;/h1&gt;"</span>

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">(</span>debug=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>:
</pre>
</div>
</div>
</div>

<div id="outline-container-org20ad674" class="outline-3">
<h3 id="org20ad674"><span class="section-number-3">1.2.</span> Kaip puslapyje atvaizduoti įvestą kintamąjį:</h3>
<div class="outline-text-3" id="text-1-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask

<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/&lt;name&gt;"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">user</span><span style="color: #fe8019;">(</span>name<span style="color: #fe8019;">)</span>:
    <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">"Labas, </span>{name}<span style="color: #b8bb26;">"</span>

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">()</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8fe5f62" class="outline-3">
<h3 id="org8fe5f62"><span class="section-number-3">1.3.</span> Kaip sukurti ir panaudoti HTML šabloną:</h3>
<div class="outline-text-3" id="text-1-3">
<p>
main.py:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, render_template

<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">user</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"index.html"</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">()</span>
</pre>
</div>

<p>
templates/index.html:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Mano Puslapis</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Labas, pasauli!</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>

<p>
Įdėkime į šabloną šiek tiek logikos:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Skai&#269;iavimai</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Skai&#269;iavimai: </span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
{<span style="color: #83a598;">%for</span> x in range(10)%}
{<span style="color: #83a598;">%if</span> x % 2 == 0 %}
&lt;<span style="color: #b8bb26;">p</span>&gt;{{x}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
{% endif %}
{<span style="color: #83a598;">%endfor</span>%}
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org797a742" class="outline-3">
<h3 id="org797a742"><span class="section-number-3">1.4.</span> Kaip kintamuosius perkelti į šabloną:</h3>
<div class="outline-text-3" id="text-1-4">
<p>
main.py
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, render_template

<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">home</span><span style="color: #fe8019;">()</span>:
    <span style="color: #83a598;">vardai</span> = <span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'Jonas'</span>, <span style="color: #b8bb26;">'Antanas'</span>, <span style="color: #b8bb26;">'Petras'</span><span style="color: #fe8019;">]</span>
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"index.html"</span>, sarasas=vardai<span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">()</span>
</pre>
</div>

<p>
templates/index.html
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Sara&#353;as</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">&#381;moni&#371; sara&#353;as: </span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
{<span style="color: #83a598;">%for</span> vardas in sarasas%}
&lt;<span style="color: #b8bb26;">p</span>&gt;{{vardas}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
{% endfor %}
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org3126a4d" class="outline-3">
<h3 id="org3126a4d"><span class="section-number-3">1.5.</span> Kaip perduoti duomenis iš svetainės į programą:</h3>
<div class="outline-text-3" id="text-1-5">
<p>
main.py
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, request, render_template
<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/login"</span>, methods=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">'GET'</span>, <span style="color: #b8bb26;">'POST'</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">login</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">if</span> request.method == <span style="color: #b8bb26;">"POST"</span>:
        vardas = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'vardas'</span><span style="color: #fe8019;">]</span>
        <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"greetings.html"</span>, vardas=vardas<span style="color: #fe8019;">)</span>
    <span style="color: #fb4934;">else</span>:
        <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"login.html"</span><span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">()</span>
</pre>
</div>

<p>
templates/index.html
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Prisijungimas</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
&lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"#"</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;Vardas:&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"vardas"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"submit"</span> <span style="color: #83a598;">value</span>=<span style="color: #b8bb26;">"submit"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;/<span style="color: #b8bb26;">form</span>&gt;
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>


<p>
templates/greetings.html
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Sveikiname</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">{{vardas}}, sveikiname prisijungus!</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf4d13b6" class="outline-3">
<h3 id="orgf4d13b6"><span class="section-number-3">1.6.</span> Naudojame base.html šabloną:</h3>
<div class="outline-text-3" id="text-1-6">
<p>
Failas templates/base.html:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
  &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Mano puslapis</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
&lt;<span style="color: #b8bb26;">div</span>&gt;
  &lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Sveiki,</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
  &lt;<span style="color: #b8bb26;">p</span>&gt;&#268;ia yra mano super puslapis!&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;/<span style="color: #b8bb26;">div</span>&gt;
&lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"container"</span>&gt;
  {% block content %}{% endblock %}
&lt;/<span style="color: #b8bb26;">div</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>

<p>
Failas templates/login.html:
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}
{% block content %}
&lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"#"</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;Vardas:&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"vardas"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"submit"</span> <span style="color: #83a598;">value</span>=<span style="color: #b8bb26;">"submit"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;/<span style="color: #b8bb26;">form</span>&gt;
{% endblock %}
</pre>
</div>

<p>
Failas templates/greetings.html:
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}
{% block content %}
&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">{{vardas}}, sveikiname prisijungus!</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
{% endblock %}
</pre>
</div>
</div>
</div>

<div id="outline-container-org5c592c9" class="outline-3">
<h3 id="org5c592c9"><span class="section-number-3">1.7.</span> Stiliui panaudojame "Bootstrap":</h3>
<div class="outline-text-3" id="text-1-7">
<p>
Faile base.html:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
  &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Mano puslapis</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
  &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"utf-8"</span>&gt;
  &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"viewport"</span> <span style="color: #83a598;">content</span>=<span style="color: #b8bb26;">"width=device-width, initial-scale=1"</span>&gt;
  &lt;<span style="color: #b8bb26;">link</span> <span style="color: #83a598;">rel</span>=<span style="color: #b8bb26;">"stylesheet"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"</span>&gt;
  &lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
  &lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
  &lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;

<span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">Navigation</span><span style="color: #928374;"> --&gt;</span>
&lt;<span style="color: #b8bb26;">nav</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar navbar-expand-lg navbar-light bg-light static-top mb-5 shadow"</span>&gt;
  &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"container"</span>&gt;
    &lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-brand"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"#"</span>&gt;
    Mano puslapis&lt;/<span style="color: #b8bb26;">a</span>&gt;
    &lt;<span style="color: #b8bb26;">button</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-toggler"</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"button"</span> <span style="color: #83a598;">data-toggle</span>=<span style="color: #b8bb26;">"collapse"</span> <span style="color: #83a598;">data-target</span>=<span style="color: #b8bb26;">"#navbarResponsive"</span> <span style="color: #83a598;">aria-controls</span>=<span style="color: #b8bb26;">"navbarResponsive"</span> <span style="color: #83a598;">aria-expanded</span>=<span style="color: #b8bb26;">"false"</span> <span style="color: #83a598;">aria-label</span>=<span style="color: #b8bb26;">"Toggle navigation"</span>&gt;
          &lt;<span style="color: #b8bb26;">span</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-toggler-icon"</span>&gt;&lt;/<span style="color: #b8bb26;">span</span>&gt;
        &lt;/<span style="color: #b8bb26;">button</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"collapse navbar-collapse"</span> <span style="color: #83a598;">id</span>=<span style="color: #b8bb26;">"navbarResponsive"</span>&gt;
      &lt;<span style="color: #b8bb26;">ul</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-nav ml-auto"</span>&gt;
        &lt;<span style="color: #b8bb26;">li</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-item"</span>&gt;
          &lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-link"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"/login"</span>&gt;Prisijungti&lt;/<span style="color: #b8bb26;">a</span>&gt;
        &lt;/<span style="color: #b8bb26;">li</span>&gt;
      &lt;/<span style="color: #b8bb26;">ul</span>&gt;
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
  &lt;/<span style="color: #b8bb26;">div</span>&gt;
&lt;/<span style="color: #b8bb26;">nav</span>&gt;

&lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"jumbotron text-center"</span>&gt;
  &lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Sveiki,</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
  &lt;<span style="color: #b8bb26;">p</span>&gt;&#268;ia yra mano super puslapis!&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;/<span style="color: #b8bb26;">div</span>&gt;

&lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"container"</span>&gt;
{% block content %}{% endblock %}
&lt;/<span style="color: #b8bb26;">div</span>&gt;

&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org6e02deb" class="outline-3">
<h3 id="org6e02deb"><span class="section-number-3">1.8.</span> Užduotys</h3>
<div class="outline-text-3" id="text-1-8">
</div>
<div id="outline-container-orgace3491" class="outline-4">
<h4 id="orgace3491"><span class="section-number-4">1.8.1.</span> 1 užduotis</h4>
<div class="outline-text-4" id="text-1-8-1">
<p>
Sukurti programą, kuri turėtų statinį puslapį, pvz. localhost:5000 su
norimu tekstu (rekomenduojama naudoti šablonus)
</p>

<p>
main.py
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, render_template

<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">home</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"home.html"</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">(</span>debug=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
template/home.html
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Labas</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
    &lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Norimas tekstas</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>


<div id="orgc4d5829" class="figure">
<p><img src="./static/images/1.png" alt="1.png" width="600px" />
</p>
</div>
</div>
</div>

<div id="outline-container-org7abd602" class="outline-4">
<h4 id="org7abd602"><span class="section-number-4">1.8.2.</span> 2 užduotis</h4>
<div class="outline-text-4" id="text-1-8-2">
<p>
Sukurti programą, kuri įvedus norimą žodį adreso eilutėje (po /
simbolio) ir paspaudus ENTER, atspausdintų jį penkis kartus.
</p>

<p>
Still not sure where this is useful.
</p>

<p>
main.py
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, render_template

<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/&lt;word&gt;"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">word</span><span style="color: #fe8019;">(</span>word<span style="color: #fe8019;">)</span>:
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"word.html"</span>, word = word<span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">(</span>debug=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
templates/word.html
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">&#381;od&#382;iai</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
    {% for x in range(5) %}
        {{word}}
    {% endfor %}
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>



<div id="org1963937" class="figure">
<p><img src="./static/images/2.png" alt="2.png" width="600px" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgef30a06" class="outline-4">
<h4 id="orgef30a06"><span class="section-number-4">1.8.3.</span> 3 užduotis</h4>
<div class="outline-text-4" id="text-1-8-3">
<p>
Sukurti programą, kuri puslapyje localhost:5000/keliamieji parodytų
visus keliamuosius metus nuo 1900 iki 2100 metų.
</p>

<p>
Cool use of calendar.
</p>

<p>
main.py
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, render_template
<span style="color: #fb4934;">import</span> calendar

<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/keliamieji"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">leap</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"leap.html"</span>, calendar = calendar<span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">(</span>debug=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
templates/leap.html
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Leap</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
    {% for year in range(1900, 2100) %}
    {% if calendar.isleap(year) %}
    {{year}}
    {% endif %}
    {% endfor %}
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>


<div id="org8b81375" class="figure">
<p><img src="./static/images/3.png" alt="3.png" width="600px" />
</p>
</div>
</div>
</div>

<div id="outline-container-org81b860a" class="outline-4">
<h4 id="org81b860a"><span class="section-number-4">1.8.4.</span> 4 užduotis</h4>
<div class="outline-text-4" id="text-1-8-4">
<p>
Sukurti programą, kuri leistų įvesti metus ir paspaudus patvirtinimo
mygtuką parodytų, ar jie yra keliamieji.
</p>

<p>
main.py
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, render_template, request
<span style="color: #fb4934;">import</span> calendar

<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>


<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">home</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> <span style="color: #b8bb26;">"&lt;h1&gt;Labas, cia yra pradinis&lt;/h1&gt;&lt;p&gt;Paziurek kas slepiasi po http://localhost:5000/arkeliamieji&lt;/p&gt;"</span>


<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/arkeliamieji"</span>, methods=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">"GET"</span>, <span style="color: #b8bb26;">"POST"</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">isleap</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">if</span> request.method == <span style="color: #b8bb26;">"GET"</span>:
        <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"getyear.html"</span><span style="color: #fe8019;">)</span>
    <span style="color: #fb4934;">elif</span> request.method == <span style="color: #b8bb26;">"POST"</span>:
        year = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">"year"</span><span style="color: #fe8019;">]</span>
        <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"isleap.html"</span>, year=<span style="color: #fe8019;">int</span><span style="color: #cc241d;">(</span>year<span style="color: #cc241d;">)</span>, calendar=calendar<span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">(</span>debug=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
templates/getyear.html
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Get Year</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
&lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"#"</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;Metai:&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"year"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"submit"</span> <span style="color: #83a598;">value</span>=<span style="color: #b8bb26;">"Patikrinti"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;/<span style="color: #b8bb26;">form</span>&gt;
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>

<p>
templates/isleap.html
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Is Leap</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
    {% if calendar.isleap(year) %}
    &lt;<span style="color: #b8bb26;">p</span>&gt;Keliamieji&lt;/<span style="color: #b8bb26;">p</span>&gt;
    {% else %}
    &lt;<span style="color: #b8bb26;">p</span>&gt;Nekeliamieji&lt;/<span style="color: #b8bb26;">p</span>&gt;
    {% endif %}
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>


<div id="orgabdb928" class="figure">
<p><img src="./static/images/4.gif" alt="4.gif" width="600px" />
</p>
</div>
</div>
</div>


<div id="outline-container-org5d25279" class="outline-4">
<h4 id="org5d25279"><span class="section-number-4">1.8.5.</span> 5 užduotis (papildomai)</h4>
<div class="outline-text-4" id="text-1-8-5">
<p>
Patobulinti anksčiau kurtą biudžeto programą, panaudojant Flask
(bendravimui su vartotoju) ir SQLAlchemy (darbui su duomenų baze,
kurioje bus saugomi pajamų ir išlaidų įrašai).
</p>

<p>
Run db.py file first to create a database:
</p>

<p>
db.py
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">import</span> datetime
<span style="color: #fb4934;">import</span> os
<span style="color: #fb4934;">from</span> sqlalchemy <span style="color: #fb4934;">import</span> Column, Integer, String, Float, DateTime, create_engine
<span style="color: #fb4934;">from</span> sqlalchemy.ext.declarative <span style="color: #fb4934;">import</span> declarative_base

<span style="color: #83a598;">engine</span> = create_engine<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"sqlite:///.db"</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">Base</span> = declarative_base<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Projektas</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    <span style="color: #83a598;">__tablename__</span> = <span style="color: #b8bb26;">"Projektas"</span>
    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    name = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Pavadinimas"</span>, String<span style="color: #fe8019;">)</span>
    price = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Kaina"</span>, Float<span style="color: #fe8019;">)</span>
    created_date = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Suk&#363;rimo data"</span>, DateTime, default=datetime.datetime.utcnow<span style="color: #fe8019;">)</span>

    <span style="color: #928374;"># </span><span style="color: #928374;">aprasom taip pat kaip paprasta klase. Asocijuojam su klase. Kad zinotu i kuri collumn deti kintamaji</span>
    <span style="color: #928374;"># </span><span style="color: #928374;">created_date matai neidetas apacioje, nes nereikia jo mum patiem irasyti, jis turi default reiksme</span>
    <span style="color: #928374;"># </span><span style="color: #928374;">jeigu noretum irasyti ir keisti - tuomet prie init turetum prirasyti</span>
    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__init__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, name, price<span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">self</span>.name = name
        <span style="color: #fb4934;">self</span>.price = price

    <span style="color: #928374;"># </span><span style="color: #928374;">Kada kvieciam klase su query, kad ja israsytu ir KAIP israsytu apibudinam cia</span>
    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">"</span>{<span style="color: #fb4934;">self</span>.<span style="color: #fe8019;">id</span>}<span style="color: #b8bb26;"> </span>{<span style="color: #fb4934;">self</span>.name}<span style="color: #b8bb26;"> - </span>{<span style="color: #fb4934;">self</span>.price}<span style="color: #b8bb26;">: </span>{<span style="color: #fb4934;">self</span>.created_date}<span style="color: #b8bb26;">"</span>


<span style="color: #928374;"># </span><span style="color: #928374;">kviecia connectiona ir sukuria visas lenteles jeigu jos neegzistuoja. Jos neupdeitins.</span>
Base.metadata.create_all<span style="color: #fe8019;">(</span>engine<span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
main.py
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">import</span> os
<span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, request, render_template, url_for, redirect
<span style="color: #fb4934;">from</span> flask_sqlalchemy <span style="color: #fb4934;">import</span> SQLAlchemy

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    <span style="color: #fb4934;">from</span> models.irasas <span style="color: #fb4934;">import</span> Irasas

basedir = os.path.abspath<span style="color: #fe8019;">(</span>os.path.dirname<span style="color: #cc241d;">(</span>__file__<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
app = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>


app.config<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">"SQLALCHEMY_DATABASE_URI"</span><span style="color: #fe8019;">]</span> = <span style="color: #b8bb26;">"sqlite:///"</span> + os.path.join<span style="color: #fe8019;">(</span>basedir, <span style="color: #b8bb26;">"biudzetas.db"</span><span style="color: #fe8019;">)</span>
app.config<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">"SQLALCHEMY_TRACK_MODIFICATIONS"</span><span style="color: #fe8019;">]</span> = <span style="color: #d3869b;">False</span>
db = SQLAlchemy<span style="color: #fe8019;">(</span>app<span style="color: #fe8019;">)</span>

db.create_all<span style="color: #fe8019;">()</span>


<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/prideti"</span>, methods=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">"GET"</span>, <span style="color: #b8bb26;">"POST"</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">prideti</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">if</span> request.method == <span style="color: #b8bb26;">"POST"</span>:
        suma = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">"suma"</span><span style="color: #fe8019;">]</span>
        info = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">"info"</span><span style="color: #fe8019;">]</span>
        irasas = Irasas<span style="color: #fe8019;">(</span>suma, info<span style="color: #fe8019;">)</span>
        db.session.add<span style="color: #fe8019;">(</span>irasas<span style="color: #fe8019;">)</span>
        db.session.commit<span style="color: #fe8019;">()</span>
        <span style="color: #fb4934;">return</span> sarasas<span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">elif</span> request.method == <span style="color: #b8bb26;">"GET"</span>:
        <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"prideti.html"</span><span style="color: #fe8019;">)</span>


<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">sarasas</span><span style="color: #fe8019;">()</span>:
    biudzetas = Irasas.query.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"sarasas.html"</span>, biudzetas=biudzetas<span style="color: #fe8019;">)</span>


<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/balansas"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">balansas</span><span style="color: #fe8019;">()</span>:
    biudzetas = db.session.query<span style="color: #fe8019;">(</span>Irasas<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>
    balansas = 0
    <span style="color: #fb4934;">for</span> irasas <span style="color: #fb4934;">in</span> biudzetas:
        balansas += irasas.suma
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"balansas.html"</span>, balansas=balansas<span style="color: #fe8019;">)</span>


<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/irasas_delete/&lt;int:id&gt;"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">irasas_delete</span><span style="color: #fe8019;">(</span><span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>:
    uzklausa = db.session.query<span style="color: #fe8019;">(</span>Irasas<span style="color: #fe8019;">)</span>.get<span style="color: #fe8019;">(</span><span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>
    db.session.delete<span style="color: #fe8019;">(</span>uzklausa<span style="color: #fe8019;">)</span>
    db.session.commit<span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">return</span> redirect<span style="color: #fe8019;">(</span>url_for<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">"sarasas"</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>


<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/irasas_update/&lt;int:id&gt;"</span>, methods=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">"GET"</span>, <span style="color: #b8bb26;">"POST"</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">irasas_update</span><span style="color: #fe8019;">(</span><span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>:
    <span style="color: #fb4934;">if</span> request.method == <span style="color: #b8bb26;">"POST"</span>:
        irasas = db.session.query<span style="color: #fe8019;">(</span>Irasas<span style="color: #fe8019;">)</span>.get<span style="color: #fe8019;">(</span><span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>
        irasas.suma = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">"suma"</span><span style="color: #fe8019;">]</span>
        irasas.info = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">"info"</span><span style="color: #fe8019;">]</span>
        db.session.commit<span style="color: #fe8019;">()</span>
        <span style="color: #fb4934;">return</span> redirect<span style="color: #fe8019;">(</span>url_for<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">"sarasas"</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    <span style="color: #fb4934;">elif</span> request.method == <span style="color: #b8bb26;">"GET"</span>:
        irasas = db.session.query<span style="color: #fe8019;">(</span>Irasas<span style="color: #fe8019;">)</span>.get<span style="color: #fe8019;">(</span><span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>
        <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"redaguoti.html"</span>, irasas=irasas<span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">(</span>debug=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
models/irasas.py
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> main <span style="color: #fb4934;">import</span> db


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Irasas</span><span style="color: #fe8019;">(</span>db.Model<span style="color: #fe8019;">)</span>:
    <span style="color: #83a598;">__tablename__</span> = <span style="color: #b8bb26;">"Irasas"</span>
    <span style="color: #fe8019;">id</span> = db.Column<span style="color: #fe8019;">(</span>db.Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    suma = db.Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Suma"</span>, db.Float<span style="color: #fe8019;">)</span>
    info = db.Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Info"</span>, db.String<span style="color: #cc241d;">(</span>120<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__init__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, suma, info<span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">self</span>.suma = suma
        <span style="color: #fb4934;">self</span>.info = info

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">"</span>{<span style="color: #fb4934;">self</span>.<span style="color: #fe8019;">id</span>}<span style="color: #b8bb26;">: suma - </span>{<span style="color: #fb4934;">self</span>.suma}<span style="color: #b8bb26;">, info - </span>{<span style="color: #fb4934;">self</span>.info}<span style="color: #b8bb26;">"</span>


db.create_all<span style="color: #fe8019;">()</span>
</pre>
</div>

<p>
templates/balansas.html
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}
{% block content %}
    &lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Balansas: </span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;{{balansas}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
{% endblock %}
</pre>
</div>

<p>
templates/prideti.html
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}
{% block content %}
&lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"#"</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;Suma:&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"suma"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;Info:&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"info"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"submit"</span> <span style="color: #83a598;">value</span>=<span style="color: #b8bb26;">"&#302;vesti"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;/<span style="color: #b8bb26;">form</span>&gt;
{% endblock %}
</pre>
</div>

<p>
templates/redaguoti.html
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}
{% block content %}
&lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"#"</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;Suma:&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"suma"</span> value={{irasas.suma}} /&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;Info:&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"info"</span> value={{irasas.info}} /&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"submit"</span> <span style="color: #83a598;">value</span>=<span style="color: #b8bb26;">"&#302;vesti"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;/<span style="color: #b8bb26;">form</span>&gt;
{% endblock %}&gt;
</pre>
</div>

<p>
templates/sarasas.html
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}
{% block content %}
&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Biud&#382;eto &#303;ra&#353;ai: </span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
{<span style="color: #83a598;">%for</span> irasas in biudzetas%}
&lt;<span style="color: #b8bb26;">p</span>&gt;{{irasas}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"{{ url_for('irasas_delete', id=irasas['id']) }}"</span>&gt;I&#353;trinti&lt;/<span style="color: #b8bb26;">a</span>&gt;
&lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"{{ url_for('irasas_update', id=irasas['id']) }}"</span>&gt;Redaguoti&lt;/<span style="color: #b8bb26;">a</span>&gt;
&lt;<span style="color: #b8bb26;">hr</span>&gt;
{% endfor %}
{% endblock %}
</pre>
</div>

<p>
templates/base.html
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
  &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Mano biud&#382;etas</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
  &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"utf-8"</span>&gt;
  &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"viewport"</span> <span style="color: #83a598;">content</span>=<span style="color: #b8bb26;">"width=device-width, initial-scale=1"</span>&gt;
  &lt;<span style="color: #b8bb26;">link</span> <span style="color: #83a598;">rel</span>=<span style="color: #b8bb26;">"stylesheet"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"</span>&gt;
  &lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
  &lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
  &lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;

<span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">Navigation</span><span style="color: #928374;"> --&gt;</span>
&lt;<span style="color: #b8bb26;">nav</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar navbar-expand-lg navbar-light bg-light static-top mb-5 shadow"</span>&gt;
  &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"container"</span>&gt;
    &lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-brand"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"#"</span>&gt;
    &lt;<span style="color: #b8bb26;">svg</span> <span style="color: #83a598;">width</span>=<span style="color: #b8bb26;">"1em"</span> <span style="color: #83a598;">height</span>=<span style="color: #b8bb26;">"1em"</span> <span style="color: #83a598;">viewBox</span>=<span style="color: #b8bb26;">"0 0 16 16"</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"bi bi-cash"</span> <span style="color: #83a598;">fill</span>=<span style="color: #b8bb26;">"currentColor"</span> <span style="color: #83a598;">xmlns</span>=<span style="color: #b8bb26;">"http://www.w3.org/2000/svg"</span>&gt;
    &lt;<span style="color: #b8bb26;">path</span> <span style="color: #83a598;">fill-rule</span>=<span style="color: #b8bb26;">"evenodd"</span> <span style="color: #83a598;">d</span>=<span style="color: #b8bb26;">"M15 4H1v8h14V4zM1 3a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1H1z"</span>/&gt;
    &lt;<span style="color: #b8bb26;">path</span> <span style="color: #83a598;">d</span>=<span style="color: #b8bb26;">"M13 4a2 2 0 0 0 2 2V4h-2zM3 4a2 2 0 0 1-2 2V4h2zm10 8a2 2 0 0 1 2-2v2h-2zM3 12a2 2 0 0 0-2-2v2h2zm7-4a2 2 0 1 1-4 0 2 2 0 0 1 4 0z"</span>/&gt;
    &lt;/<span style="color: #b8bb26;">svg</span>&gt;
    Mano biud&#382;etas&lt;/<span style="color: #b8bb26;">a</span>&gt;
    &lt;<span style="color: #b8bb26;">button</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-toggler"</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"button"</span> <span style="color: #83a598;">data-toggle</span>=<span style="color: #b8bb26;">"collapse"</span> <span style="color: #83a598;">data-target</span>=<span style="color: #b8bb26;">"#navbarResponsive"</span> <span style="color: #83a598;">aria-controls</span>=<span style="color: #b8bb26;">"navbarResponsive"</span> <span style="color: #83a598;">aria-expanded</span>=<span style="color: #b8bb26;">"false"</span> <span style="color: #83a598;">aria-label</span>=<span style="color: #b8bb26;">"Toggle navigation"</span>&gt;
          &lt;<span style="color: #b8bb26;">span</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-toggler-icon"</span>&gt;&lt;/<span style="color: #b8bb26;">span</span>&gt;
        &lt;/<span style="color: #b8bb26;">button</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"collapse navbar-collapse"</span> <span style="color: #83a598;">id</span>=<span style="color: #b8bb26;">"navbarResponsive"</span>&gt;
      &lt;<span style="color: #b8bb26;">ul</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-nav ml-auto"</span>&gt;
        &lt;<span style="color: #b8bb26;">li</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-item"</span>&gt;
          &lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-link"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"/"</span>&gt;S&#261;ra&#353;as&lt;/<span style="color: #b8bb26;">a</span>&gt;
        &lt;/<span style="color: #b8bb26;">li</span>&gt;
        &lt;<span style="color: #b8bb26;">li</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-item"</span>&gt;
          &lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-link"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"/balansas"</span>&gt;Balansas&lt;/<span style="color: #b8bb26;">a</span>&gt;
        &lt;/<span style="color: #b8bb26;">li</span>&gt;
        &lt;<span style="color: #b8bb26;">li</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-item"</span>&gt;
            &lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-link"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"/prideti"</span>&gt;Prid&#279;ti&lt;/<span style="color: #b8bb26;">a</span>&gt;
        &lt;/<span style="color: #b8bb26;">li</span>&gt;
      &lt;/<span style="color: #b8bb26;">ul</span>&gt;
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
  &lt;/<span style="color: #b8bb26;">div</span>&gt;
&lt;/<span style="color: #b8bb26;">nav</span>&gt;

&lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"container"</span>&gt;
    {% block content %}{% endblock %}
&lt;/<span style="color: #b8bb26;">div</span>&gt;

&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>

<p>
Run main.py and open <a href="http://127.0.0.1:5000">http://127.0.0.1:5000</a>, see the magic :)
</p>


<div id="orgf0c85b0" class="figure">
<p><img src="./static/images/5.gif" alt="5.gif" width="600px" />
</p>
</div>

<p>
<code>Important notes</code>!!
</p>

<p>
Jeigu norite paleistį šį projektą savo kompiuteryje, prieš tai
įsitikinkite, jog turite šiam projektui reikiamą flask_sqlalchemy
v2.5.1 versiją.
</p>

<p>
Tai galite padaryti savo virtualioje, šiam projektui skirtoje python
aplinkoje. Terminale tiesiog paleiskite šią komandą, kad įrašyti
reikiamą flask-sqlalchemy versiją:
</p>

<p>
<code>pip install flask-sqlalchemy==2.5.1</code>
</p>

<p>
Arba galite pasinaudoti requirements.txt. failiuku ir vos tik
parsisiuntus šį branch į savo kompiuterį ir pasiruošus virtualią
aplinką, susirašyti visas šiam projektui būtinas "dependencies" su šia
komanda:
</p>

<p>
<code>pip install -r requirements.txt</code>
</p>

<p>
requirements.txt
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #83a598;">click</span>==8.1.3
<span style="color: #83a598;">Flask</span>==2.2.2
Flask-SQLAlchemy==2.5.1
<span style="color: #83a598;">greenlet</span>==2.0.1
importlib-metadata==6.0.0
<span style="color: #83a598;">itsdangerous</span>==2.1.2
<span style="color: #83a598;">Jinja2</span>==3.1.2
<span style="color: #83a598;">MarkupSafe</span>==2.1.2
<span style="color: #83a598;">SQLAlchemy</span>==1.4.46
<span style="color: #83a598;">Werkzeug</span>==2.2.2
<span style="color: #83a598;">zipp</span>==3.11.0
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org261fd96" class="outline-2">
<h2 id="org261fd96"><span class="section-number-2">2.</span> Flask 1 dalis</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org0826bd9" class="outline-3">
<h3 id="org0826bd9"><span class="section-number-3">2.1.</span> Susikurkime paprastą flask aplikaciją</h3>
<div class="outline-text-3" id="text-2-1">
<p>
app.py:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, render_template
<span style="color: #928374;"># </span><span style="color: #928374;">i&#353; flask bibliotekos importuojame klas&#281; Flask ir f-j&#261; render_template.</span>
<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">inicijuojame klas&#279;s Flask objekt&#261;, priskiriame kintam&#261;jam app.</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'/'</span><span style="color: #fe8019;">)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">&#303;velkame f-j&#261; &#303; flask dekoratori&#371;. Be jo  funkcija b&#363;t&#371; bereik&#353;m&#279;. Dekorato riaus parametruose nurodome, kad nor&#279;sime rezultato 127.0.0.1:8000/ url adrese."""</span>

<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">index</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'index.html'</span><span style="color: #fe8019;">)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">funkcijoje index nurodome, kad nor&#279;sime sugeneruoti index.html</span>

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">'__main__'</span>:
  app.run<span style="color: #fe8019;">(</span>host=<span style="color: #b8bb26;">'127.0.0.1'</span>, port=8000, debug=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">patikrin&#281;, ar programa leid&#382;iama ne i&#353; kito failo, leid&#382;iame m&#363;s&#371; app, su parametrais. debug = True klaidos atveju mums rodys informatyvias &#382;inutes nar&#353;ykl&#279;je.</span>
</pre>
</div>

<p>
Komentaruose šiek tiek informacijos, kas vyksta. Dabar mums reikės
susikurti html šabloną. Flask šablonų ieško templates kataloge. :
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"viewport"</span> <span style="color: #83a598;">content</span>=<span style="color: #b8bb26;">"width=device-width, initial-scale=1.0"</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">http-equiv</span>=<span style="color: #b8bb26;">"X-UA-Compatible"</span> <span style="color: #83a598;">content</span>=<span style="color: #b8bb26;">"ie=edge"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Demo</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
    &lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Flask Flask Flask</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>

<p>
Patikrinkime, ar veikia:
</p>


<div id="orge4563aa" class="figure">
<p><img src="./static/images/flask1_1.png" alt="flask1_1.png" width="600px" />
</p>
</div>


<p>
Logikos naudojimas šablonuose:
</p>

<p>
Už logiką šablonuose atsako Jinja2 šablonų generatorius (templating
engine), jis per savo sintaksę leidžia mums įterpti kintamuosius ir
logiką į html failus.
</p>

<p>
paruoškime paprastą žodynų sąrašą, kuris galės būti mūsų duomenų bazės
imitacija:
</p>

<p>
dictionary.py:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">data</span> =<span style="color: #fe8019;">[</span><span style="color: #cc241d;">{</span>
    <span style="color: #b8bb26;">'data'</span>:<span style="color: #b8bb26;">'2020 01 01'</span>,
    <span style="color: #b8bb26;">'autorius'</span>: <span style="color: #b8bb26;">'Autorius 1'</span>,
    <span style="color: #b8bb26;">'pavadinimas'</span>: <span style="color: #b8bb26;">'Apie niek&#261;'</span>,
    <span style="color: #b8bb26;">'tekstas'</span>: <span style="color: #b8bb26;">'Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis. Summus brains sit&#8203;&#8203;, morbo vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris.'</span>
<span style="color: #cc241d;">}</span>,
<span style="color: #cc241d;">{</span>
    <span style="color: #b8bb26;">'data'</span>:<span style="color: #b8bb26;">'2020 02 01'</span>,
    <span style="color: #b8bb26;">'autorius'</span>: <span style="color: #b8bb26;">'KITAS AUTORIUS'</span>,
    <span style="color: #b8bb26;">'pavadinimas'</span>: <span style="color: #b8bb26;">'Apie zombius'</span>,
    <span style="color: #b8bb26;">'tekstas'</span>: <span style="color: #b8bb26;">'Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis. Summus brains sit&#8203;&#8203;, morbo vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris. '</span>
<span style="color: #cc241d;">}</span>,
<span style="color: #cc241d;">{</span>
    <span style="color: #b8bb26;">'data'</span>:<span style="color: #b8bb26;">'2020 03 01'</span>,
    <span style="color: #b8bb26;">'autorius'</span>: <span style="color: #b8bb26;">'Dar ka&#382;kas'</span>,
    <span style="color: #b8bb26;">'pavadinimas'</span>: <span style="color: #b8bb26;">'Braiiins!'</span>,
    <span style="color: #b8bb26;">'tekstas'</span>: <span style="color: #b8bb26;">'Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis. Summus brains sit&#8203;&#8203;, morbo vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris.'</span>
<span style="color: #cc241d;">}</span><span style="color: #fe8019;">]</span>
</pre>
</div>


<p>
Pagrindiniame faile importuokime šį kintamąjį ir perduokime į šabloną:
</p>

<p>
app.py:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, render_template
<span style="color: #fb4934;">from</span> dictionary <span style="color: #fb4934;">import</span> data <span style="color: #928374;"># </span><span style="color: #928374;">IMPORTUOJAME</span>
<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>


<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'/'</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">index</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'index.html'</span>, data=data<span style="color: #fe8019;">)</span> <span style="color: #928374;"># </span><span style="color: #928374;">PERDUODAME &#302; &#352;ABLON&#260;</span>

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">'__main__'</span>:
  app.run<span style="color: #fe8019;">(</span>host=<span style="color: #b8bb26;">'127.0.0.1'</span>, port=8000, debug=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
Dabar dirbsime su šablonu. Pradžiai tiesiog perduokime kintamąjį į
body:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #b8bb26;">body</span>&gt;
    &lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Straipsniai:</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
    {{ data }}
&lt;/<span style="color: #b8bb26;">body</span>&gt;
</pre>
</div>


<div id="orgfb1e433" class="figure">
<p><img src="./static/images/flask1_2.png" alt="flask1_2.png" width="600px" />
</p>
</div>

<p>
Čia yra grubus žodynų sąrašo perdavimas, jį ir matome. Pabandykime tai
paversti straipsnių puslapiu:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #b8bb26;">body</span>&gt;
    &lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Straipsniai</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
    &lt;<span style="color: #b8bb26;">br</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;
    {% for straipsnis in data %}
    &lt;<span style="color: #b8bb26;">h3</span>&gt;<span style="font-style: italic; text-decoration: underline;">{{ straipsnis['pavadinimas'] }}</span>&lt;/<span style="color: #b8bb26;">h3</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['data'] }}, {{ straipsnis['autorius'] }}&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">hr</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['tekstas'] }}&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">hr</span>&gt;
    {% endfor %}
&lt;/<span style="color: #b8bb26;">body</span>&gt;
</pre>
</div>


<div id="org2857ccd" class="figure">
<p><img src="./static/images/flask1_3.png" alt="flask1_3.png" width="600px" />
</p>
</div>

<p>
Matome, kaip galime iteruoti per duomenis html'e. Pamėginkime įtraukti
if logiką. Pradžiai papildykime 'duomenų bazę'. Kiekviename žodyne
įtraukime 'status'. Dalies statusas bus 'published', dalies
'unpublished':
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fe8019;">{</span>
    <span style="color: #b8bb26;">'data'</span>:<span style="color: #b8bb26;">'2020 01 01'</span>,
    <span style="color: #b8bb26;">'autorius'</span>: <span style="color: #b8bb26;">'Autorius 1'</span>,
    <span style="color: #b8bb26;">'pavadinimas'</span>: <span style="color: #b8bb26;">'Apie niek&#261;'</span>,
    <span style="color: #b8bb26;">'tekstas'</span>: <span style="color: #b8bb26;">'Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis. Summus brains sit&#8203;&#8203;, morbo vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris.'</span>,
    <span style="color: #b8bb26;">'status'</span>: <span style="color: #b8bb26;">'published'</span>
<span style="color: #fe8019;">}</span>, <span style="color: #928374;"># </span><span style="color: #928374;">ir t.t.</span>
</pre>
</div>

<p>
įtraukime if logiką į šabloną:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #b8bb26;">body</span>&gt;
    &lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Straipsniai</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
    &lt;<span style="color: #b8bb26;">br</span>&gt;
    {% for straipsnis in data %}
    {% if straipsnis['status'] == 'published' %}
    &lt;<span style="color: #b8bb26;">h3</span>&gt;<span style="font-style: italic; text-decoration: underline;">{{ straipsnis['pavadinimas'] }}</span>&lt;/<span style="color: #b8bb26;">h3</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['data'] }}, &lt;<span style="color: #b8bb26;">i</span>&gt;<span style="font-style: italic;">{{ straipsnis['autorius'] }}</span>&lt;/<span style="color: #b8bb26;">i</span>&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">hr</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['tekstas'] }}&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">br</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;
    {% endif %}
    {% endfor %}
&lt;/<span style="color: #b8bb26;">body</span>&gt;
</pre>
</div>


<div id="org1f2a049" class="figure">
<p><img src="./static/images/flask1_4.png" alt="flask1_4.png" width="600px" />
</p>
</div>

<p>
Matome, kad straipsnis su statusu != 'published' nebuvo publikuotas.
Kaip ir python'e, galima naudoti {%elif %} ir {% else %}. Pvz.:
</p>


<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #b8bb26;">body</span>&gt;
    &lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Straipsniai</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
    &lt;<span style="color: #b8bb26;">br</span>&gt;
    {% for straipsnis in data %}
    {% if straipsnis['status'] == 'published' %}
    &lt;<span style="color: #b8bb26;">h3</span>&gt;<span style="font-style: italic; text-decoration: underline;">{{ straipsnis['pavadinimas'] }}</span>&lt;/<span style="color: #b8bb26;">h3</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['data'] }}, &lt;<span style="color: #b8bb26;">i</span>&gt;<span style="font-style: italic;">{{ straipsnis['autorius'] }}</span>&lt;/<span style="color: #b8bb26;">i</span>&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">hr</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['tekstas'] }}&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">br</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;
    {% else %}
    &lt;<span style="color: #b8bb26;">h3</span>&gt;{{ straipsnis['pavadinimas'] }} - &lt;<span style="color: #b8bb26;">i</span>&gt;<span style="font-style: italic;">Publikavimas laikinai i&#353;jungtas</span>&lt;/<span style="color: #b8bb26;">i</span>&gt;&lt;/<span style="color: #b8bb26;">h3</span>&gt;
    &lt;<span style="color: #b8bb26;">br</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;
    {% endif %}
    {% endfor %}
&lt;/<span style="color: #b8bb26;">body</span>&gt;
</pre>
</div>


<div id="orga3f6853" class="figure">
<p><img src="./static/images/flask1_5.png" alt="flask1_5.png" width="600px" />
</p>
</div>

<p>
Paveldėjimas šablonuose
</p>

<p>
Dažniausiai interneto svetainės turi struktūrą, kai kiekviename
puslapyje atsikartoja tam tikri komponentai. Tai gali būti titulinė
puslapio dalis, &lt;head&gt; komponentai, navigacijos panelė, footer'is,
nuorodos į CSS, JavaScript ir pan. Jinja2 turi mechanizmą, leidžiantį
mums kiekvieną kartą nerašyti į šabloną šių komponentų, t.y. išsaugoti
juos atskirai ir naudoti tik nuorodas į juos. Pabandykime pritaikyti
praktikoje.
</p>

<p>
Pasiskolinkime standartinį išdėstymą iš <a href="https://github.com/StartBootstrap/startbootstrap-bare/blob/master/dist/index.html">čia</a>.
</p>

<p>
Tam, kad veiktų mobiliosios versijos navigacija, data-toggle ir
data-target reikia pakeisti data-bs-toggle ir data-bs-target.
</p>

<p>
Nusikopijuokime nuorodos HTML'ą į kokį nors html failą.
</p>

<p>
Pakeiskime lokalias css ir JavaScript nuorodas į <a href="https://getbootstrap.com/docs/4.3/getting-started/introduction/">Bootstrap CDN</a>
</p>

<p>
Perkelkime savo &lt;body&gt; dalį vietoje tos dalies, kuri yra po komentaru
&lt;!&#x2013; Page Content &#x2013;&gt;
</p>

<p>
senąjį failą pervadinkime backup.html, naująjį - index html.
</p>

<p>
Rezultatas atrodys maždaug taip:
</p>


<div id="org4c90f57" class="figure">
<p><img src="./static/images/flask1_6.png" alt="flask1_6.png" width="600px" />
</p>
</div>

<p>
Įsivaizduokime, kad mums reikės dar puslapio 'apie', galbūt dar keleto
puslapių ateityje. Visi jie turės tą patį bootstrap'ą, ir tą pačią
navigacijos panelę.
</p>

<p>
templates kataloge susikurkime failą base.html
</p>

<p>
visą turinį iš index.html nukopijuokime į naują base.html.
</p>

<p>
tuomet viską kas yra &lt;div class="container"&gt; viduje, triname ir
pakeičiame į {% block content %}{% endblock %}:
</p>

<div class="org-src-container">
<pre class="src src-html">          &lt;/<span style="color: #b8bb26;">ul</span>&gt;
        &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
&lt;/<span style="color: #b8bb26;">nav</span>&gt;

<span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">Page Content</span><span style="color: #928374;"> --&gt;</span>

&lt;<span style="color: #b8bb26;">body</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"container"</span>&gt;
        {% block content %}
        {% endblock %}
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
&lt;/<span style="color: #b8bb26;">body</span>&gt;


<span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">Bootstrap core JavaScript</span><span style="color: #928374;"> --&gt;</span>
&lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://code.jquery.com/jquery-3.3.1.slim.min.js"</span>
    <span style="color: #83a598;">integrity</span>=<span style="color: #b8bb26;">"sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"</span>
    <span style="color: #83a598;">crossorigin</span>=<span style="color: #b8bb26;">"anonymous"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
</pre>
</div>

<p>
Išsaugokime base.html.
</p>

<p>
index.html pertvarkykime taip:
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Straipsniai</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
&lt;<span style="color: #b8bb26;">br</span>&gt;
{% for straipsnis in data %}
{% if straipsnis['status'] == 'published' %}
&lt;<span style="color: #b8bb26;">h3</span>&gt;<span style="font-style: italic; text-decoration: underline;">{{ straipsnis['pavadinimas'] }}</span>&lt;/<span style="color: #b8bb26;">h3</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['data'] }}, &lt;<span style="color: #b8bb26;">i</span>&gt;<span style="font-style: italic;">{{ straipsnis['autorius'] }}</span>&lt;/<span style="color: #b8bb26;">i</span>&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">hr</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['tekstas'] }}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">br</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;
{% else %}
&lt;<span style="color: #b8bb26;">h3</span>&gt;{{ straipsnis['pavadinimas'] }} - &lt;<span style="color: #b8bb26;">i</span>&gt;<span style="font-style: italic;">Publikavimas laikinai i&#353;jungtas</span>&lt;/<span style="color: #b8bb26;">i</span>&gt;&lt;/<span style="color: #b8bb26;">h3</span>&gt;
&lt;<span style="color: #b8bb26;">br</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;
{% endif %}
{% endfor %}

{% endblock %}
</pre>
</div>


<p>
papildykime savo app.py nauju maršrutu:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'/about'</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">about</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'about.html'</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
base.html susiraskime navigacijoje nuorodą 'About', ir nukreipkime į
savo naująjį maršrutą:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #b8bb26;">li</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-item"</span>&gt;
    &lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-link"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"/about"</span>&gt;About&lt;/<span style="color: #b8bb26;">a</span>&gt;
&lt;/<span style="color: #b8bb26;">li</span>&gt;
susikurkime dar vien&#261; &#353;ablon&#261;, about.html:


{% extends "base.html" %}

{% block content %}

&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Apie</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;&#352;iame puslapyje rasite labai daug naudingos informacijos apie beveik visk&#261;&lt;/<span style="color: #b8bb26;">p</span>&gt;

{% endblock %}
</pre>
</div>

<p>
Svetainėje, paspaudę nuorodą atsidursime puslapyje "Apie":
</p>


<div id="orgc8f4643" class="figure">
<p><img src="./static/images/flask1_7.png" alt="flask1_7.png" width="600px" />
</p>
</div>

<p>
<a href="https://github.com/CodeAcademy-Online/Python/tree/lesson-14">result here</a>.
</p>
</div>
</div>
</div>

<div id="outline-container-org3d6d855" class="outline-2">
<h2 id="org3d6d855"><span class="section-number-2">3.</span> Flask 2 dalis</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orgbb1fbe8" class="outline-3">
<h3 id="orgbb1fbe8"><span class="section-number-3">3.1.</span> Dinaminiai maršrutai ir formos</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-org4362e68" class="outline-4">
<h4 id="org4362e68"><span class="section-number-4">3.1.1.</span> Dinaminiai maršrutai</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
Tęskime su praeitos paskaitos medžiaga. Įsivaizduokime, kad mums
reikės straipsnių sąrašo, su dalimi teksto, ir po kiekvienu sąrašo
elementu nuorodos 'skaityti toliau&#x2026;'. Tokiose situacijose labai
praverčia dinaminiai maršrutai. Susikurkime naują maršrutą app.py:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'/&lt;string:title&gt;'</span><span style="color: #fe8019;">)</span> <span style="color: #928374;"># </span><span style="color: #928374;">parametruose nurodomas kintamasis (title) ir jo tipas (string)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">article</span><span style="color: #fe8019;">(</span>title<span style="color: #fe8019;">)</span>: <span style="color: #928374;"># </span><span style="color: #928374;">kintam1j&#303; b&#363;tinai nurodykite ir funkcijos parametruose</span>
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'article.html'</span>, title=title, data=data<span style="color: #fe8019;">)</span> <span style="color: #928374;"># </span><span style="color: #928374;">taip pat ir &#269;ia reikia j&#303; perduoti</span>
</pre>
</div>

<p>
dabar pakoreguokime mūsų index.html:
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Straipsniai</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
&lt;<span style="color: #b8bb26;">br</span>&gt;
{% for straipsnis in data %}
&lt;<span style="color: #b8bb26;">h3</span>&gt;<span style="font-style: italic; text-decoration: underline;">{{ straipsnis['pavadinimas'] }}</span>&lt;/<span style="color: #b8bb26;">h3</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['data'] }}, &lt;<span style="color: #b8bb26;">i</span>&gt;<span style="font-style: italic;">{{ straipsnis['autorius'] }}</span>&lt;/<span style="color: #b8bb26;">i</span>&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">hr</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['tekstas'][:30] }}&lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"{{ url_for('article', title=straipsnis['pavadinimas']) }}"</span>&gt;...skaityti toliau&lt;/<span style="color: #b8bb26;">a</span>&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">br</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;
{% endfor %}

{% endblock %}
</pre>
</div>

<p>
panagrinėkime &lt;p&gt; bloką.
</p>

<ul class="org-ul">
<li>{{ straipsnis['tekstas'][:30] }} - vietoje pilno teksto pasiliekame
ištrauką pirmų 30ties simbolių</li>

<li>nuorodoje naudojama url_for() yra pagalbinė Jinja funkcija. Į
parametrus priima maršruto funkcijos pavadinimą. Paprastesniu
atveju, url_for('about') nukreiptų į mūsų 'Apie' puslapį.</li>

<li>{{ url_for('article', title=straipsnis['pavadinimas']) }} - šiuo
atveju mes nurodėme, kad norime į 'article' ir kad jo parametruose
esantis title būtų prilygintas straipsnio pavadinimui.</li>
</ul>

<p>
Mūsų straipsnių puslapis dabar atrodo taip:
</p>


<div id="org931b91b" class="figure">
<p><img src="./static/images/flask2_1.png" alt="flask2_1.png" width="300px" />
</p>
</div>

<p>
Susikurkime tuščią article.html ir pažiūrėkime, kas vyksta:
</p>

<p>
article.html tuščias, todėl nėra jokio turinio. Tačiau URL eilutėje
matome, kad puslaio endpoint'as yra straipsnio pavadinimas. Padarykime
taip, kad matytumėm straipsnio turinį
</p>

<p>
article.html:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fe8019;">{</span>% extends <span style="color: #b8bb26;">"base.html"</span> %<span style="color: #fe8019;">}</span>

<span style="color: #fe8019;">{</span>% block content %<span style="color: #fe8019;">}</span>

<span style="color: #fe8019;">{</span>% <span style="color: #fb4934;">for</span> straipsnis <span style="color: #fb4934;">in</span> data %<span style="color: #fe8019;">}</span>
<span style="color: #fe8019;">{</span>% <span style="color: #fb4934;">if</span> straipsnis<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">'pavadinimas'</span><span style="color: #cc241d;">]</span> == title %<span style="color: #fe8019;">}</span>

&lt;h1&gt;<span style="color: #fe8019;">{</span><span style="color: #cc241d;">{</span> straipsnis<span style="color: #b8bb26;">[</span><span style="color: #b8bb26;">'pavadinimas'</span><span style="color: #b8bb26;">]</span> <span style="color: #cc241d;">}</span><span style="color: #fe8019;">}</span>&lt;/h1&gt;
&lt;p&gt;<span style="color: #fe8019;">{</span><span style="color: #cc241d;">{</span> straipsnis<span style="color: #b8bb26;">[</span><span style="color: #b8bb26;">'data'</span><span style="color: #b8bb26;">]</span> <span style="color: #cc241d;">}</span><span style="color: #fe8019;">}</span>, &lt;i&gt;<span style="color: #fe8019;">{</span><span style="color: #cc241d;">{</span> straipsnis<span style="color: #b8bb26;">[</span><span style="color: #b8bb26;">'autorius'</span><span style="color: #b8bb26;">]</span> <span style="color: #cc241d;">}</span><span style="color: #fe8019;">}</span>&lt;/i&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;<span style="color: #fe8019;">{</span><span style="color: #cc241d;">{</span> straipsnis<span style="color: #b8bb26;">[</span><span style="color: #b8bb26;">'tekstas'</span><span style="color: #b8bb26;">]</span> <span style="color: #cc241d;">}</span><span style="color: #fe8019;">}</span>&lt;/p&gt;
&lt;br&gt;&lt;br&gt;

<span style="color: #fe8019;">{</span>% endif %<span style="color: #fe8019;">}</span>
<span style="color: #fe8019;">{</span>% endfor %<span style="color: #fe8019;">}</span>

<span style="color: #fe8019;">{</span>% endblock %<span style="color: #fe8019;">}</span>
</pre>
</div>

<p>
išbandykime:
</p>


<div id="orgeb244f0" class="figure">
<p><img src="./static/images/flask2_2.png" alt="flask2_2.png" width="800px" />
</p>
</div>
</div>
</div>
<div id="outline-container-orgc250644" class="outline-4">
<h4 id="orgc250644"><span class="section-number-4">3.1.2.</span> Formos</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
Formas flaske galima kurti dviem būdais. Aptarsime abu. Pirmas iš jų
būtų paprastos formos iš HTML duomenų surinkimas. Tinka įvairiems
testavimams, ne kritiniams duomenims apdoroti. Veikimo principas buvo
glaustai pademonstruotas įžangos skyriuje. Žinoma, tas formas galima
privesti iki profesionalaus lygmens, tačiau reikės nemažai papildomo
darbo.
</p>

<p>
sukurkime naują maršrutą:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'/add_article'</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">add_article</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'add_article.html'</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
papildykime index.html nuoroda po straipsniais "Rašyti straipsnį"
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Straipsniai</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
&lt;<span style="color: #b8bb26;">br</span>&gt;
{% for straipsnis in data %}
&lt;<span style="color: #b8bb26;">h3</span>&gt;<span style="font-style: italic; text-decoration: underline;">{{ straipsnis['pavadinimas'] }}</span>&lt;/<span style="color: #b8bb26;">h3</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['data'] }}, &lt;<span style="color: #b8bb26;">i</span>&gt;<span style="font-style: italic;">{{ straipsnis['autorius'] }}</span>&lt;/<span style="color: #b8bb26;">i</span>&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">hr</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['tekstas'][:30] }}&lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"{{ url_for('article', title=straipsnis['pavadinimas']) }}"</span>&gt;...skaityti toliau&lt;/<span style="color: #b8bb26;">a</span>&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">br</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;
{% endfor %}
&lt;<span style="color: #b8bb26;">h1</span>&gt;&lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"{{ url_for('add_article') }}"</span>&gt; Ra&#353;yti straipsn&#303;&lt;/<span style="color: #b8bb26;">a</span>&gt;&lt;/<span style="color: #b8bb26;">h1</span>&gt;
{% endblock %}
</pre>
</div>

<p>
sukurkime naują šabloną add_article.html:
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

&lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"/"</span>, <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span>&gt;
  &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
    &lt;<span style="color: #b8bb26;">label</span> <span style="color: #83a598;">for</span>=<span style="color: #b8bb26;">"autorius"</span>&gt;Autorius&lt;/<span style="color: #b8bb26;">label</span>&gt;
    &lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-control"</span> <span style="color: #83a598;">id</span>=<span style="color: #b8bb26;">"autorius"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"autorius"</span>&gt;
  &lt;/<span style="color: #b8bb26;">div</span>&gt;
  &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
    &lt;<span style="color: #b8bb26;">label</span> <span style="color: #83a598;">for</span>=<span style="color: #b8bb26;">"pavadinimas"</span>&gt;Pavadinimas&lt;/<span style="color: #b8bb26;">label</span>&gt;
    &lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-control"</span> <span style="color: #83a598;">id</span>=<span style="color: #b8bb26;">"pavadinimas"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"pavadinimas"</span>&gt;
  &lt;/<span style="color: #b8bb26;">div</span>&gt;
  &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
    &lt;<span style="color: #b8bb26;">label</span> <span style="color: #83a598;">for</span>=<span style="color: #b8bb26;">"date"</span>&gt;Data&lt;/<span style="color: #b8bb26;">label</span>&gt;
    &lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-control"</span> <span style="color: #83a598;">id</span>=<span style="color: #b8bb26;">"date"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"date"</span>&gt;
  &lt;/<span style="color: #b8bb26;">div</span>&gt;
  &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
    &lt;<span style="color: #b8bb26;">label</span> <span style="color: #83a598;">for</span>=<span style="color: #b8bb26;">"tekstas"</span>&gt;Example textarea&lt;/<span style="color: #b8bb26;">label</span>&gt;
    &lt;<span style="color: #b8bb26;">textarea</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-control"</span> <span style="color: #83a598;">id</span>=<span style="color: #b8bb26;">"tekstas"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"tekstas"</span> <span style="color: #83a598;">rows</span>=<span style="color: #b8bb26;">"3"</span>&gt;&lt;/<span style="color: #b8bb26;">textarea</span>&gt;
  &lt;/<span style="color: #b8bb26;">div</span>&gt;
  &lt;<span style="color: #b8bb26;">button</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"submit"</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"btn btn-primary"</span>&gt;I&#353;saugoti&lt;/<span style="color: #b8bb26;">button</span>&gt;
&lt;/<span style="color: #b8bb26;">form</span>&gt;

{% endblock %}
</pre>
</div>


<p>
užeikime į "Rašyti straipsnį" nuorodą:
</p>


<div id="org78cda47" class="figure">
<p><img src="./static/images/flask2_3.png" alt="flask2_3.png" width="600px" />
</p>
</div>

<p>
Turime neveikiančią formą.
</p>

<p>
Prie importų iš flask pridėkime <code>request</code>. Pakoreguokime index()
funkciją:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'/'</span>, methods=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">'GET'</span>, <span style="color: #b8bb26;">'POST'</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">index</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">if</span> request.method == <span style="color: #b8bb26;">'POST'</span>:
        date = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'date'</span><span style="color: #fe8019;">]</span>
        autorius = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'autorius'</span><span style="color: #fe8019;">]</span>
        tekstas = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'tekstas'</span><span style="color: #fe8019;">]</span>
        pavadinimas = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'pavadinimas'</span><span style="color: #fe8019;">]</span>
        data.append<span style="color: #fe8019;">(</span><span style="color: #cc241d;">{</span>
            <span style="color: #b8bb26;">'data'</span>: date,
            <span style="color: #b8bb26;">'autorius'</span>: autorius,
            <span style="color: #b8bb26;">'pavadinimas'</span>: pavadinimas,
            <span style="color: #b8bb26;">'tekstas'</span>: tekstas,
            <span style="color: #b8bb26;">'status'</span>: <span style="color: #b8bb26;">'published'</span>
        <span style="color: #cc241d;">}</span><span style="color: #fe8019;">)</span>
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'index.html'</span>, data=data<span style="color: #fe8019;">)</span>
</pre>
</div>


<p>
funkcijoje pasitikriname, ar yra 'post' užklausa, jeigu yra, tai
papildome mūsų "duomenų bazę" naujais duomenimis:
</p>


<div id="orgd3f8655" class="figure">
<p><img src="./static/images/flask2_4.png" alt="flask2_4.png" width="600px" />
</p>
</div>
</div>
</div>

<div id="outline-container-org013d325" class="outline-4">
<h4 id="org013d325"><span class="section-number-4">3.1.3.</span> flask-wtf</h4>
<div class="outline-text-4" id="text-3-1-3">
<p>
Antras būdas tvarkytis su formomis yra trečios šalies bibliotekos
<code>flask_wtf</code> naudojimas. Ji pasirūpina saugumo klausimais "out of the
box" ir yra industrijos standartas dirbant su flask. Pamėginsime
kontaktuose sukurti paprastą formą. Reikia šiek tiek pasiruošti:
</p>

<ul class="org-ul">
<li>sukurkime naują tuščią maršrutą contact_us</li>

<li>sukurkime naują tuščią šabloną tam maršrutui</li>

<li>navigacijoje aktyvuokime nuorodą į contact_us</li>

<li>sukurkime naują failą forms.py</li>

<li>įsidiekime flask-wtf biblioteką (pip install flask-wtf)</li>
</ul>

<p>
forms.py:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask_wtf <span style="color: #fb4934;">import</span> FlaskForm
<span style="color: #fb4934;">from</span> wtforms <span style="color: #fb4934;">import</span> StringField, TextAreaField, SubmitField
<span style="color: #fb4934;">from</span> wtforms.validators <span style="color: #fb4934;">import</span> DataRequired, Length, Email


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">ContactForm</span><span style="color: #fe8019;">(</span>FlaskForm<span style="color: #fe8019;">)</span>:
    <span style="color: #83a598;">name</span> = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Vardas'</span>, <span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">()</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    <span style="color: #83a598;">email</span> = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'El.pa&#353;tas'</span>, <span style="color: #cc241d;">[</span>Email<span style="color: #b8bb26;">(</span>message=<span style="color: #83a598;">(</span><span style="color: #b8bb26;">'Neteisingas adresas.'</span><span style="color: #83a598;">)</span><span style="color: #b8bb26;">)</span>, DataRequired<span style="color: #b8bb26;">()</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    body = TextAreaField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'J&#363;s&#371; prane&#353;imas'</span>, <span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">()</span>,
                                        Length<span style="color: #b8bb26;">(</span><span style="color: #fe8019;">min</span>=10,
                                        message=<span style="color: #83a598;">(</span><span style="color: #b8bb26;">'Per trumpas tekstas.'</span><span style="color: #83a598;">)</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    submit = SubmitField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Submit'</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
Šį kartą mūsų forma aprašoma, kaip klasė. Visus laukų tipus ir
validatorius (patvirtintojus?..) reikia importuotis atskirai. Pvz.:
eilutę priskirtą kintamąjam body galima dekonstruoti taip:
</p>

<p>
TextAreaField - nurodome, kokio tipo formos lauką generuoti.
</p>

<p>
'Jūsų pranešimas' - formos lauko pavadinimas (label).
</p>

<p>
[DataRequired(), Length(min=10, message=('Per trumpas tekstas.'))]) -
sąraše yra validators - Nurodome kad laukas būtinas užpildyti, kad
minimum 10 simbolių, ir kokia klaidos žinutė.
</p>

<p>
Kokie yra galimi laukai, galima pažiūrėti <a href="https://wtforms.readthedocs.io/en/stable/fields/">čia</a>. Kokie yra galimi
validators, galima pažiūrėti <a href="https://wtforms.readthedocs.io/en/stable/validators/">čia</a>.
</p>

<p>
pakoreguokime maršrutą:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'/contact_us'</span>, methods=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">'GET'</span>, <span style="color: #b8bb26;">'POST'</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">contact_us</span><span style="color: #fe8019;">()</span>:
    form = ContactForm<span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">if</span> form.validate_on_submit<span style="color: #fe8019;">()</span>:
        <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'contact_success.html'</span>, form=form<span style="color: #fe8019;">)</span>
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'contact_us.html'</span>, form=form<span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
Pakoregavome contact_us maršrutą taip, kad jeigu forma sėkmingai
praėjo validaciją, nukreiptų mus į sėkmės puslapį.
</p>

<p>
pasidarykime šablonus - contact_us.html:
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

  &lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"{{ url_for('contact_success') }}"</span>&gt;
      {{ form.hidden_tag() }}
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
      {{ form.name.label(class="form-control-label") }}
      {{ form.name(class="form-control") }}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
      {{ form.email.label(class="form-control-label") }}
      {{ form.email(class="form-control") }}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
      {{ form.body.label(class="form-control-label") }}
      {{ form.body(class="form-control", <span style="color: #83a598;">rows</span>="5") }}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      {{ form.submit }}
  &lt;/<span style="color: #b8bb26;">form</span>&gt;
{% endblock %}
</pre>
</div>

<p>
reikėtų atkreipti dėmesį, kad Bootstrap klasės rašomos į kintamųjų
parametrus
</p>

<p>
ir sėkmės puslapiui - contact_success.html
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Forma u&#382;pildyta s&#279;kmingai!</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;Vardas: {{form.name.data}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;El. pa&#353;tas: {{form.email.data}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;Tekstas:&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{form.body.data}}&lt;/<span style="color: #b8bb26;">p</span>&gt;

{% endblock %}
</pre>
</div>

<p>
kadangi apie duomenų bazes kalbėsime sekančioje paskaitoje, su šiuo
labai nesistengėme, išgaudysime formos reikšmes į pliką HTML.
</p>


<div id="org3b178e4" class="figure">
<p><img src="./static/images/flask2_5.png" alt="flask2_5.png" width="600px" />
</p>
</div>

<p>
paspaudus 'Submit' mygtuką, mes niekur nenukreipiami, nes forma
nepraėjo validacijos filtrų. Būtų gerai, jeigu mus informuotų, kas
atsitiko. Reikia koreguoti formos šabloną:
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

  &lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"#"</span>&gt;
      {{ form.csrf_token }}
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
      {{ form.name.label(class="form-control-label") }}
      {{ form.name(class="form-control") }}
      {% if form.name.errors %}
        {% for error in form.name.errors %}
          &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
        {% endfor %}
      {% endif %}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
      {{ form.email.label(class="form-control-label") }}
      {{ form.email(class="form-control") }}
      {% if form.email.errors %}
        {% for error in form.email.errors %}
          &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
        {% endfor %}
      {% endif %}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
      {{ form.body.label(class="form-control-label") }}
      {{ form.body(class="form-control", <span style="color: #83a598;">rows</span>="5") }}
      {% if form.body.errors %}
        {% for error in form.body.errors %}
          &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
        {% endfor %}
      {% endif %}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      {{ form.submit }}
  &lt;/<span style="color: #b8bb26;">form</span>&gt;

{% endblock %}
</pre>
</div>

<p>
Atrodo painiai :) Tai tik po kiekvienu lauku nurodyta sąlyga, kad
jeigu tam laukui yra kažkokios klaidos, praiteruojame jas, ir
parašome, kas tai per klaida:
</p>


<div id="orgc639bb2" class="figure">
<p><img src="./static/images/flask2_6.png" alt="flask2_6.png" width="600px" />
</p>
</div>

<p>
Na ir pagaliau pabandykime teisingai suvesti:
</p>


<div id="orgfa023e5" class="figure">
<p><img src="./static/images/flask2_7.png" alt="flask2_7.png" width="600px" />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orge14d2da" class="outline-3">
<h3 id="orge14d2da"><span class="section-number-3">3.2.</span> Uzduotis</h3>
<div class="outline-text-3" id="text-3-2">
</div>
<div id="outline-container-org33efde4" class="outline-4">
<h4 id="org33efde4"><span class="section-number-4">3.2.1.</span> app.py</h4>
<div class="outline-text-4" id="text-3-2-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, render_template, request, redirect, url_for, flash
<span style="color: #fb4934;">from</span> form <span style="color: #fb4934;">import</span> ContactForm


<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>
app.<span style="color: #83a598;">config</span><span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'SECRET_KEY'</span><span style="color: #fe8019;">]</span> = <span style="color: #b8bb26;">'bet kokia simboli&#371; eilut&#279;'</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'/'</span>, methods=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">'GET'</span>, <span style="color: #b8bb26;">'POST'</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">form</span><span style="color: #fe8019;">()</span>:
    form = ContactForm<span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">if</span> form.validate_on_submit<span style="color: #fe8019;">()</span>:
        <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'success.html'</span>, form=form<span style="color: #fe8019;">)</span>
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'form.html'</span>, form=form<span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">'__main__'</span>:
  app.run<span style="color: #fe8019;">(</span>host=<span style="color: #b8bb26;">'127.0.0.1'</span>, port=8000, debug=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgeb22b15" class="outline-4">
<h4 id="orgeb22b15"><span class="section-number-4">3.2.2.</span> form.py</h4>
<div class="outline-text-4" id="text-3-2-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask_wtf <span style="color: #fb4934;">import</span> FlaskForm
<span style="color: #fb4934;">from</span> wtforms <span style="color: #fb4934;">import</span> StringField, PasswordField, SelectField, SubmitField, BooleanField
<span style="color: #fb4934;">from</span> wtforms.validators <span style="color: #fb4934;">import</span> DataRequired, Length, Email, InputRequired


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">ContactForm</span><span style="color: #fe8019;">(</span>FlaskForm<span style="color: #fe8019;">)</span>:

    <span style="color: #83a598;">email</span> = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Vardas'</span>, <span style="color: #cc241d;">[</span>Email<span style="color: #b8bb26;">(</span>message=<span style="color: #83a598;">(</span><span style="color: #b8bb26;">'Neteisingas adresas.'</span><span style="color: #83a598;">)</span><span style="color: #b8bb26;">)</span>, DataRequired<span style="color: #b8bb26;">(</span>message=<span style="color: #b8bb26;">'Lauk&#261; b&#363;tina u&#382;pildyti'</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    password = PasswordField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Slapta&#382;odis'</span>, validators=<span style="color: #cc241d;">[</span>Length<span style="color: #b8bb26;">(</span><span style="color: #fe8019;">min</span>=8, message=<span style="color: #83a598;">(</span><span style="color: #b8bb26;">'Per ma&#382;ai simboli&#371;!'</span><span style="color: #83a598;">)</span><span style="color: #b8bb26;">)</span>, DataRequired<span style="color: #b8bb26;">(</span>message=<span style="color: #b8bb26;">'Lauk&#261; b&#363;tina u&#382;pildyti'</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    address1 = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Adresas (pirma eilut&#279;)'</span>, validators=<span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">(</span>message=<span style="color: #83a598;">(</span><span style="color: #b8bb26;">'Lauk&#261; b&#363;tina u&#382;pildyti'</span><span style="color: #83a598;">)</span><span style="color: #b8bb26;">)</span>, Length<span style="color: #b8bb26;">(</span><span style="color: #fe8019;">min</span>=4, message=<span style="color: #83a598;">(</span><span style="color: #b8bb26;">'Per ma&#382;ai simboli&#371;!'</span><span style="color: #83a598;">)</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    address2 = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Adresas (antra eilut&#279;)'</span>, validators=<span style="color: #cc241d;">[</span>Length<span style="color: #b8bb26;">(</span><span style="color: #fe8019;">min</span>=4, message=<span style="color: #83a598;">(</span><span style="color: #b8bb26;">'Per ma&#382;ai simboli&#371;'</span><span style="color: #83a598;">)</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    city = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Miestas'</span>, validators=<span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">(</span>message=<span style="color: #b8bb26;">'Lauk&#261; b&#363;tina u&#382;pildyti'</span><span style="color: #b8bb26;">)</span>, Length<span style="color: #b8bb26;">(</span><span style="color: #fe8019;">min</span>=4, message=<span style="color: #83a598;">(</span><span style="color: #b8bb26;">'Per ma&#382;ai simboli&#371;'</span><span style="color: #83a598;">)</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    state = SelectField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Rajonas'</span>, choices=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">(</span><span style="color: #b8bb26;">'vln'</span>, <span style="color: #b8bb26;">'Vilniaus'</span><span style="color: #b8bb26;">)</span>, <span style="color: #b8bb26;">(</span><span style="color: #b8bb26;">'kns'</span>, <span style="color: #b8bb26;">'Kauno'</span><span style="color: #b8bb26;">)</span>, <span style="color: #b8bb26;">(</span><span style="color: #b8bb26;">'klp'</span>, <span style="color: #b8bb26;">'Klaip&#279;dos'</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">]</span>, validators=<span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">(</span>message=<span style="color: #b8bb26;">'Lauk&#261; b&#363;tina u&#382;pildyti'</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    zip_code = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Pa&#353;to kodas'</span>, validators=<span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">(</span>message=<span style="color: #b8bb26;">'Lauk&#261; b&#363;tina u&#382;pildyti'</span><span style="color: #b8bb26;">)</span>, Length<span style="color: #b8bb26;">(</span><span style="color: #fe8019;">min</span>=4, message=<span style="color: #83a598;">(</span><span style="color: #b8bb26;">'Per ma&#382;ai simboli&#371;'</span><span style="color: #83a598;">)</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    agree = BooleanField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Sutinku gauti &#353;lam&#353;t&#261;'</span><span style="color: #fe8019;">)</span>
    submit = SubmitField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Submit'</span><span style="color: #fe8019;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org6c6eb92" class="outline-4">
<h4 id="org6c6eb92"><span class="section-number-4">3.2.3.</span> templates/base.html</h4>
<div class="outline-text-4" id="text-3-2-3">
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!doctype</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
  &lt;<span style="color: #b8bb26;">head</span>&gt;
    <span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">Required meta tags</span><span style="color: #928374;"> --&gt;</span>
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"utf-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"viewport"</span> <span style="color: #83a598;">content</span>=<span style="color: #b8bb26;">"width=device-width, initial-scale=1, shrink-to-fit=no"</span>&gt;

    <span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">Bootstrap CSS</span><span style="color: #928374;"> --&gt;</span>
    &lt;<span style="color: #b8bb26;">link</span> <span style="color: #83a598;">rel</span>=<span style="color: #b8bb26;">"stylesheet"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"</span> <span style="color: #83a598;">integrity</span>=<span style="color: #b8bb26;">"sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"</span> <span style="color: #83a598;">crossorigin</span>=<span style="color: #b8bb26;">"anonymous"</span>&gt;

    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Superform</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
  &lt;/<span style="color: #b8bb26;">head</span>&gt;
  &lt;<span style="color: #b8bb26;">body</span>&gt;
    &lt;<span style="color: #b8bb26;">br</span>&gt;
        &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"container"</span>&gt;
            {% block content %}
            {% endblock %}
        &lt;/<span style="color: #b8bb26;">div</span>&gt;

    <span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">Optional JavaScript</span><span style="color: #928374;"> --&gt;</span>
    <span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">jQuery first, then Popper.js, then Bootstrap JS</span><span style="color: #928374;"> --&gt;</span>
    &lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://code.jquery.com/jquery-3.4.1.slim.min.js"</span> <span style="color: #83a598;">integrity</span>=<span style="color: #b8bb26;">"sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"</span> <span style="color: #83a598;">crossorigin</span>=<span style="color: #b8bb26;">"anonymous"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
    &lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"</span> <span style="color: #83a598;">integrity</span>=<span style="color: #b8bb26;">"sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"</span> <span style="color: #83a598;">crossorigin</span>=<span style="color: #b8bb26;">"anonymous"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
    &lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"</span> <span style="color: #83a598;">integrity</span>=<span style="color: #b8bb26;">"sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"</span> <span style="color: #83a598;">crossorigin</span>=<span style="color: #b8bb26;">"anonymous"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
  &lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc7fe0b1" class="outline-4">
<h4 id="orgc7fe0b1"><span class="section-number-4">3.2.4.</span> templates/form.html</h4>
<div class="outline-text-4" id="text-3-2-4">
<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}
{% block content %}

&lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"#"</span>&gt;
    {{ form.csrf_token }}
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-row"</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group col-md-6"</span>&gt;
        {{ form.email.label(class="form-control-label") }}
        {{ form.email(class="form-control") }}
        {% if form.email.errors %}
        {% for error in form.email.errors %}
          &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
        {% endfor %}
        {% endif %}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group col-md-6"</span>&gt;
        {{ form.password.label(class="form-control-label") }}
        {{ form.password(class="form-control") }}
        {% if form.password.errors %}
        {% for error in form.password.errors %}
          &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
        {% endfor %}
        {% endif %}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
        {{ form.address1.label(class="form-control-label") }}
        {{ form.address1(class="form-control") }}
        {% if form.address1.errors %}
        {% for error in form.address1.errors %}
          &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
        {% endfor %}
        {% endif %}
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
        {{ form.address2.label(class="form-control-label") }}
        {{ form.address2(class="form-control") }}
        {% if form.address2.errors %}
        {% for error in form.address2.errors %}
          &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
        {% endfor %}
        {% endif %}
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-row"</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group col-md-6"</span>&gt;
            {{ form.city.label(class="form-control-label") }}
            {{ form.city(class="form-control") }}
            {% if form.city.errors %}
            {% for error in form.city.errors %}
                &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
            {% endfor %}
            {% endif %}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group col-md-4"</span>&gt;
            {{ form.state.label(class="form-control-label") }}
            {{ form.state(class="form-control") }}
            {% if form.state.errors %}
            {% for error in form.state.errors %}
                &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
            {% endfor %}
            {% endif %}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group col-md-2"</span>&gt;
            {{ form.zip_code.label(class="form-control-label") }}
            {{ form.zip_code(class="form-control") }}
            {% if form.zip_code.errors %}
            {% for error in form.zip_code.errors %}
                &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
            {% endfor %}
            {% endif %}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-check"</span>&gt;
            {{ form.agree(class="form-check-input") }}
            {{ form.agree.label(class="form-check-label") }}
            {% if form.agree.errors %}
            {% for error in form.agree.errors %}
                &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
            {% endfor %}
            {% endif %}
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;<span style="color: #b8bb26;">br</span>&gt;
    {{ form.submit }}
  &lt;/<span style="color: #b8bb26;">form</span>&gt;

{% endblock %}
</pre>
</div>
</div>
</div>
<div id="outline-container-org2e2018b" class="outline-4">
<h4 id="org2e2018b"><span class="section-number-4">3.2.5.</span> templates/success.html</h4>
<div class="outline-text-4" id="text-3-2-5">
<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}
{% block content %}

&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Forma u&#382;pildyta s&#279;kmingai!</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;Email: {{form.email.data}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;Password: {{form.password.data}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;Adresas:&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{form.address1.data}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{form.address2.data}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{form.zip_code.data}} {{form.city.data}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{form.state.data}} raj.&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{form.agree.data}}&lt;/<span style="color: #b8bb26;">p</span>&gt;

{% endblock %}
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-orga352e92" class="outline-2">
<h2 id="orga352e92"><span class="section-number-2">4.</span> Flask 3 dalis</h2>
<div class="outline-text-2" id="text-4">
<p>
once again, do pip install flask-sqlalchemy==2.5.1
</p>

<p>
we will use this, not the current +3 version for some of the projects
listed below to work.
</p>
</div>

<div id="outline-container-org2d2ce98" class="outline-3">
<h3 id="org2d2ce98"><span class="section-number-3">4.1.</span> Duomenų bazės sukūrimas</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Flask leidžia mums dirbti su duomenų bazėmis, praktiškai nesitepant
rankų su SQL užklausomis. Viskuo pasirūpina modulis Flask-SQLAlchemy.
Iš principo tai yra SQLAlchemy, optimizuota Flask'ui. Ją galima
įdiegti naudojant pip install Flask-SQLAlchemy komandą.
</p>

<p>
Susikurkime pirmą duomenų bazę:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">import</span> os
<span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask
<span style="color: #fb4934;">from</span> flask_sqlalchemy <span style="color: #fb4934;">import</span> SQLAlchemy

<span style="color: #83a598;">basedir</span> = os.path.abspath<span style="color: #fe8019;">(</span>os.path.dirname<span style="color: #cc241d;">(</span>__file__<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">pilnas kelias iki &#353;io failo.</span>
<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>
app.app_context<span style="color: #fe8019;">()</span>.push<span style="color: #fe8019;">()</span>

app.<span style="color: #83a598;">config</span><span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'SQLALCHEMY_DATABASE_URI'</span><span style="color: #fe8019;">]</span> = <span style="color: #b8bb26;">'sqlite:///'</span>+os.path.join<span style="color: #fe8019;">(</span>basedir, <span style="color: #b8bb26;">'data.sqlite'</span><span style="color: #fe8019;">)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">nustat&#279;me, kad m&#363;s&#371; duomen&#371; baz&#279; bus &#353;alia &#353;io failo esants data.sqlite failas</span>
app.<span style="color: #83a598;">config</span><span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'SQLALCHEMY_TRACK_MODIFICATIONS'</span><span style="color: #fe8019;">]</span> = <span style="color: #d3869b;">False</span>
<span style="color: #928374;"># </span><span style="color: #928374;">neseksime kiekvienos modifikacijos</span>
<span style="color: #83a598;">db</span> = SQLAlchemy<span style="color: #fe8019;">(</span>app<span style="color: #fe8019;">)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">sukuriame duomen&#371; baz&#279;s objekt&#261;</span>
<span style="color: #928374;"># </span><span style="color: #928374;">sukurkime model&#303; u&#382;klausos formai, kuris sukurs duomen&#371; baz&#279;je lentel&#281;</span>


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Message</span><span style="color: #fe8019;">(</span>db.Model<span style="color: #fe8019;">)</span>:
    <span style="color: #928374;"># </span><span style="color: #928374;">DB lentelei priskiria pavadinim&#261;, jei nenurodysite, priskirs automati&#353;kai pagal klas&#279;s pavadinim&#261;.</span>
    <span style="color: #83a598;">__tablename__</span> = <span style="color: #b8bb26;">'messages'</span>
    <span style="color: #fe8019;">id</span> = db.Column<span style="color: #fe8019;">(</span>db.Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>  <span style="color: #928374;"># </span><span style="color: #928374;">stulpelis, kurio reik&#353;m&#279;s integer. Taip pat jis bus primary_key.</span>
    name = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>80<span style="color: #cc241d;">)</span>, nullable=<span style="color: #d3869b;">False</span><span style="color: #fe8019;">)</span>
    email = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>120<span style="color: #cc241d;">)</span>, unique=<span style="color: #d3869b;">True</span>, nullable=<span style="color: #d3869b;">False</span><span style="color: #fe8019;">)</span>
    message = db.Column<span style="color: #fe8019;">(</span>db.Text, nullable=<span style="color: #d3869b;">False</span><span style="color: #fe8019;">)</span>

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__init__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, name, email, message<span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">self</span>.name = name
        <span style="color: #fb4934;">self</span>.email = email
        <span style="color: #fb4934;">self</span>.message = message

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">'</span>{<span style="color: #fb4934;">self</span>.name}<span style="color: #b8bb26;"> - </span>{<span style="color: #fb4934;">self</span>.email}<span style="color: #b8bb26;">'</span>
</pre>
</div>

<p>
class Message yra aprašyta mūsų duomenų bazės lentelė. Paleidus šį
failą, duomenų bazė nesusikurs, reikia inicijuoti šį veiksmą iš išorės
(per konsolę arba kitą Python script'ą). Susikurkime dar vieną Python
failą:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> app <span style="color: #fb4934;">import</span> db, Message

db.create_all<span style="color: #fe8019;">()</span>  <span style="color: #928374;"># </span><span style="color: #928374;">sukurs m&#363;s&#371; lentel&#281; DB</span>

<span style="color: #928374;"># </span><span style="color: #928374;">I&#353; karto inicijuosime testams kelet&#261; &#303;ra&#353;&#371;:</span>
jonas = Message<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Jonas'</span>, <span style="color: #b8bb26;">'jonas@mail.com'</span>, <span style="color: #b8bb26;">'Ka&#382;koks labai rimtas atsiliepimas.'</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">antanas</span> = Message<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Antanas'</span>, <span style="color: #b8bb26;">'antanas@mail.lt'</span>, <span style="color: #b8bb26;">'Antano nuomon&#279; labai svarbi.'</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">juozas</span> = Message<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Juozas'</span>, <span style="color: #b8bb26;">'juozukas@friends.lt'</span>, <span style="color: #b8bb26;">'A&#353; labai piktas, nes blogai.'</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">bronius</span> = Message<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Bronius'</span>, <span style="color: #b8bb26;">'bronka@yahoo.com'</span>, <span style="color: #b8bb26;">'A&#353; tai linksmas esu, man patinka.'</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">Prid&#279;sime &#353;iuos veik&#279;jus &#303; m&#363;s&#371; DB</span>
db.session.add_all<span style="color: #fe8019;">(</span><span style="color: #cc241d;">[</span>jonas, antanas, juozas, bronius<span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">.commit i&#353;saugo pakeitimus</span>
db.session.commit<span style="color: #fe8019;">()</span>

<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>jonas.<span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>antanas.<span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>bronius.<span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>juozas.<span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">1</span>
<span style="color: #928374;"># </span><span style="color: #928374;">2</span>
<span style="color: #928374;"># </span><span style="color: #928374;">4</span>
<span style="color: #928374;"># </span><span style="color: #928374;">3</span>
</pre>
</div>

<p>
.create_all() įrašė lentelę į DB, inicijuoti testiniai duomenys taip
pat sėkmingai nukeliavo į lentelę, atsispausdinome jų ID, kurie buvo
sugeneruoti automatiškai.
</p>
</div>

<div id="outline-container-orgf1c24e6" class="outline-4">
<h4 id="orgf1c24e6"><span class="section-number-4">4.1.1.</span> Paprastos CRUD operacijos</h4>
<div class="outline-text-4" id="text-4-1-1">
<p>
Susikurkime dar vieną failą, crud operacijų demonstracijai.
Atsispausdinkime visus lentelėje esančius objektus:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> app <span style="color: #fb4934;">import</span> db, Message

<span style="color: #83a598;">all_messages</span> = Message.query.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>all_messages<span style="color: #fe8019;">)</span>

<span style="color: #928374;">#  </span><span style="color: #928374;">[Jonas - jonas@mail.com, Antanas - antanas@mail.lt, Juozas - juozukas@friends.lt, Bronius - bronka@yahoo.com]</span>
</pre>
</div>

<p>
Atsispausdinkime vieną iš objektų:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">message_1</span> = Message.query.get<span style="color: #fe8019;">(</span>1<span style="color: #fe8019;">)</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>message_1<span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">Jonas - jonas@mail.com</span>
</pre>
</div>


<p>
Išfiltruokime objektą pagal nurodytą požymį:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">message_antanas</span> = Message.query.filter_by<span style="color: #fe8019;">(</span>name=<span style="color: #b8bb26;">'Antanas'</span><span style="color: #fe8019;">)</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>message_antanas.<span style="color: #fe8019;">all</span><span style="color: #cc241d;">()</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">[Antanas - antanas@mail.lt]</span>
</pre>
</div>

<p>
filter_by išrinks mums visus įrašus, kuriuose name='Antanas'
</p>

<p>
Pakeiskime Antano el. paštą:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">antanas</span> = Message.query.get<span style="color: #fe8019;">(</span>2<span style="color: #fe8019;">)</span>
antanas.<span style="color: #83a598;">email</span> = <span style="color: #b8bb26;">'geras.zmogus@lrs.lt'</span>
db.session.add<span style="color: #fe8019;">(</span>antanas<span style="color: #fe8019;">)</span>
db.session.commit<span style="color: #fe8019;">()</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>Message.query.<span style="color: #fe8019;">all</span><span style="color: #cc241d;">()</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">[Jonas - jonas@mail.com, Antanas - geras.zmogus@lrs.lt, Juozas - juozukas@friends.lt, Bronius - bronka@yahoo.com]</span>
</pre>
</div>

<p>
Ištrinkime Joną:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">jonas</span> = Message.query.get<span style="color: #fe8019;">(</span>1<span style="color: #fe8019;">)</span>
db.session.delete<span style="color: #fe8019;">(</span>jonas<span style="color: #fe8019;">)</span>
db.session.commit<span style="color: #fe8019;">()</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>Message.query.<span style="color: #fe8019;">all</span><span style="color: #cc241d;">()</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">[Antanas - geras.zmogus@lrs.lt, Juozas - juozukas@friends.lt, Bronius - bronka@yahoo.com]</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf4fd6bc" class="outline-3">
<h3 id="orgf4fd6bc"><span class="section-number-3">4.2.</span> Duomenų bazės migracija</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Jeigu mums prireiktų papildyti savo lentelę papildomu stulpeliu,
tiesiog papildžius klasę Message nauja eilute mums nepavyktų, kadangi
duomenų bazė jau inicijuota tokia, kokią nurodėme pirmą kartą. Tą
reikia turėti omenyje, kas kartą, kuriant duomenų bazę stengtis
pasidaryti ją kuo išbaigtesnę. Tuomet ateityje, norint ją papildyti
naujais stulpeliais, ar pakeisti esamų nustatymus, reikės mažiau
migracijos procesų. Susitvarkykime savo projektą taip, kad galėtumėm
vykdyti migracijas:
</p>

<p>
nustatykime FLASK-APP aplinkos kintamąjį (environment variable). Tą
reikės padaryti Windows komandinėje eilutėje, arba Linux/MacOS
terminale:
</p>

<p>
<b>windows</b> - set FLASK_APP=failas_kuriame_musu_db_modelis.py
</p>

<p>
<b>linux/macOS</b> - <code>export FLASK_APP=failas_kuriame_musu_db_modelis.py</code>
</p>

<p>
įsitikinkite, kad komandą leidžiate iš to paties katalogo, kuriame
failas su jūsų DB modeliu.
</p>

<p>
įdiekime Flask-Migrate paketą (pip install Flask-Migrate)
</p>

<p>
pertvarkykime savo .py failą:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">import</span> os
<span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask
<span style="color: #fb4934;">from</span> flask_sqlalchemy <span style="color: #fb4934;">import</span> SQLAlchemy
<span style="color: #fb4934;">from</span> flask_migrate <span style="color: #fb4934;">import</span> Migrate  <span style="color: #928374;"># </span><span style="color: #928374;">importuojame migracijas</span>

<span style="color: #83a598;">basedir</span> = os.path.abspath<span style="color: #fe8019;">(</span>os.path.dirname<span style="color: #cc241d;">(</span>__file__<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>

app.<span style="color: #83a598;">config</span><span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'SQLALCHEMY_DATABASE_URI'</span><span style="color: #fe8019;">]</span> = <span style="color: #b8bb26;">'sqlite:///'</span>+os.path.join<span style="color: #fe8019;">(</span>basedir, <span style="color: #b8bb26;">'data.sqlite'</span><span style="color: #fe8019;">)</span>
app.<span style="color: #83a598;">config</span><span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'SQLALCHEMY_TRACK_MODIFICATIONS'</span><span style="color: #fe8019;">]</span> = <span style="color: #d3869b;">False</span>
<span style="color: #83a598;">db</span> = SQLAlchemy<span style="color: #fe8019;">(</span>app<span style="color: #fe8019;">)</span>

Migrate<span style="color: #fe8019;">(</span>app, db<span style="color: #fe8019;">)</span>  <span style="color: #928374;"># </span><span style="color: #928374;">Susiejame app ir db.</span>


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Message</span><span style="color: #fe8019;">(</span>db.Model<span style="color: #fe8019;">)</span>:
    <span style="color: #83a598;">__tablename__</span> = <span style="color: #b8bb26;">'messages'</span>
    <span style="color: #fe8019;">id</span> = db.Column<span style="color: #fe8019;">(</span>db.Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    name = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>80<span style="color: #cc241d;">)</span>, nullable=<span style="color: #d3869b;">False</span><span style="color: #fe8019;">)</span>
    email = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>120<span style="color: #cc241d;">)</span>, unique=<span style="color: #d3869b;">True</span>, nullable=<span style="color: #d3869b;">False</span><span style="color: #fe8019;">)</span>
    phone = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>40<span style="color: #cc241d;">)</span>, unique=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>  <span style="color: #928374;"># </span><span style="color: #928374;">Papildome duomen&#371; baz&#279;s model&#303; nauju stulpeliu.</span>
    message = db.Column<span style="color: #fe8019;">(</span>db.Text, nullable=<span style="color: #d3869b;">False</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">prie konstruktoriaus irgi nepamir&#353;tame prid&#279;ti:</span>
    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__init__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, name, email, message, phone<span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">self</span>.name = name
        <span style="color: #fb4934;">self</span>.email = email
        <span style="color: #fb4934;">self</span>.message = message
        <span style="color: #fb4934;">self</span>.phone = phone

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">'</span>{<span style="color: #fb4934;">self</span>.name}<span style="color: #b8bb26;"> - </span>{<span style="color: #fb4934;">self</span>.email}<span style="color: #b8bb26;">'</span>
</pre>
</div>

<p>
Importus papildėme migracijos 'tarnyba':) Jai nurodėme, kokią
aplikaciją susieti su kokia duomenų baze. Papildėme duomenų bazės
modelį nauju stulpeliu (phone).
</p>

<p>
Inicijuokime migracijas mūsų projektui su komanda <code>flask db init</code>:
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #fe8019;">(</span>flask-kursui<span style="color: #fe8019;">)</span> robotautas@robotautas-MS-7A34:~/Dropbox/Flask 3 dalis/Code$ flask db init
Creating directory /home/robotautas/Dropbox/Flask 3 dalis/Code/migrations ...  done
Creating directory /home/robotautas/Dropbox/Flask 3 dalis/Code/migrations/versions ...  done
Generating /home/robotautas/Dropbox/Flask 3 dalis/Code/migrations/alembic.ini ...  done
Generating /home/robotautas/Dropbox/Flask 3 dalis/Code/migrations/README ...  done
Generating /home/robotautas/Dropbox/Flask 3 dalis/Code/migrations/env.py ...  done
Generating /home/robotautas/Dropbox/Flask 3 dalis/Code/migrations/script.py.mako ...  done
Please edit configuration/connection/logging settings<span style="color: #fb4934;"> in</span> <span style="color: #b8bb26;">'/home/robotautas/Dropbox/Flask 3 dalis/Code/migrations/alembic.ini'</span> before proceeding.
<span style="color: #fe8019;">(</span>flask-kursui<span style="color: #fe8019;">)</span> robotautas@robotautas-MS-7A34:~/Dropbox/Flask 3 dalis/Code$ ls
app.py  data.sqlite  migrations  __pycache__  setupdb.py  simple_crud.py  test.py
</pre>
</div>

<p>
matome, kad sukurtas migracijų katalogas. Dabar paruoškime savo pirmą
migraciją, <code>flask db migrate -m "žinutė atminčiai"</code>:
</p>

<p>
(jei tai darome pakartotinai ir matome klaidą "ERROR [flask_migrate]
Error: Target database is not up to date.", reikės prieš tai paleisti
"flask db stamp head")
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #fe8019;">(</span>flask-kursui<span style="color: #fe8019;">)</span> robotautas@robotautas-MS-7A34:~/Dropbox/Flask 3 dalis/Code$ flask db migrate -m <span style="color: #b8bb26;">"prid&#279;tas stulpelis phone"</span>
INFO  <span style="color: #fe8019;">[</span>alembic.runtime.migration<span style="color: #fe8019;">]</span> Context impl SQLiteImpl.
INFO  <span style="color: #fe8019;">[</span>alembic.runtime.migration<span style="color: #fe8019;">]</span> Will assume non-transactional DDL.
INFO  <span style="color: #fe8019;">[</span>alembic.autogenerate.compare<span style="color: #fe8019;">]</span> Detected added column <span style="color: #b8bb26;">'messages.phone'</span>
INFO  <span style="color: #fe8019;">[</span>alembic.autogenerate.compare<span style="color: #fe8019;">]</span> Detected added unique constraint <span style="color: #b8bb26;">'None'</span> on <span style="color: #b8bb26;">'['</span>phone<span style="color: #b8bb26;">']'</span>
Generating /home/robotautas/Dropbox/Flask 3 dalis/Code/migrations/versions/d31d8cda085d_prid&#279;tas_stulpelis_phone.py ...  done
</pre>
</div>

<p>
matome, kad aptikti pakeitimai. Dabar įvykdykime pačią migraciją,
<code>flask db upgrade</code>:
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #fe8019;">(</span>flask-kursui<span style="color: #fe8019;">)</span> robotautas@robotautas-MS-7A34:~/Dropbox/Flask 3 dalis/Code$ flask db upgrade
INFO  <span style="color: #fe8019;">[</span>alembic.runtime.migration<span style="color: #fe8019;">]</span> Context impl SQLiteImpl.
INFO  <span style="color: #fe8019;">[</span>alembic.runtime.migration<span style="color: #fe8019;">]</span> Will assume non-transactional DDL.
INFO  <span style="color: #fe8019;">[</span>alembic.runtime.migration<span style="color: #fe8019;">]</span> Running upgrade  -&gt; d31d8cda085d, prid&#279;tas stulpelis phone
ERROR <span style="color: #fe8019;">[</span>root<span style="color: #fe8019;">]</span> Error: No support for ALTER of constraints<span style="color: #fb4934;"> in</span> SQLite dialect

<span style="color: #928374;"># </span><span style="color: #928374;">klaidel&#281; galime ignoruoti, ne visi&#353;kas dialekto palaikymas..</span>
</pre>
</div>

<p>
patikrinkime, ar suveikė:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">messages</span> = Message.query.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>

<span style="color: #fb4934;">for</span> i <span style="color: #fb4934;">in</span> <span style="color: #83a598;">messages</span>:
    random_phone = randint<span style="color: #fe8019;">(</span>999999, 10000000<span style="color: #fe8019;">)</span>
    i.<span style="color: #83a598;">phone</span> = <span style="color: #fe8019;">str</span><span style="color: #fe8019;">(</span>random_phone<span style="color: #fe8019;">)</span>
    db.session.add<span style="color: #fe8019;">(</span>i<span style="color: #fe8019;">)</span>

db.session.commit<span style="color: #fe8019;">()</span>

<span style="color: #fb4934;">for</span> x <span style="color: #fb4934;">in</span> messages:
    <span style="color: #fe8019;">print</span> <span style="color: #fe8019;">(</span>f<span style="color: #b8bb26;">'</span>{x.<span style="color: #fe8019;">id</span>}<span style="color: #b8bb26;">, </span>{x.name}<span style="color: #b8bb26;">, </span>{x.email}<span style="color: #b8bb26;">, </span>{x.phone}<span style="color: #b8bb26;">, </span>{x.message}<span style="color: #b8bb26;">'</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">2, Antanas, geras.zmogus@lrs.lt, 9033639, Antano nuomon&#279; labai svarbi.</span>
<span style="color: #928374;"># </span><span style="color: #928374;">3, Juozas, juozukas@friends.lt, 2233484, A&#353; labai piktas, nes blogai.</span>
<span style="color: #928374;"># </span><span style="color: #928374;">4, Bronius, bronka@yahoo.com, 4211290, A&#353; tai linksmas esu, man patinka.</span>
</pre>
</div>

<p>
Jeigu atkreipėte dėmesį, migracijų procesas labai panašus į GIT procesus.
</p>
</div>
</div>

<div id="outline-container-org886b244" class="outline-3">
<h3 id="org886b244"><span class="section-number-3">4.3.</span> Uzduotis</h3>
<div class="outline-text-3" id="text-4-3">
<p>
Sukurkite peticijos puslapį. Gali pažiūrėti <a href="https://github.com/robotautas/kursas/blob/master/Flask/Flask_3_uzduotis/Uzduotis/take1.mkv">demonstraciją</a>, kaip turėtų
atrodyti galutinis rezultatas.
</p>

<p>
Šiame puslapyje turėtų būti išpildyti žemiau išvardinti reikalavimai:
</p>

<p>
Puslapio navigacijoje turi būti nuorodos į pagrindinį puslapį ir
/about.
</p>

<p>
Pagrindiniame puslapyje turi būti forma, kurioje reikia įvesti vardą,
pavardę ir komentarą. Po ja - pasirašiusiųjų sąrašas: eil.nr, vardas
pavardė, data ir komentaras
</p>

<p>
Jeigu forma užpildyta sėkmingai, sąrašas papildomas paskutiniu įrašu,
o vietoje formos atsiranda padėkos žinutė (angl. success message).
</p>

<p>
Įrašus saugokite sqlite duomenų bazėjė.
</p>

<p>
Jums reikės atrasti būdą, kaip prieš sugeneruojant šabloną į duomenų
bazę perkelti formos duomenis
</p>

<p>
Pavienės wtf-formos reikšmės traukiamos taip, pvz: form.name.data
</p>

<p>
Padaryti formos validaciją (šitą galite pasilikti pabaigai ir
padaryti, jeigu liks laiko)
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #928374;"># </span><span style="color: #928374;">app.py</span>

<span style="color: #fb4934;">import</span> os
<span style="color: #fb4934;">from</span> datetime <span style="color: #fb4934;">import</span> datetime
<span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, render_template
<span style="color: #fb4934;">from</span> flask_migrate <span style="color: #fb4934;">import</span> Migrate
<span style="color: #fb4934;">from</span> flask_sqlalchemy <span style="color: #fb4934;">import</span> SQLAlchemy
<span style="color: #fb4934;">from</span> form <span style="color: #fb4934;">import</span> MessageForm


<span style="color: #83a598;">basedir</span> = os.path.abspath<span style="color: #fe8019;">(</span>os.path.dirname<span style="color: #cc241d;">(</span>__file__<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>
app.<span style="color: #83a598;">config</span><span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'SECRET_KEY'</span><span style="color: #fe8019;">]</span> = <span style="color: #b8bb26;">'bet kokia simboli&#371; eilut&#279;'</span>
app.<span style="color: #83a598;">config</span><span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'SQLALCHEMY_DATABASE_URI'</span><span style="color: #fe8019;">]</span> = <span style="color: #b8bb26;">'sqlite:///'</span>+os.path.join<span style="color: #fe8019;">(</span>basedir, <span style="color: #b8bb26;">'data.sqlite'</span><span style="color: #fe8019;">)</span>

app.<span style="color: #83a598;">config</span><span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'SQLALCHEMY_TRACK_MODIFICATIONS'</span><span style="color: #fe8019;">]</span> = <span style="color: #d3869b;">False</span>
<span style="color: #83a598;">db</span> = SQLAlchemy<span style="color: #fe8019;">(</span>app<span style="color: #fe8019;">)</span>
Migrate<span style="color: #fe8019;">(</span>app, db<span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Message</span><span style="color: #fe8019;">(</span>db.Model<span style="color: #fe8019;">)</span>:
    <span style="color: #83a598;">__tablename__</span> = <span style="color: #b8bb26;">'messages'</span>
    <span style="color: #fe8019;">id</span> = db.Column<span style="color: #fe8019;">(</span>db.Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    fname = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>80<span style="color: #cc241d;">)</span>, nullable=<span style="color: #d3869b;">False</span><span style="color: #fe8019;">)</span>
    lname = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>80<span style="color: #cc241d;">)</span>, nullable=<span style="color: #d3869b;">False</span><span style="color: #fe8019;">)</span>
    date = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>80<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    comment = db.Column<span style="color: #fe8019;">(</span>db.Text, nullable=<span style="color: #d3869b;">False</span><span style="color: #fe8019;">)</span>

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__init__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, fname, lname, comment, date<span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">self</span>.fname = fname
        <span style="color: #fb4934;">self</span>.lname = lname
        <span style="color: #fb4934;">self</span>.comment = comment
        <span style="color: #fb4934;">self</span>.date = date

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">'</span>{<span style="color: #fb4934;">self</span>.fname}<span style="color: #b8bb26;"> - </span>{<span style="color: #fb4934;">self</span>.lname}<span style="color: #b8bb26;">'</span>


<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'/'</span>, methods=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">'GET'</span>, <span style="color: #b8bb26;">'POST'</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">index</span><span style="color: #fe8019;">()</span>:
    data = Message.query.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()[</span>::-1<span style="color: #fe8019;">]</span>
    form = MessageForm<span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">if</span> form.validate_on_submit<span style="color: #fe8019;">()</span>:
        fname = form.fname.data
        lname = form.lname.data
        comment = form.comment.data
        now = datetime.now<span style="color: #fe8019;">()</span>
        date = now.strftime<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"%d/%m/%Y %H:%M:%S"</span><span style="color: #fe8019;">)</span>
        entry = Message<span style="color: #fe8019;">(</span>fname=fname, lname=lname, comment=comment, date=date<span style="color: #fe8019;">)</span>
        db.session.add<span style="color: #fe8019;">(</span>entry<span style="color: #fe8019;">)</span>
        db.session.commit<span style="color: #fe8019;">()</span>
        data = Message.query.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()[</span>::-1<span style="color: #fe8019;">]</span>
        stats = 20000 - <span style="color: #fe8019;">len</span><span style="color: #fe8019;">(</span>data<span style="color: #fe8019;">)</span>
        <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'index.html'</span>, form=<span style="color: #d3869b;">False</span>, data=data, stats = stats<span style="color: #fe8019;">)</span>
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'index.html'</span>, form=form, data=data<span style="color: #fe8019;">)</span>


<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'/about'</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">about</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'about.html'</span><span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">'__main__'</span>:
  app.run<span style="color: #fe8019;">(</span>host=<span style="color: #b8bb26;">'127.0.0.1'</span>, port=8000, debug=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #928374;"># </span><span style="color: #928374;">form.py</span>
<span style="color: #fb4934;">from</span> flask_wtf <span style="color: #fb4934;">import</span> FlaskForm
<span style="color: #fb4934;">from</span> wtforms <span style="color: #fb4934;">import</span> StringField, TextAreaField, SubmitField
<span style="color: #fb4934;">from</span> wtforms.validators <span style="color: #fb4934;">import</span> DataRequired


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">MessageForm</span><span style="color: #fe8019;">(</span>FlaskForm<span style="color: #fe8019;">)</span>:
    <span style="color: #83a598;">fname</span> = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Vardas'</span>, <span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">()</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    <span style="color: #83a598;">lname</span> = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Pavard&#279;'</span>, <span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">()</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    <span style="color: #83a598;">comment</span> = TextAreaField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Komentaras'</span><span style="color: #fe8019;">)</span>
    <span style="color: #83a598;">submit</span> = SubmitField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Pasira&#353;yti'</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-html"><span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">about.html</span><span style="color: #928374;"> --&gt;</span>
{% extends "base.html" %}

{% block content %}
&lt;<span style="color: #b8bb26;">img</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://images2.minutemediacdn.com/image/upload/c_fill,g_auto,h_1248,w_2220/f_auto,q_auto,w_1100/v1555446335/shape/mentalfloss/istock_000019974211_small.jpg"</span> /&gt;
&lt;<span style="color: #b8bb26;">br</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis.
  Summus brains sit&#8203;&#8203;, morbo vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris. Hi mindless
  mortuis soulless creaturas, imo evil stalking monstra adventus resi dentevil vultus comedat cerebella viventium.
  Qui animated corpse, cricket bat max brucks terribilem incessu zomby. The voodoo sacerdos flesh eater, suscitat
  mortuos comedere carnem virus. Zonbi tattered for solum oculi eorum defunctis go lum cerebro. Nescio brains an
  Undead zombies. Sicut malus putrid voodoo horror. Nigh tofth eliv ingdead.
&lt;/<span style="color: #b8bb26;">p</span>&gt;
{% endblock %}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-html"><span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">base.html</span><span style="color: #928374;"> --&gt;</span>

&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;

&lt;<span style="color: #b8bb26;">head</span>&gt;

  &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"utf-8"</span>&gt;
  &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"viewport"</span> <span style="color: #83a598;">content</span>=<span style="color: #b8bb26;">"width=device-width, initial-scale=1, shrink-to-fit=no"</span>&gt;
  &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"description"</span> <span style="color: #83a598;">content</span>=<span style="color: #b8bb26;">""</span>&gt;
  &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"author"</span> <span style="color: #83a598;">content</span>=<span style="color: #b8bb26;">""</span>&gt;

  &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Bare - Start Bootstrap Template</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;

  <span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">Bootstrap core CSS</span><span style="color: #928374;"> --&gt;</span>
  &lt;<span style="color: #b8bb26;">link</span> <span style="color: #83a598;">rel</span>=<span style="color: #b8bb26;">"stylesheet"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"</span> <span style="color: #83a598;">integrity</span>=<span style="color: #b8bb26;">"sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"</span> <span style="color: #83a598;">crossorigin</span>=<span style="color: #b8bb26;">"anonymous"</span>&gt;


&lt;/<span style="color: #b8bb26;">head</span>&gt;

&lt;<span style="color: #b8bb26;">body</span>&gt;

  <span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">Navigation</span><span style="color: #928374;"> --&gt;</span>
  &lt;<span style="color: #b8bb26;">nav</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar navbar-expand-lg navbar-dark bg-primary static-top"</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"container"</span>&gt;
      &lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-brand"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"/"</span>&gt;Bebr&#371; med&#382;ioklei NE!&lt;/<span style="color: #b8bb26;">a</span>&gt;
      &lt;<span style="color: #b8bb26;">button</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-toggler"</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"button"</span> <span style="color: #83a598;">data-toggle</span>=<span style="color: #b8bb26;">"collapse"</span> <span style="color: #83a598;">data-target</span>=<span style="color: #b8bb26;">"#navbarResponsive"</span> <span style="color: #83a598;">aria-controls</span>=<span style="color: #b8bb26;">"navbarResponsive"</span> <span style="color: #83a598;">aria-expanded</span>=<span style="color: #b8bb26;">"false"</span> <span style="color: #83a598;">aria-label</span>=<span style="color: #b8bb26;">"Toggle navigation"</span>&gt;
        &lt;<span style="color: #b8bb26;">span</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-toggler-icon"</span>&gt;&lt;/<span style="color: #b8bb26;">span</span>&gt;
      &lt;/<span style="color: #b8bb26;">button</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"collapse navbar-collapse"</span> <span style="color: #83a598;">id</span>=<span style="color: #b8bb26;">"navbarResponsive"</span>&gt;
        &lt;<span style="color: #b8bb26;">ul</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-nav ml-auto"</span>&gt;
          &lt;<span style="color: #b8bb26;">li</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-item"</span>&gt;
            &lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-link"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"/"</span>&gt;Peticija&lt;/<span style="color: #b8bb26;">a</span>&gt;
          &lt;/<span style="color: #b8bb26;">li</span>&gt;
          &lt;<span style="color: #b8bb26;">li</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-item"</span>&gt;
            &lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-link"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"/about"</span>&gt;Apie&lt;/<span style="color: #b8bb26;">a</span>&gt;
          &lt;/<span style="color: #b8bb26;">li</span>&gt;
        &lt;/<span style="color: #b8bb26;">ul</span>&gt;
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
  &lt;/<span style="color: #b8bb26;">nav</span>&gt;

  <span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">Page Content</span><span style="color: #928374;"> --&gt;</span>
&lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"container"</span>&gt;
  &lt;<span style="color: #b8bb26;">br</span>&gt;
{% block content %}
{% endblock %}
&lt;/<span style="color: #b8bb26;">div</span>&gt;


  <span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">Bootstrap core JavaScript</span><span style="color: #928374;"> --&gt;</span>
&lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://code.jquery.com/jquery-3.3.1.slim.min.js"</span> <span style="color: #83a598;">integrity</span>=<span style="color: #b8bb26;">"sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"</span> <span style="color: #83a598;">crossorigin</span>=<span style="color: #b8bb26;">"anonymous"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
&lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"</span> <span style="color: #83a598;">integrity</span>=<span style="color: #b8bb26;">"sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"</span> <span style="color: #83a598;">crossorigin</span>=<span style="color: #b8bb26;">"anonymous"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
&lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"</span> <span style="color: #83a598;">integrity</span>=<span style="color: #b8bb26;">"sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"</span> <span style="color: #83a598;">crossorigin</span>=<span style="color: #b8bb26;">"anonymous"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;

&lt;/<span style="color: #b8bb26;">body</span>&gt;

&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>

<div class="org-src-container">
<pre class="src src-html"><span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">index.html</span><span style="color: #928374;"> --&gt;</span>

{% extends "base.html" %}

{% block content %}
{% if form %}
&lt;<span style="color: #b8bb26;">h4</span>&gt;<span style="text-decoration: underline;">M&#363;s&#371; &#353;ventas tikslas yra u&#382;kirsti keli&#261; barbari&#353;kai bebr&#371; med&#382;ioklei. Pra&#353;ome pasira&#353;yti peticij&#261;!</span>&lt;/<span style="color: #b8bb26;">h4</span>&gt;
&lt;<span style="color: #b8bb26;">br</span>&gt;

&lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"#"</span>&gt;
      {{ form.hidden_tag() }}
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
      {{ form.fname.label(class="form-control-label") }}
      {{ form.fname(class="form-control") }}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
      {{ form.lname.label(class="form-control-label") }}
      {{ form.lname(class="form-control") }}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
      {{ form.comment.label(class="form-control-label") }}
      {{ form.comment(class="form-control", <span style="color: #83a598;">rows</span>="5") }}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      {{ form.submit }}
  &lt;/<span style="color: #b8bb26;">form</span>&gt;
{% else %}

&lt;<span style="color: #b8bb26;">h3</span>&gt;<span style="font-style: italic; text-decoration: underline;">A&#269;i&#363;, kad pasira&#353;&#279;te. Mums liko surinkti {{stats}} para&#353;&#371;!</span>&lt;/<span style="color: #b8bb26;">h3</span>&gt;

{% endif %}
{% for i in data %}
&lt;<span style="color: #b8bb26;">hr</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{i.id}}. {{i.fname}} {{i.lname}}, {{i.date}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{i.comment}}&lt;/<span style="color: #b8bb26;">p</span>&gt;


{% endfor %}
{% endblock %}
</pre>
</div>


<p>
<a href="https://github.com/CodeAcademy-Online/Python/tree/lesson-16">Atsakymai</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org5a5b87a" class="outline-2">
<h2 id="org5a5b87a"><span class="section-number-2">5.</span> Flask 4 dalis</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org7e904f0" class="outline-3">
<h3 id="org7e904f0"><span class="section-number-3">5.1.</span> One2Many</h3>
<div class="outline-text-3" id="text-5-1">
<p>
Dauguma programų turi po daugiau negu vieną duomenų bazės modelį.
Įsivaizduokime, kad turime du modelius - knyga ir leidykla:
</p>

<ul class="org-ul">
<li>Knyga
<ul class="org-ul">
<li>ISBN (Primary Key)</li>
<li>Autorius</li>
<li>Pavadinimas</li>
<li>Leidyklos ID (Foreign Key)</li>
</ul></li>

<li>Leidykla
<ul class="org-ul">
<li>ID (Primary Key)</li>
<li>Pavadinimas</li>
<li>Adresas</li>
</ul></li>
</ul>

<p>
Viena leidykla gali turėti daug knygų, pabandykime sumodeliuoti
duomenų bazę šiam atvejui.
</p>

<p>
Susikurkime app.py:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">import</span> os
<span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask
<span style="color: #fb4934;">from</span> flask_sqlalchemy <span style="color: #fb4934;">import</span> SQLAlchemy
<span style="color: #fb4934;">from</span> flask_migrate <span style="color: #fb4934;">import</span> Migrate

<span style="color: #83a598;">basedir</span> = os.path.abspath<span style="color: #fe8019;">(</span>os.path.dirname<span style="color: #cc241d;">(</span>__file__<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>

<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>
app.app_context<span style="color: #fe8019;">()</span>.push<span style="color: #fe8019;">()</span>

app.<span style="color: #83a598;">config</span><span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'SQLALCHEMY_DATABASE_URI'</span><span style="color: #fe8019;">]</span> = <span style="color: #b8bb26;">'sqlite:///'</span> + os.path.join<span style="color: #fe8019;">(</span>basedir, <span style="color: #b8bb26;">'data.sqlite'</span><span style="color: #fe8019;">)</span>
app.<span style="color: #83a598;">config</span><span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'SQLALCHEMY_TRACK_MODIFICATIONS'</span><span style="color: #fe8019;">]</span> = <span style="color: #d3869b;">False</span>

<span style="color: #83a598;">db</span> = SQLAlchemy<span style="color: #fe8019;">(</span>app<span style="color: #fe8019;">)</span>
Migrate<span style="color: #fe8019;">(</span>app, db<span style="color: #fe8019;">)</span>

<span style="color: #b8bb26;">'''</span>
<span style="color: #b8bb26;">Klas&#279;je Book mus domina publisher_id kintamasis. Jis susieja klas&#281; Book su klase Publisher per ForeignKey,</span>
<span style="color: #b8bb26;">kuriame parametruose nurodytas kitos lentel&#279;s pavadinimas ir prie kurio lauko ri&#353;ame, t.y. prie id,</span>
<span style="color: #b8bb26;">kuris publishers lentel&#279;je yra primary_key.</span>
<span style="color: #b8bb26;">'''</span>
<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Book</span><span style="color: #fe8019;">(</span>db.Model<span style="color: #fe8019;">)</span>:

    <span style="color: #83a598;">__tablename__</span> = <span style="color: #b8bb26;">'books'</span>
    <span style="color: #fe8019;">id</span> = db.Column<span style="color: #fe8019;">(</span>db.Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    author = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>150<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    title = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>300<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    publisher_id = db.Column<span style="color: #fe8019;">(</span>db.Integer, db.ForeignKey<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'publishers.id'</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__init__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, author, title, publisher_id<span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">self</span>.author = author
        <span style="color: #fb4934;">self</span>.title = title
        <span style="color: #fb4934;">self</span>.publisher_id = publisher_id

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> <span style="color: #fb4934;">self</span>.title

<span style="color: #b8bb26;">'''</span>
<span style="color: #b8bb26;">Klas&#279;je Publisher, atgalin&#303; ry&#353;&#303; su Books klase sukuria books kintam&#261;jam priskirta eilut&#279;.</span>
<span style="color: #b8bb26;">Parametruose nurodyta klas&#279;, su kuria siejame ir backref - kol kas &#382;i&#363;r&#279;kite, kaip &#303; papildom&#261;</span>
<span style="color: #b8bb26;">sait&#261; tarp python klasi&#371;.</span>
<span style="color: #b8bb26;">'''</span>
<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Publisher</span><span style="color: #fe8019;">(</span>db.Model<span style="color: #fe8019;">)</span>:

    __tablename__ = <span style="color: #b8bb26;">'publishers'</span>
    <span style="color: #fe8019;">id</span> = db.Column<span style="color: #fe8019;">(</span>db.Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    name = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>100<span style="color: #cc241d;">)</span>, unique=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    books = db.relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Book'</span>, backref=<span style="color: #b8bb26;">'publisher'</span><span style="color: #fe8019;">)</span>

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__init__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, name<span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">self</span>.name = name

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> <span style="color: #fb4934;">self</span>.name
</pre>
</div>

<p>
Sukūrėme du modelius, šiek tiek detalių rasite komentaruose.
Išbandykime, ar veikia:
</p>

<p>
terminale -
</p>
<ul class="org-ul">
<li>set FLASK_APP=app.py,</li>
<li>flask db init,</li>
<li>flask db migrate -m "pirma migracija",</li>
<li>flask db upgrade.</li>
</ul>

<p>
šį kartą dirbsime iš python konsolės:
</p>

<div class="org-src-container">
<pre class="src src-python">Python 3.7.3 <span style="color: #fe8019;">(</span>default, Mar 27 2019, 22:11:17<span style="color: #fe8019;">)</span>
<span style="color: #fe8019;">[</span>GCC 7.3.0<span style="color: #fe8019;">]</span> :: Anaconda, Inc. on linux
Type <span style="color: #b8bb26;">"help"</span>, <span style="color: #b8bb26;">"copyright"</span>, <span style="color: #b8bb26;">"credits"</span> <span style="color: #fb4934;">or</span> <span style="color: #b8bb26;">"license"</span> <span style="color: #fb4934;">for</span> more information.
&gt;&gt;&gt; <span style="color: #fb4934;">from</span> app <span style="color: #fb4934;">import</span> db, Book, Publisher
&gt;&gt;&gt; <span style="color: #83a598;">pub1</span> = Publisher<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Baltos Lankos'</span><span style="color: #fe8019;">)</span>
&gt;&gt;&gt; <span style="color: #83a598;">pub2</span> = Publisher<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Alma Littera'</span><span style="color: #fe8019;">)</span>
&gt;&gt;&gt; db.session.add_all<span style="color: #fe8019;">(</span><span style="color: #cc241d;">[</span>pub1, pub2<span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
&gt;&gt;&gt; db.session.commit<span style="color: #fe8019;">()</span>
&gt;&gt;&gt; <span style="color: #83a598;">book1</span> = Book<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Bili&#363;nas'</span>, <span style="color: #b8bb26;">'Kliud&#382;iau'</span>, 1<span style="color: #fe8019;">)</span>
&gt;&gt;&gt; <span style="color: #83a598;">book2</span> = Book<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'&#381;emait&#279;'</span>, <span style="color: #b8bb26;">'Marti'</span>, 1<span style="color: #fe8019;">)</span>
&gt;&gt;&gt; <span style="color: #83a598;">book3</span> = Book<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Ma&#382;vydas'</span>, <span style="color: #b8bb26;">'Katekizmas'</span>, 2<span style="color: #fe8019;">)</span>
&gt;&gt;&gt; db.session.add_all<span style="color: #fe8019;">(</span><span style="color: #cc241d;">[</span>book1, book2, book3<span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
&gt;&gt;&gt; db.session.commit<span style="color: #fe8019;">()</span>
</pre>
</div>

<p>
Susikūrėme bandomuosius duomenis. Patikrinkime, ar pavyko:
</p>

<div class="org-src-container">
<pre class="src src-python">&gt;&gt;&gt; <span style="color: #83a598;">books</span> = Book.query.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>
&gt;&gt;&gt; books
<span style="color: #fe8019;">[</span>Kliud&#382;iau, Marti, Katekizmas<span style="color: #fe8019;">]</span>
&gt;&gt;&gt; <span style="color: #83a598;">pubs</span> = Publisher.query.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>
&gt;&gt;&gt; pubs
<span style="color: #fe8019;">[</span>Baltos Lankos, Alma Littera<span style="color: #fe8019;">]</span>
&gt;&gt;&gt; <span style="color: #fb4934;">for</span> i <span style="color: #fb4934;">in</span> books:
...     <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>i, i.publisher<span style="color: #fe8019;">)</span>
...
Kliud&#382;iau Baltos Lankos
Marti Baltos Lankos
Katekizmas Alma Littera
&gt;&gt;&gt; <span style="color: #fb4934;">for</span> i <span style="color: #fb4934;">in</span> pubs:
...     <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>i, i.books<span style="color: #fe8019;">)</span>
...
Baltos Lankos <span style="color: #fe8019;">[</span>Kliud&#382;iau, Marti<span style="color: #fe8019;">]</span>
Alma Littera <span style="color: #fe8019;">[</span>Katekizmas<span style="color: #fe8019;">]</span>
&gt;&gt;&gt;
</pre>
</div>

<p>
Matome, kad įrašai kuriasi, ryšiai veikia. Atkreipkite dėmesį, kai
iteravome knygas, nurodėme spausdinti i.publisher, nors tokio
stulpelio ir nėra. Tai reikšmė iš back reference parametro, galima ją
taip naudoti.
</p>
</div>
</div>
<div id="outline-container-org9afe2d2" class="outline-3">
<h3 id="org9afe2d2"><span class="section-number-3">5.2.</span> Many2Many</h3>
<div class="outline-text-3" id="text-5-2">
<p>
Pasitaiko, kad knygos turi ne po vieną autorių. Gaunasi situacija,
daug knygų - daug autorių. Pabandykime sumodeliuoti:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">helper_table</span> = db.Table<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'helper'</span>,
                        db.Column<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'book_id'</span>, db.Integer, db.ForeignKey<span style="color: #b8bb26;">(</span><span style="color: #b8bb26;">'books.id'</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">)</span>,
                        db.Column<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'author_id'</span>, db.Integer, db.ForeignKey<span style="color: #b8bb26;">(</span><span style="color: #b8bb26;">'authors.id'</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Book</span><span style="color: #fe8019;">(</span>db.Model<span style="color: #fe8019;">)</span>:

    <span style="color: #83a598;">__tablename__</span> = <span style="color: #b8bb26;">'books'</span>
    <span style="color: #fe8019;">id</span> = db.Column<span style="color: #fe8019;">(</span>db.Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    title = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>300<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    publisher_id = db.Column<span style="color: #fe8019;">(</span>db.Integer, db.ForeignKey<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'publishers.id'</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    authors = db.relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Author'</span>, secondary=helper_table, backref=<span style="color: #b8bb26;">'books'</span><span style="color: #fe8019;">)</span>

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__init__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, title, publisher_id<span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">self</span>.title = title
        <span style="color: #fb4934;">self</span>.publisher_id = publisher_id

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> <span style="color: #fb4934;">self</span>.title


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Publisher</span><span style="color: #fe8019;">(</span>db.Model<span style="color: #fe8019;">)</span>:

    __tablename__ = <span style="color: #b8bb26;">'publishers'</span>
    <span style="color: #fe8019;">id</span> = db.Column<span style="color: #fe8019;">(</span>db.Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    name = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>100<span style="color: #cc241d;">)</span>, unique=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    books = db.relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Book'</span>, backref=<span style="color: #b8bb26;">'publisher'</span><span style="color: #fe8019;">)</span>

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__init__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, name<span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">self</span>.name = name

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> <span style="color: #fb4934;">self</span>.name


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Author</span><span style="color: #fe8019;">(</span>db.Model<span style="color: #fe8019;">)</span>:

    __tablename__ = <span style="color: #b8bb26;">'authors'</span>
    <span style="color: #fe8019;">id</span> = db.Column<span style="color: #fe8019;">(</span>db.Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    fname = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>150<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    lname = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>300<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__init__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, fname, lname<span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">self</span>.fname = fname
        <span style="color: #fb4934;">self</span>.lname = lname

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">'</span>{<span style="color: #fb4934;">self</span>.fname}<span style="color: #b8bb26;"> </span>{<span style="color: #fb4934;">self</span>.lname}<span style="color: #b8bb26;">'</span>
</pre>
</div>

<p>
Pirmiausiai sukūrėme helper_table. Tai ne modelis, o tiesiog pagalbinė
lentelė duomenų bazėje, apjungianti modelius Book ir Author.
</p>

<p>
Modelyje Books vietoje seno author, sukūrėme naują authors stulpelį.
Nurodėme, kad kreipsimės į Author modelį, per pagalbinę lentelę.
Nurodėme backref='books'. Per šio parametro reikšmę vėliau galėsime
kreiptis iš autoriaus į knygos modelį.
</p>

<p>
Sukūrėme modelį Author. Jame jokiais ryšiais rūpintis nereikia, tai
padaryta ankstesniuose punktuose.
</p>

<p>
Viską inicijavus, ir DB atidarius per duombazių administravimo
programą (dbeaver), matome tokią schemą:
</p>


<div id="orga268691" class="figure">
<p><img src="./static/images/flask4_1.png" alt="flask4_1.png" width="800px" />
</p>
</div>

<p>
Patikrinimui suvedėme šiek tiek duomenų bandymams:
</p>

<div class="org-src-container">
<pre class="src src-python">&gt;&gt;&gt; books
<span style="color: #fe8019;">[</span>M&#363;s&#371; bendra knyga, Knyga apie gyvenim&#261;, Kaip mes kartu tarnavome<span style="color: #fe8019;">]</span>
&gt;&gt;&gt; pubs
<span style="color: #fe8019;">[</span>Baltos Lankos, Alma Littera<span style="color: #fe8019;">]</span>
&gt;&gt;&gt; authors
<span style="color: #fe8019;">[</span>Valdas Adamkus, Algimantas &#268;ekuolis, Andrius Mamontovas, Antanas Baranauskas<span style="color: #fe8019;">]</span>
</pre>
</div>

<p>
Pažiūrėkime, kaip veikia many2many mechanizmas flask aplinkoje:
</p>

<div class="org-src-container">
<pre class="src src-python">&gt;&gt;&gt; <span style="color: #83a598;">bendra_knyga</span> = Book.query.filter_by<span style="color: #fe8019;">(</span>title=<span style="color: #b8bb26;">'M&#363;s&#371; bendra knyga'</span><span style="color: #fe8019;">)</span>.first<span style="color: #fe8019;">()</span>
&gt;&gt;&gt; bendra_knyga
M&#363;s&#371; bendra knyga
&gt;&gt;&gt; v_adamkus = Author.query.filter_by<span style="color: #fe8019;">(</span>fname=<span style="color: #b8bb26;">'Valdas'</span><span style="color: #fe8019;">)</span>.first<span style="color: #fe8019;">()</span>
&gt;&gt;&gt; v_adamkus
Valdas Adamkus
&gt;&gt;&gt; a_chuck = Author.query.filter_by<span style="color: #fe8019;">(</span>fname = <span style="color: #b8bb26;">'Algimantas'</span><span style="color: #fe8019;">)</span>.first<span style="color: #fe8019;">()</span>
&gt;&gt;&gt; a_chuck
Algimantas &#268;ekuolis
&gt;&gt;&gt; bendra_knyga.authors.append<span style="color: #fe8019;">(</span>v_adamkus<span style="color: #fe8019;">)</span>
&gt;&gt;&gt; bendra_knyga.authors.append<span style="color: #fe8019;">(</span>a_chuck<span style="color: #fe8019;">)</span>
&gt;&gt;&gt; bendra_knyga.authors
<span style="color: #fe8019;">[</span>Valdas Adamkus, Algimantas &#268;ekuolis<span style="color: #fe8019;">]</span>
</pre>
</div>

<p>
Vienai knygai priskyrėme porą autorių. Pabandykime atvirkštinį
veiksmą:
</p>

<div class="org-src-container">
<pre class="src src-python">&gt;&gt;&gt; <span style="color: #83a598;">knyga_ag</span> = Book.query.filter_by<span style="color: #fe8019;">(</span>title=<span style="color: #b8bb26;">'Knyga apie gyvenim&#261;'</span><span style="color: #fe8019;">)</span>.first<span style="color: #fe8019;">()</span>
&gt;&gt;&gt; knyga_ag
Knyga apie gyvenim&#261;
&gt;&gt;&gt; knyga_tarnavome = Book.query.filter_by<span style="color: #fe8019;">(</span>title=<span style="color: #b8bb26;">'Kaip mes kartu tarnavome'</span><span style="color: #fe8019;">)</span>.first<span style="color: #fe8019;">()</span>
&gt;&gt;&gt; knyga_tarnavome
Kaip mes kartu tarnavome
&gt;&gt;&gt; a_chuck.books.append<span style="color: #fe8019;">(</span>knyga_tarnavome<span style="color: #fe8019;">)</span>
&gt;&gt;&gt; a_chuck.books.append<span style="color: #fe8019;">(</span>knyga_ag<span style="color: #fe8019;">)</span>
&gt;&gt;&gt; a_chuck.books
<span style="color: #fe8019;">[</span>M&#363;s&#371; bendra knyga, Knyga apie gyvenim&#261;, Kaip mes kartu tarnavome<span style="color: #fe8019;">]</span>
</pre>
</div>

<p>
Pavyko. Čekuolis parašė tris knygas, vieną iš kurių su bendraautoriumi
:) Dar kartą akcentuosiu, kad iš Author į Book modelį kreipiamasi per
backref, šiuo atveju 'books'.
</p>


<div id="org448ad2e" class="figure">
<p><img src="./static/images/flask4_2.png" alt="flask4_2.png" width="800px" />
</p>
</div>

<p>
Taip atrodo helper lentelė - tiesiog knygų ID sąsajos su autorių ID.
</p>
</div>
</div>
<div id="outline-container-org5c4c7fe" class="outline-3">
<h3 id="org5c4c7fe"><span class="section-number-3">5.3.</span> Many2One ryšio įgyvendinimas su Flask</h3>
<div class="outline-text-3" id="text-5-3">
<p>
<code>Sqlalchemy dalis</code>:
</p>

<p>
Vienas tėvas gali turėti vieną vaiką. Vaikas gali turėti kelis tėvus.
Šiam ryšiui tėvo klasėje sukuriamas vaiko id (foreign key) ir vaiko
objektas (relationship laukas). Iš vaiko pusės ryšio laukai nebūtini.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Tevas</span><span style="color: #fe8019;">(</span>db.Model<span style="color: #fe8019;">)</span>:
    <span style="color: #83a598;">__tablename__</span> = <span style="color: #b8bb26;">"tevas"</span>
    <span style="color: #fe8019;">id</span> = db.Column<span style="color: #fe8019;">(</span>db.Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    vardas = db.Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Vardas"</span>, db.String<span style="color: #fe8019;">)</span>
    pavarde = db.Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Pavard&#279;"</span>, db.String<span style="color: #fe8019;">)</span>
    vaikas_id = db.Column<span style="color: #fe8019;">(</span>db.Integer, db.ForeignKey<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">"vaikas.id"</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    vaikas = db.relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Vaikas"</span><span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Vaikas</span><span style="color: #fe8019;">(</span>db.Model<span style="color: #fe8019;">)</span>:
    __tablename__ = <span style="color: #b8bb26;">"vaikas"</span>
    <span style="color: #fe8019;">id</span> = db.Column<span style="color: #fe8019;">(</span>db.Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    vardas = db.Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Vardas"</span>, db.String<span style="color: #fe8019;">)</span>
    pavarde = db.Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Pavard&#279;"</span>, db.String<span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
<code>Formos python failas</code>:
</p>

<p>
Tam, kad tėvo formoje galėtume turėti pasirenkamą vaiko lauką, turime
panaudoti QuerySelectField lauką. Atkreipkite dėmesį, kad jį reikia
importuoti iš wtforms_sqlalchemy.fields, o ne wtforms. Štai ką reiškia
šio lauko argumentai:
</p>

<p>
query_factory nurodome funkciją su gražinama vaikų užklausa
(Vaikas.query, priekyje pridėtas app, nes importuotas visas app
failas, kad pasiektume vaiko ir tėvo objektus).
</p>

<p>
allow_blank nustatome reikšmę True. Tai reiškia, kad tėvui leidžiama
ir nepasirinkti jokio vaiko.
</p>

<p>
get_label nurodoma, kokį vaiko lauką norime matyti, pasirinkdami vaiką
tėvo formoje.
</p>

<p>
get_pk nurodome, kad laukas pasiimtų vaiko id, kaip stringą. Tam
parašome lambda funkciją (lambda obj: str(obj)). Čia galima naudoti ir
paprastą funkciją.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask_wtf <span style="color: #fb4934;">import</span> FlaskForm
<span style="color: #fb4934;">from</span> wtforms <span style="color: #fb4934;">import</span> StringField, SubmitField
<span style="color: #fb4934;">from</span> wtforms.validators <span style="color: #fb4934;">import</span> DataRequired
<span style="color: #fb4934;">from</span> wtforms_sqlalchemy.fields <span style="color: #fb4934;">import</span> QuerySelectField
<span style="color: #fb4934;">import</span> app

<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">vaikas_query</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> app.Vaikas.query

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">TevasForm</span><span style="color: #fe8019;">(</span>FlaskForm<span style="color: #fe8019;">)</span>:
    <span style="color: #83a598;">vardas</span> = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Numeris'</span>, <span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">()</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    <span style="color: #83a598;">pavarde</span> = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Pavard&#279;'</span>, <span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">()</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    <span style="color: #83a598;">vaikas</span> = QuerySelectField<span style="color: #fe8019;">(</span>query_factory=vaikas_query, allow_blank=<span style="color: #d3869b;">True</span>, get_label=<span style="color: #b8bb26;">"vardas"</span>, get_pk=<span style="color: #fb4934;">lambda</span> obj: <span style="color: #fe8019;">str</span><span style="color: #cc241d;">(</span>obj<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    submit = SubmitField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'&#302;vesti'</span><span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">VaikasForm</span><span style="color: #fe8019;">(</span>FlaskForm<span style="color: #fe8019;">)</span>:
    vardas = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Numeris'</span>, <span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">()</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    pavarde = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Pavard&#279;'</span>, <span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">()</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    submit = SubmitField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'&#302;vesti'</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
<code>Formos html failas:</code>
</p>

<p>
Formos html failas praktiškai nesiskiria nuo įprasto neryšinio objekto
įvedimo formos. Vaiko laukas įvedamas, kaip bet kuris kitas laukas. Jo
logika pasiimama iš formos python failo ir vietoje įprasto įvedimo
lauko, jis tampa pasirinkimų lauku.
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

&lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"#"</span>&gt;
    {{ form.hidden_tag() }}
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
        {{ form.vardas.label(class="form-control-label") }}
        {{ form.vardas(class="form-control") }}
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
        {{ form.pavarde.label(class="form-control-label") }}
        {{ form.pavarde(class="form-control") }}
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
        {{ form.vaikas.label(class="form-control-label") }}
        {{ form.vaikas(class="form-control") }}
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
    {{ form.submit }}
&lt;/<span style="color: #b8bb26;">form</span>&gt;
{% endblock %}
</pre>
</div>

<p>
<code>Tėvų atvaizdavimo html kodas:</code>
</p>

<p>
Kadangi tėvas gali turėti vaiką (laukas vaikas), kas tiesiog yra
objektas, kiekvieną kartą tikriname, ar šis laukas užpildytas. Jei jis
ne tuščias, atvaizduojame tėvui priskirto vaiko vardą
(tevas.vaikas.vardas) ir pavardę (tevas.vaikas.pavarde).
</p>

<p>
Žemiau yra nuorodos į flask metodus, skirtus tėvo įrašo ištrynimui ir
redagavimui, taip pat – naujo tėvo įvedimui.
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

{% if visi_tevai %}
{% for tevas in visi_tevai %}
&lt;<span style="color: #b8bb26;">hr</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{tevas.vardas}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{tevas.pavarde}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
{% if tevas.vaikas %}
&lt;<span style="color: #b8bb26;">p</span>&gt;Vaikas:&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{tevas.vaikas.vardas}} {{tevas.vaikas.pavarde}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
{% endif %}
&lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"{{ url_for('delete', id=tevas['id']) }}"</span>&gt;I&#353;trinti&lt;/<span style="color: #b8bb26;">a</span>&gt;
&lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"{{ url_for('update', id=tevas['id']) }}"</span>&gt;Redaguoti&lt;/<span style="color: #b8bb26;">a</span>&gt;
{% endfor %}
{% endif %}
&lt;<span style="color: #b8bb26;">hr</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"{{ url_for('new_parent')}}"</span>&gt;Naujas t&#279;vas&lt;/<span style="color: #b8bb26;">a</span>&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;

{% endblock %}
</pre>
</div>

<p>
<code>Flask funkcijos:</code>
</p>

<p>
<code>Tėvų atvaizdavimo:</code>
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/tevai"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">parents</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">try</span>:
        visi_tevai = Tevas.query.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">except</span>:
        visi_tevai = <span style="color: #fe8019;">[]</span>
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"tevai.html"</span>, visi_tevai=visi_tevai<span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
<code>Tėvų pridėjimo:</code>
</p>

<p>
Dekoratoriuje aprašome, kad funkcija naudos ir GET ir POST metodus
(duomenų priėjimui iš formos).
</p>

<p>
Funkcijos pradžioje inicijuojame duomenų bazę (db.create_all()). Tai
reikalinga norint sukurti duomenų bazę, kai jos nėra.
</p>

<p>
Inicijuojamas tėvo formos objektas (forma = forms.TevasForm(),
pradžioje rašoma forms, nes failo pradžioje yra importuota forms
klasė).
</p>

<p>
Patvirtinus formą (if forma.validate_on_submit()), inicijuojamas tėvo
objektas su duomenimis iš formos. Atkreipkite dėmesį, kad vaiko
objektas priskiriamas ne tiesiogiai, o per vaikas_id lauką).
</p>

<p>
Tėvo objektas pridedamas į sesiją (db.session.add(naujas_tevas)) ir
sesija išsaugoma (db.session.commit()).
</p>

<p>
Galiausiai nukreipiama į parents funkciją (return
redirect(url_for('parents'))), kuri atidaro tėvų puslapį.
</p>

<p>
Pagrindinis (apatinis) return nukreipia į tėvo pridėjimo puslapį,
pasiimdamas formos duomenis (render_template("prideti_teva.html",
form=forma)).
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/naujas_tevas"</span>, methods=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">"GET"</span>, <span style="color: #b8bb26;">"POST"</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">new_parent</span><span style="color: #fe8019;">()</span>:
    db.create_all<span style="color: #fe8019;">()</span>
    forma = forms.TevasForm<span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">if</span> forma.validate_on_submit<span style="color: #fe8019;">()</span>:
        naujas_tevas = Tevas<span style="color: #fe8019;">(</span>vardas=forma.vardas.data, pavarde=forma.pavarde.data, vaikas_id=forma.vaikas.data.<span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>
        db.session.add<span style="color: #fe8019;">(</span>naujas_tevas<span style="color: #fe8019;">)</span>
        db.session.commit<span style="color: #fe8019;">()</span>
        <span style="color: #fb4934;">return</span> redirect<span style="color: #fe8019;">(</span>url_for<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'parents'</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"prideti_teva.html"</span>, form=forma<span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
Pilnas kodas:
</p>

<p>
<a href="https://github.com/DonatasNoreika/flask-tevas-vaikas">flask-tevas-vaikas</a>
</p>
</div>
</div>

<div id="outline-container-org788562b" class="outline-3">
<h3 id="org788562b"><span class="section-number-3">5.4.</span> One2Many ryšio įgyvendinimas su Flask</h3>
<div class="outline-text-3" id="text-5-4">
<p>
<code>Sqlalchemy dalis:</code>
</p>

<p>
Vienas tėvas gali turėti daug vaikų. Vaikas gali turėti vieną tėvą
(atvirkščiai, nei Many2one). Šiam ryšiui tėvo klasėje sukuriamas vaikų
vaiko objektas (relationship laukas). Iš vaiko pusės sukuriamas tėvo
id (foreign key) ir tėvo objektas (relationship laukas).
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Tevas</span><span style="color: #fe8019;">(</span>db.Model<span style="color: #fe8019;">)</span>:
    <span style="color: #83a598;">__tablename__</span> = <span style="color: #b8bb26;">"tevas"</span>
    <span style="color: #fe8019;">id</span> = db.Column<span style="color: #fe8019;">(</span>db.Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    vardas = db.Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Vardas"</span>, db.String<span style="color: #fe8019;">)</span>
    pavarde = db.Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Pavard&#279;"</span>, db.String<span style="color: #fe8019;">)</span>
    vaikai = db.relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Vaikas"</span><span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Vaikas</span><span style="color: #fe8019;">(</span>db.Model<span style="color: #fe8019;">)</span>:
    __tablename__ = <span style="color: #b8bb26;">"vaikas"</span>
    <span style="color: #fe8019;">id</span> = db.Column<span style="color: #fe8019;">(</span>db.Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    vardas = db.Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Vardas"</span>, db.String<span style="color: #fe8019;">)</span>
    pavarde = db.Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Pavard&#279;"</span>, db.String<span style="color: #fe8019;">)</span>
    tevas_id = db.Column<span style="color: #fe8019;">(</span>db.Integer, db.ForeignKey<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">"tevas.id"</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    tevas = db.relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Tevas"</span><span style="color: #fe8019;">)</span>p
</pre>
</div>

<p>
<code>Formos python failas:</code>
</p>

<p>
Tam, kad tėvo formoje galėtume turėti pasirenkamą vaikų lauką, turime
panaudoti QuerySelectMultipleField lauką (panašus, kaip Many2one
atveju naudojamas QuerySelectField). Atkreipkite dėmesį, kad jį reikia
importuoti iš wtforms_sqlalchemy.fields, o ne wtforms. Štai ką reiškia
šio lauko argumentai:
</p>

<p>
query_factory nurodome visų vaikų užklausą (app.Vaikas.query.all,
priekyje pridėtas app, nes importuotas visas app failas, kad
pasiektume vaiko ir tėvo objektus).
</p>

<p>
get_label nurodoma, kokį vaiko lauką norime matyti, pasirinkdami vaiką
tėvo formoje.
</p>

<p>
get_pk nurodome, kad laukas pasiimtų vaiko id, kaip stringą. Tam
parašome lambda funkciją (lambda obj: str(obj)). Čia galima naudoti ir
paprastą funkciją.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask_wtf <span style="color: #fb4934;">import</span> FlaskForm
<span style="color: #fb4934;">from</span> wtforms <span style="color: #fb4934;">import</span> StringField, IntegerField, SubmitField, SelectField
<span style="color: #fb4934;">from</span> wtforms.validators <span style="color: #fb4934;">import</span> DataRequired, Email, InputRequired
<span style="color: #fb4934;">from</span> wtforms_sqlalchemy.fields <span style="color: #fb4934;">import</span> QuerySelectField, QuerySelectMultipleField
<span style="color: #fb4934;">import</span> app

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">TevasForm</span><span style="color: #fe8019;">(</span>FlaskForm<span style="color: #fe8019;">)</span>:
    <span style="color: #83a598;">vardas</span> = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Numeris'</span>, <span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">()</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    <span style="color: #83a598;">pavarde</span> = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Pavard&#279;'</span>, <span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">()</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    <span style="color: #83a598;">vaikai</span> = QuerySelectMultipleField<span style="color: #fe8019;">(</span>query_factory=app.Vaikas.query.<span style="color: #fe8019;">all</span>, get_label=<span style="color: #b8bb26;">"vardas"</span>, get_pk=<span style="color: #fb4934;">lambda</span> obj: <span style="color: #fe8019;">str</span><span style="color: #cc241d;">(</span>obj<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    submit = SubmitField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'&#302;vesti'</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">VaikasForm</span><span style="color: #fe8019;">(</span>FlaskForm<span style="color: #fe8019;">)</span>:
    vardas = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Numeris'</span>, <span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">()</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    pavarde = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Pavard&#279;'</span>, <span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">()</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    submit = SubmitField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'&#302;vesti'</span><span style="color: #fe8019;">)</span>
</pre>
</div>


<p>
<code>Formos html failas:</code>
</p>

<p>
Formos html failas praktiškai nesiskiria nuo įprasto neryšinio objekto
įvedimo formos. Vaikų laukas įvedamas, kaip bet kuris kitas laukas. Jo
logika pasiimama iš formos python failo ir vietoje įprasto įvedimo
lauko, jis tampa kelių pasirinkimų lauku (kelis variantus formoje
galima pasirinkti laikant nuspaustą klaviatūros mygtuką CTRL).
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

&lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"#"</span>&gt;
    {{ form.hidden_tag() }}
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
        {{ form.vardas.label(class="form-control-label") }}
        {{ form.vardas(class="form-control") }}
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
        {{ form.pavarde.label(class="form-control-label") }}
        {{ form.pavarde(class="form-control") }}
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
        {{ form.vaikai.label(class="form-control-label") }}
        {{ form.vaikai(class="form-control") }}
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
    {{ form.submit }}
&lt;/<span style="color: #b8bb26;">form</span>&gt;
{% endblock %}
</pre>
</div>

<p>
Tėvų atvaizdavimo html kodas:
</p>

<p>
Kadangi tėvas gali daug vaikų (laukas vaikas), kas tiesiog yra
objektai, kiekvieną kartą tikriname, ar šis laukas užpildytas. Jei jis
ne tuščias, praiteruojame (prasukame for ciklą) per visus tėvo vaikus
(per tėvo lauką vaikai tevas.vaikai) ir atvaizduojame kiekvieno vaiko
vardą (vaikas.vardas) ir pavardę (vaikas.pavarde).
</p>

<p>
Žemiau yra nuorodos į flask metodus, skirtus tėvo įrašo ištrynimui ir
redagavimui, taip pat – naujo tėvo įvedimui.
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

{% if visi_tevai %}
{% for tevas in visi_tevai %}
&lt;<span style="color: #b8bb26;">hr</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{tevas.vardas}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{tevas.pavarde}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
{% if tevas.vaikai %}
&lt;<span style="color: #b8bb26;">p</span>&gt;Vaikai:&lt;/<span style="color: #b8bb26;">p</span>&gt;
{% for vaikas in tevas.vaikai %}
&lt;<span style="color: #b8bb26;">p</span>&gt;{{vaikas.vardas}} {{vaikas.pavarde}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
{% endfor %}
{% endif %}

{% endfor %}
{% endif %}
&lt;<span style="color: #b8bb26;">hr</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"{{ url_for('new_parent')}}"</span>&gt;Naujas t&#279;vas&lt;/<span style="color: #b8bb26;">a</span>&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;

{% endblock %}
</pre>
</div>

<p>
<code>Flask funkcijos:</code>
</p>

<p>
Pradžioje truputį pakeičiama DB nuorodos nurodymo kodą. Tai reikalinga
tam, kad nemestų thread klaidų:
</p>

<div class="org-src-container">
<pre class="src src-python">app.<span style="color: #83a598;">config</span><span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'SQLALCHEMY_DATABASE_URI'</span><span style="color: #fe8019;">]</span> = <span style="color: #b8bb26;">'sqlite:///'</span> + os.path.join<span style="color: #fe8019;">(</span>basedir, <span style="color: #b8bb26;">'data.sqlite?check_same_thread=False'</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
<code>Tėvų atvaizdavimo:</code>
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/tevai"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">parents</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">try</span>:
        visi_tevai = Tevas.query.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">except</span>:
        visi_tevai = <span style="color: #fe8019;">[]</span>
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"tevai.html"</span>, visi_tevai=visi_tevai<span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
<code>Tėvų pridėjimo:</code>
</p>

<p>
Dekoratoriuje aprašome, kad funkcija naudos ir GET ir POST metodus
(duomenų priėjimui iš formos).
</p>

<p>
Funkcijos pradžioje inicijuojame duomenų bazę (db.create_all()). Tai
reikalinga norint sukurti duomenų bazę, kai jos nėra.
</p>

<p>
Inicijuojamas tėvo formos objektas (forma = forms.TevasForm(),
pradžioje rašoma forms, nes failo pradžioje yra importuota forms
klasė).
</p>

<p>
Patvirtinus formą (if forma.validate_on_submit()), inicijuojamas tėvo
objektas su duomenimis iš formos. Kol kas vaikai nepriskiriami
</p>

<p>
Iteruojama per tėvo vaikus iš formos (forma.vaikai.data), padaromos
kiekvieno vaiko užklausos iš duomenų bazės ir jie pridedami prie tėvo
vaikų objektų sąrašo (per metodą append). Taip išvengiama sesijų
susidubliavimo klaida.
</p>

<p>
Tėvo objektas pridedamas į sesiją (db.session.add(naujas_tevas)) ir
sesija išsaugoma (db.session.commit()).
</p>

<p>
Galiausiai nukreipiama į parents funkciją (return
redirect(url_for('parents'))), kuri atidaro tėvų puslapį.
</p>

<p>
Pagrindinis (apatinis) return nukreipia į tėvo pridėjimo puslapį,
pasiimdamas formos duomenis (render_template("prideti_teva.html",
form=forma)).
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/naujas_tevas"</span>, methods=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">"GET"</span>, <span style="color: #b8bb26;">"POST"</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">new_parent</span><span style="color: #fe8019;">()</span>:
    db.create_all<span style="color: #fe8019;">()</span>
    forma = forms.TevasForm<span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">if</span> forma.validate_on_submit<span style="color: #fe8019;">()</span>:
        naujas_tevas = Tevas<span style="color: #fe8019;">(</span>vardas=forma.vardas.data, pavarde=forma.pavarde.data<span style="color: #fe8019;">)</span>
        <span style="color: #fb4934;">for</span> vaikas <span style="color: #fb4934;">in</span> forma.vaikai.data:
            priskirtas_vaikas = Vaikas.query.get<span style="color: #fe8019;">(</span>vaikas.<span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>
            naujas_tevas.vaikai.append<span style="color: #fe8019;">(</span>priskirtas_vaikas<span style="color: #fe8019;">)</span>
        db.session.add<span style="color: #fe8019;">(</span>naujas_tevas<span style="color: #fe8019;">)</span>
        db.session.commit<span style="color: #fe8019;">()</span>
        <span style="color: #fb4934;">return</span> redirect<span style="color: #fe8019;">(</span>url_for<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'parents'</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"prideti_teva.html"</span>, form=forma<span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
Pilnas kodas:
</p>

<p>
<a href="https://github.com/DonatasNoreika/tevas-vaikai-flask">tevas-vaikai-flask</a>
</p>
</div>
</div>

<div id="outline-container-org55c833f" class="outline-3">
<h3 id="org55c833f"><span class="section-number-3">5.5.</span> Many2Many ryšio įgyvendinimas su Flask</h3>
<div class="outline-text-3" id="text-5-5">
<p>
<code>Sqlalchemy dalis:</code>
</p>

<p>
Vienas tėvas gali turėti daug vaikų. Vaikas gali turėti daug tėvų.
Šiam ryšiui tėvo ir vaiko klasėse atitinkamai sukuriami vaiko ir tėvo
objektai (relationship laukai). Taip pat būtina tarpinė ryšių lentelė
association_table, kurioje sukuriami tėvo ir vaiko id stulpeliai
(foreign key).
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">association_table</span> = db.Table<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'association'</span>, db.metadata,
    db.Column<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'tevas_id'</span>, db.Integer, db.ForeignKey<span style="color: #b8bb26;">(</span><span style="color: #b8bb26;">'tevas.id'</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">)</span>,
    db.Column<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'vaikas_id'</span>, db.Integer, db.ForeignKey<span style="color: #b8bb26;">(</span><span style="color: #b8bb26;">'vaikas.id'</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">)</span>
<span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Tevas</span><span style="color: #fe8019;">(</span>db.Model<span style="color: #fe8019;">)</span>:
    <span style="color: #83a598;">__tablename__</span> = <span style="color: #b8bb26;">'tevas'</span>
    <span style="color: #fe8019;">id</span> = db.Column<span style="color: #fe8019;">(</span>db.Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    vardas = db.Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Vardas"</span>, db.String<span style="color: #fe8019;">)</span>
    pavarde = db.Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Pavard&#279;"</span>, db.String<span style="color: #fe8019;">)</span>
    vaikai = db.relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Vaikas"</span>, secondary=association_table,
                          back_populates=<span style="color: #b8bb26;">"tevai"</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Vaikas</span><span style="color: #fe8019;">(</span>db.Model<span style="color: #fe8019;">)</span>:
    __tablename__ = <span style="color: #b8bb26;">'vaikas'</span>
    <span style="color: #fe8019;">id</span> = db.Column<span style="color: #fe8019;">(</span>db.Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    vardas = db.Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Vardas"</span>, db.String<span style="color: #fe8019;">)</span>
    pavarde = db.Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Pavard&#279;"</span>, db.String<span style="color: #fe8019;">)</span>
    tevai = db.relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Tevas"</span>, secondary=association_table,
                         back_populates=<span style="color: #b8bb26;">"vaikai"</span><span style="color: #fe8019;">)</span>
</pre>
</div>


<p>
<code>Formos python failas:</code>
</p>

<p>
Viskas praktiškai taip pat, kaip ir One2many atveju. Tam, kad tėvo
formoje galėtume turėti pasirenkamą vaikų lauką, turime panaudoti
QuerySelectMultipleField lauką. Atkreipkite dėmesį, kad jį reikia
importuoti iš wtforms_sqlalchemy.fields, o ne wtforms. Štai ką reiškia
šio lauko argumentai:
</p>

<p>
query_factory nurodome visų vaikų užklausą (app.Vaikas.query.all,
priekyje pridėtas app, nes importuotas visas app failas, kad
pasiektume vaiko ir tėvo objektus).
</p>

<p>
get_label nurodoma, kokį vaiko lauką norime matyti, pasirinkdami vaiką
tėvo formoje.
</p>

<p>
get_pk nurodome, kad laukas pasiimtų vaiko id, kaip stringą. Tam
parašome lambda funkciją (lambda obj: str(obj)). Čia galima naudoti ir
paprastą funkciją.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask_wtf <span style="color: #fb4934;">import</span> FlaskForm
<span style="color: #fb4934;">from</span> wtforms <span style="color: #fb4934;">import</span> StringField, IntegerField, SubmitField, SelectField
<span style="color: #fb4934;">from</span> wtforms.validators <span style="color: #fb4934;">import</span> DataRequired, Email, InputRequired
<span style="color: #fb4934;">from</span> wtforms_sqlalchemy.fields <span style="color: #fb4934;">import</span> QuerySelectField, QuerySelectMultipleField
<span style="color: #fb4934;">import</span> app

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">TevasForm</span><span style="color: #fe8019;">(</span>FlaskForm<span style="color: #fe8019;">)</span>:
    <span style="color: #83a598;">vardas</span> = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Numeris'</span>, <span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">()</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    <span style="color: #83a598;">pavarde</span> = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Pavard&#279;'</span>, <span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">()</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    <span style="color: #83a598;">vaikai</span> = QuerySelectMultipleField<span style="color: #fe8019;">(</span>query_factory=app.Vaikas.query.<span style="color: #fe8019;">all</span>, get_label=<span style="color: #b8bb26;">"vardas"</span>, get_pk=<span style="color: #fb4934;">lambda</span> obj: <span style="color: #fe8019;">str</span><span style="color: #cc241d;">(</span>obj<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    submit = SubmitField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'&#302;vesti'</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">VaikasForm</span><span style="color: #fe8019;">(</span>FlaskForm<span style="color: #fe8019;">)</span>:
    vardas = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Numeris'</span>, <span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">()</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    pavarde = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Pavard&#279;'</span>, <span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">()</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    submit = SubmitField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'&#302;vesti'</span><span style="color: #fe8019;">)</span>
</pre>
</div>


<p>
<code>Formos html failas:</code>
</p>

<p>
Viskas praktiškai taip pat, kaip ir One2many atveju. Formos html
failas praktiškai nesiskiria nuo įprasto neryšinio objekto įvedimo
formos. Vaikų laukas įvedamas, kaip bet kuris kitas laukas. Jo logika
pasiimama iš formos python failo ir vietoje įprasto įvedimo lauko, jis
tampa kelių pasirinkimų lauku (kelis variantus formoje galima
pasirinkti laikant nuspaustą klaviatūros mygtuką CTRL).
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

&lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"#"</span>&gt;
    {{ form.hidden_tag() }}
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
        {{ form.vardas.label(class="form-control-label") }}
        {{ form.vardas(class="form-control") }}
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
        {{ form.pavarde.label(class="form-control-label") }}
        {{ form.pavarde(class="form-control") }}
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
        {{ form.vaikai.label(class="form-control-label") }}
        {{ form.vaikai(class="form-control") }}
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
    {{ form.submit }}
&lt;/<span style="color: #b8bb26;">form</span>&gt;
{% endblock %}
</pre>
</div>

<p>
<code>Tėvų atvaizdavimo html kodas:</code>
</p>

<p>
Viskas praktiškai taip pat, kaip ir One2many atveju. Kadangi tėvas
gali daug vaikų (laukas vaikas), kas tiesiog yra objektai, kiekvieną
kartą tikriname, ar šis laukas užpildytas. Jei jis ne tuščias,
praiteruojame (prasukame for ciklą) per visus tėvo vaikus (per tėvo
lauką vaikai tevas.vaikai) ir atvaizduojame kiekvieno vaiko vardą
(vaikas.vardas) ir pavardę (vaikas.pavarde).
</p>

<p>
Žemiau yra nuorodos į flask metodus, skirtus tėvo įrašo ištrynimui ir
redagavimui, taip pat – naujo tėvo įvedimui.
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

{% if visi_tevai %}
{% for tevas in visi_tevai %}
&lt;<span style="color: #b8bb26;">hr</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{tevas.vardas}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{tevas.pavarde}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
{% if tevas.vaikai %}
&lt;<span style="color: #b8bb26;">p</span>&gt;Vaikai:&lt;/<span style="color: #b8bb26;">p</span>&gt;
{% for vaikas in tevas.vaikai %}
&lt;<span style="color: #b8bb26;">p</span>&gt;{{vaikas.vardas}} {{vaikas.pavarde}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
{% endfor %}
{% endif %}

{% endfor %}
{% endif %}
&lt;<span style="color: #b8bb26;">hr</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"{{ url_for('new_parent')}}"</span>&gt;Naujas t&#279;vas&lt;/<span style="color: #b8bb26;">a</span>&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;

{% endblock %}
</pre>
</div>

<p>
Pradžioje truputį pakeičiama DB nuorodos nurodymo kodą. Tai reikalinga
tam, kad nemestų thread klaidų:
</p>

<div class="org-src-container">
<pre class="src src-python">app.<span style="color: #83a598;">config</span><span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'SQLALCHEMY_DATABASE_URI'</span><span style="color: #fe8019;">]</span> = <span style="color: #b8bb26;">'sqlite:///'</span> + os.path.join<span style="color: #fe8019;">(</span>basedir, <span style="color: #b8bb26;">'data.sqlite?check_same_thread=False'</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
<code>Tėvų atvaizdavimo:</code>
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/tevai"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">parents</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">try</span>:
        visi_tevai = Tevas.query.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">except</span>:
        visi_tevai = <span style="color: #fe8019;">[]</span>
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"tevai.html"</span>, visi_tevai=visi_tevai<span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
<code>Tėvų pridėjimo:</code>
</p>

<p>
Dekoratoriuje aprašome, kad funkcija naudos ir GET ir POST metodus
(duomenų priėjimui iš formos).
</p>

<p>
Funkcijos pradžioje inicijuojame duomenų bazę (db.create_all()). Tai
reikalinga norint sukurti duomenų bazę, kai jos nėra.
</p>

<p>
Inicijuojamas tėvo formos objektas (forma = forms.TevasForm(),
pradžioje rašoma forms, nes failo pradžioje yra importuota forms
klasė).
</p>

<p>
Patvirtinus formą (if forma.validate_on_submit()), inicijuojamas tėvo
objektas su duomenimis iš formos. Kol kas vaikai nepriskiriami
</p>

<p>
Iteruojama per tėvo vaikus iš formos (forma.vaikai.data), padaromos
kiekvieno vaiko užklausos iš duomenų bazės ir jie pridedami prie tėvo
vaikų objektų sąrašo (per metodą append). Taip išvengiama sesijų
susidubliavimo klaida.
</p>

<p>
Tėvo objektas pridedamas į sesiją (db.session.add(naujas_tevas)) ir
sesija išsaugoma (db.session.commit()).
</p>

<p>
Galiausiai nukreipiama į parents funkciją (return
redirect(url_for('parents'))), kuri atidaro tėvų puslapį.
</p>

<p>
Pagrindinis (apatinis) return nukreipia į tėvo pridėjimo puslapį,
pasiimdamas formos duomenis (render_template("prideti_teva.html",
form=forma)).
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/naujas_tevas"</span>, methods=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">"GET"</span>, <span style="color: #b8bb26;">"POST"</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">new_parent</span><span style="color: #fe8019;">()</span>:
    db.create_all<span style="color: #fe8019;">()</span>
    forma = forms.TevasForm<span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">if</span> forma.validate_on_submit<span style="color: #fe8019;">()</span>:
        naujas_tevas = Tevas<span style="color: #fe8019;">(</span>vardas=forma.vardas.data, pavarde=forma.pavarde.data<span style="color: #fe8019;">)</span>
        <span style="color: #fb4934;">for</span> vaikas <span style="color: #fb4934;">in</span> forma.vaikai.data:
            priskirtas_vaikas = Vaikas.query.get<span style="color: #fe8019;">(</span>vaikas.<span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>
            naujas_tevas.vaikai.append<span style="color: #fe8019;">(</span>priskirtas_vaikas<span style="color: #fe8019;">)</span>
        db.session.add<span style="color: #fe8019;">(</span>naujas_tevas<span style="color: #fe8019;">)</span>
        db.session.commit<span style="color: #fe8019;">()</span>
        <span style="color: #fb4934;">return</span> redirect<span style="color: #fe8019;">(</span>url_for<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'parents'</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"prideti_teva.html"</span>, form=forma<span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
<code>Pilnas kodas:</code>
</p>

<p>
<a href="https://github.com/DonatasNoreika/tevai-vaikai-flask">tevai-vaikai-flask</a>
</p>
</div>

<div id="outline-container-org8a0e68e" class="outline-4">
<h4 id="org8a0e68e"><span class="section-number-4">5.5.1.</span> Užduotis</h4>
<div class="outline-text-4" id="text-5-5-1">
<p>
Sukurti Flask programą, kuri leistų išsaugoti studentus, dėstytojus ir
paskaitas
</p>

<p>
Kiekvienam dėstytojui leistų priskirti jo paskaitas (one2many ryšys)
</p>

<p>
Kiekvienam studentui leistų priskirti daug paskaitų (many2many ryšys)
</p>


<div id="org466964c" class="figure">
<p><img src="./static/images/flask4_3.png" alt="flask4_3.png" width="800px" />
</p>
</div>

<p>
Atsakymas
</p>

<p>
<a href="https://github.com/DonatasNoreika/studentai_destytojai_paskaitos_flask">Paskaitų programa</a>
</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2023-01-30 Mon 19:48</p>
<p class="author">Author: arvydas</p>
<p class="date">Created: 2023-02-22 Wed 19:33</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
