<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-02-15 Wed 05:27 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CodeAcademy Flask</title>
<meta name="author" content="arvydas" />
<meta name="description" content="CodeAcademy Flask notes" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">CodeAcademy Flask</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org327db99">1. Įžanga į Flask</a>
<ul>
<li><a href="#orgcd9a3d3">1.1. Kaip sukurti minimalią svetainę:</a></li>
<li><a href="#org0a99cc3">1.2. Kaip puslapyje atvaizduoti įvestą kintamąjį:</a></li>
<li><a href="#orgd026e10">1.3. Kaip sukurti ir panaudoti HTML šabloną:</a></li>
<li><a href="#org41d12e6">1.4. Kaip kintamuosius perkelti į šabloną:</a></li>
<li><a href="#org994d667">1.5. Kaip perduoti duomenis iš svetainės į programą:</a></li>
<li><a href="#org09e2d16">1.6. Naudojame base.html šabloną:</a></li>
<li><a href="#orge79663e">1.7. Stiliui panaudojame "Bootstrap":</a></li>
<li><a href="#org4fedeaa">1.8. Užduotys</a></li>
</ul>
</li>
<li><a href="#org486139d">2. Flask 1 dalis</a>
<ul>
<li><a href="#orgffabccc">2.1. Susikurkime paprastą flask aplikaciją</a></li>
</ul>
</li>
<li><a href="#org2e0c903">3. Flask 2 dalis</a>
<ul>
<li><a href="#org52621a0">3.1. Dinaminiai maršrutai ir formos</a></li>
<li><a href="#orgc4c649a">3.2. Uzduotis</a></li>
</ul>
</li>
<li><a href="#orgc8ded4c">4. Flask 3 dalis</a>
<ul>
<li><a href="#org0f74cbb">4.1. Duomenų bazės sukūrimas</a></li>
<li><a href="#org0f7d951">4.2. Duomenų bazės migracija</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org327db99" class="outline-2">
<h2 id="org327db99"><span class="section-number-2">1.</span> Įžanga į Flask</h2>
<div class="outline-text-2" id="text-1">
<p>
Flask yra populiariausias Python microframework. Jeigu projektas nėra
labai didelis, arba tiesiog norime pasidaryti kažkokį GUI per
naršyklę, kažką greitai prototipuoti, Flask yra labai geras
pasirinkimas. Su flask yra pakankamai paprasta kurti API's. Ši
paskaita bus greita įžanga, kitose nagrinėsime išsamiau.
</p>

<p>
Flask galima įdiegti su pip naudojant <code>pip install flask</code>.
</p>
</div>

<div id="outline-container-orgcd9a3d3" class="outline-3">
<h3 id="orgcd9a3d3"><span class="section-number-3">1.1.</span> Kaip sukurti minimalią svetainę:</h3>
<div class="outline-text-3" id="text-1-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask

<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">home</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> <span style="color: #b8bb26;">"&lt;h1&gt;&#268;ia mano naujas puslapis&lt;/h1&gt;"</span>

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">(</span>debug=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>:
</pre>
</div>
</div>
</div>

<div id="outline-container-org0a99cc3" class="outline-3">
<h3 id="org0a99cc3"><span class="section-number-3">1.2.</span> Kaip puslapyje atvaizduoti įvestą kintamąjį:</h3>
<div class="outline-text-3" id="text-1-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask

<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/&lt;name&gt;"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">user</span><span style="color: #fe8019;">(</span>name<span style="color: #fe8019;">)</span>:
    <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">"Labas, </span>{name}<span style="color: #b8bb26;">"</span>

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">()</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd026e10" class="outline-3">
<h3 id="orgd026e10"><span class="section-number-3">1.3.</span> Kaip sukurti ir panaudoti HTML šabloną:</h3>
<div class="outline-text-3" id="text-1-3">
<p>
main.py:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, render_template

<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">user</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"index.html"</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">()</span>
</pre>
</div>

<p>
templates/index.html:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Mano Puslapis</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Labas, pasauli!</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>

<p>
Įdėkime į šabloną šiek tiek logikos:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Skai&#269;iavimai</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Skai&#269;iavimai: </span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
{<span style="color: #83a598;">%for</span> x in range(10)%}
{<span style="color: #83a598;">%if</span> x % 2 == 0 %}
&lt;<span style="color: #b8bb26;">p</span>&gt;{{x}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
{% endif %}
{<span style="color: #83a598;">%endfor</span>%}
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org41d12e6" class="outline-3">
<h3 id="org41d12e6"><span class="section-number-3">1.4.</span> Kaip kintamuosius perkelti į šabloną:</h3>
<div class="outline-text-3" id="text-1-4">
<p>
main.py
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, render_template

<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">home</span><span style="color: #fe8019;">()</span>:
    <span style="color: #83a598;">vardai</span> = <span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'Jonas'</span>, <span style="color: #b8bb26;">'Antanas'</span>, <span style="color: #b8bb26;">'Petras'</span><span style="color: #fe8019;">]</span>
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"index.html"</span>, sarasas=vardai<span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">()</span>
</pre>
</div>

<p>
templates/index.html
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Sara&#353;as</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">&#381;moni&#371; sara&#353;as: </span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
{<span style="color: #83a598;">%for</span> vardas in sarasas%}
&lt;<span style="color: #b8bb26;">p</span>&gt;{{vardas}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
{% endfor %}
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org994d667" class="outline-3">
<h3 id="org994d667"><span class="section-number-3">1.5.</span> Kaip perduoti duomenis iš svetainės į programą:</h3>
<div class="outline-text-3" id="text-1-5">
<p>
main.py
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, request, render_template
<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/login"</span>, methods=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">'GET'</span>, <span style="color: #b8bb26;">'POST'</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">login</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">if</span> request.method == <span style="color: #b8bb26;">"POST"</span>:
        vardas = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'vardas'</span><span style="color: #fe8019;">]</span>
        <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"greetings.html"</span>, vardas=vardas<span style="color: #fe8019;">)</span>
    <span style="color: #fb4934;">else</span>:
        <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"login.html"</span><span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">()</span>
</pre>
</div>

<p>
templates/index.html
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Prisijungimas</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
&lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"#"</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;Vardas:&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"vardas"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"submit"</span> <span style="color: #83a598;">value</span>=<span style="color: #b8bb26;">"submit"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;/<span style="color: #b8bb26;">form</span>&gt;
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>


<p>
templates/greetings.html
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Sveikiname</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">{{vardas}}, sveikiname prisijungus!</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org09e2d16" class="outline-3">
<h3 id="org09e2d16"><span class="section-number-3">1.6.</span> Naudojame base.html šabloną:</h3>
<div class="outline-text-3" id="text-1-6">
<p>
Failas templates/base.html:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
  &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Mano puslapis</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
&lt;<span style="color: #b8bb26;">div</span>&gt;
  &lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Sveiki,</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
  &lt;<span style="color: #b8bb26;">p</span>&gt;&#268;ia yra mano super puslapis!&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;/<span style="color: #b8bb26;">div</span>&gt;
&lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"container"</span>&gt;
  {% block content %}{% endblock %}
&lt;/<span style="color: #b8bb26;">div</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>

<p>
Failas templates/login.html:
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}
{% block content %}
&lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"#"</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;Vardas:&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"vardas"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"submit"</span> <span style="color: #83a598;">value</span>=<span style="color: #b8bb26;">"submit"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;/<span style="color: #b8bb26;">form</span>&gt;
{% endblock %}
</pre>
</div>

<p>
Failas templates/greetings.html:
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}
{% block content %}
&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">{{vardas}}, sveikiname prisijungus!</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
{% endblock %}
</pre>
</div>
</div>
</div>

<div id="outline-container-orge79663e" class="outline-3">
<h3 id="orge79663e"><span class="section-number-3">1.7.</span> Stiliui panaudojame "Bootstrap":</h3>
<div class="outline-text-3" id="text-1-7">
<p>
Faile base.html:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
  &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Mano puslapis</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
  &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"utf-8"</span>&gt;
  &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"viewport"</span> <span style="color: #83a598;">content</span>=<span style="color: #b8bb26;">"width=device-width, initial-scale=1"</span>&gt;
  &lt;<span style="color: #b8bb26;">link</span> <span style="color: #83a598;">rel</span>=<span style="color: #b8bb26;">"stylesheet"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"</span>&gt;
  &lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
  &lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
  &lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;

<span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">Navigation</span><span style="color: #928374;"> --&gt;</span>
&lt;<span style="color: #b8bb26;">nav</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar navbar-expand-lg navbar-light bg-light static-top mb-5 shadow"</span>&gt;
  &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"container"</span>&gt;
    &lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-brand"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"#"</span>&gt;
    Mano puslapis&lt;/<span style="color: #b8bb26;">a</span>&gt;
    &lt;<span style="color: #b8bb26;">button</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-toggler"</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"button"</span> <span style="color: #83a598;">data-toggle</span>=<span style="color: #b8bb26;">"collapse"</span> <span style="color: #83a598;">data-target</span>=<span style="color: #b8bb26;">"#navbarResponsive"</span> <span style="color: #83a598;">aria-controls</span>=<span style="color: #b8bb26;">"navbarResponsive"</span> <span style="color: #83a598;">aria-expanded</span>=<span style="color: #b8bb26;">"false"</span> <span style="color: #83a598;">aria-label</span>=<span style="color: #b8bb26;">"Toggle navigation"</span>&gt;
          &lt;<span style="color: #b8bb26;">span</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-toggler-icon"</span>&gt;&lt;/<span style="color: #b8bb26;">span</span>&gt;
        &lt;/<span style="color: #b8bb26;">button</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"collapse navbar-collapse"</span> <span style="color: #83a598;">id</span>=<span style="color: #b8bb26;">"navbarResponsive"</span>&gt;
      &lt;<span style="color: #b8bb26;">ul</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-nav ml-auto"</span>&gt;
        &lt;<span style="color: #b8bb26;">li</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-item"</span>&gt;
          &lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-link"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"/login"</span>&gt;Prisijungti&lt;/<span style="color: #b8bb26;">a</span>&gt;
        &lt;/<span style="color: #b8bb26;">li</span>&gt;
      &lt;/<span style="color: #b8bb26;">ul</span>&gt;
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
  &lt;/<span style="color: #b8bb26;">div</span>&gt;
&lt;/<span style="color: #b8bb26;">nav</span>&gt;

&lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"jumbotron text-center"</span>&gt;
  &lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Sveiki,</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
  &lt;<span style="color: #b8bb26;">p</span>&gt;&#268;ia yra mano super puslapis!&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;/<span style="color: #b8bb26;">div</span>&gt;

&lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"container"</span>&gt;
{% block content %}{% endblock %}
&lt;/<span style="color: #b8bb26;">div</span>&gt;

&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org4fedeaa" class="outline-3">
<h3 id="org4fedeaa"><span class="section-number-3">1.8.</span> Užduotys</h3>
<div class="outline-text-3" id="text-1-8">
</div>
<div id="outline-container-org1c885b4" class="outline-4">
<h4 id="org1c885b4"><span class="section-number-4">1.8.1.</span> 1 užduotis</h4>
<div class="outline-text-4" id="text-1-8-1">
<p>
Sukurti programą, kuri turėtų statinį puslapį, pvz. localhost:5000 su
norimu tekstu (rekomenduojama naudoti šablonus)
</p>

<p>
main.py
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, render_template

<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">home</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"home.html"</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">(</span>debug=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
template/home.html
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Labas</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
    &lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Norimas tekstas</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>


<div id="org4e5275a" class="figure">
<p><img src="./static/images/1.png" alt="1.png" width="600px" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgaefea49" class="outline-4">
<h4 id="orgaefea49"><span class="section-number-4">1.8.2.</span> 2 užduotis</h4>
<div class="outline-text-4" id="text-1-8-2">
<p>
Sukurti programą, kuri įvedus norimą žodį adreso eilutėje (po /
simbolio) ir paspaudus ENTER, atspausdintų jį penkis kartus.
</p>

<p>
Still not sure where this is useful.
</p>

<p>
main.py
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, render_template

<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/&lt;word&gt;"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">word</span><span style="color: #fe8019;">(</span>word<span style="color: #fe8019;">)</span>:
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"word.html"</span>, word = word<span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">(</span>debug=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
templates/word.html
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">&#381;od&#382;iai</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
    {% for x in range(5) %}
        {{word}}
    {% endfor %}
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>



<div id="org80bf056" class="figure">
<p><img src="./static/images/2.png" alt="2.png" width="600px" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgaf6126e" class="outline-4">
<h4 id="orgaf6126e"><span class="section-number-4">1.8.3.</span> 3 užduotis</h4>
<div class="outline-text-4" id="text-1-8-3">
<p>
Sukurti programą, kuri puslapyje localhost:5000/keliamieji parodytų
visus keliamuosius metus nuo 1900 iki 2100 metų.
</p>

<p>
Cool use of calendar.
</p>

<p>
main.py
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, render_template
<span style="color: #fb4934;">import</span> calendar

<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/keliamieji"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">leap</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"leap.html"</span>, calendar = calendar<span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">(</span>debug=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
templates/leap.html
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Leap</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
    {% for year in range(1900, 2100) %}
    {% if calendar.isleap(year) %}
    {{year}}
    {% endif %}
    {% endfor %}
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>


<div id="org524375d" class="figure">
<p><img src="./static/images/3.png" alt="3.png" width="600px" />
</p>
</div>
</div>
</div>

<div id="outline-container-org065538d" class="outline-4">
<h4 id="org065538d"><span class="section-number-4">1.8.4.</span> 4 užduotis</h4>
<div class="outline-text-4" id="text-1-8-4">
<p>
Sukurti programą, kuri leistų įvesti metus ir paspaudus patvirtinimo
mygtuką parodytų, ar jie yra keliamieji.
</p>

<p>
main.py
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, render_template, request
<span style="color: #fb4934;">import</span> calendar

<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>


<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">home</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> <span style="color: #b8bb26;">"&lt;h1&gt;Labas, cia yra pradinis&lt;/h1&gt;&lt;p&gt;Paziurek kas slepiasi po http://localhost:5000/arkeliamieji&lt;/p&gt;"</span>


<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/arkeliamieji"</span>, methods=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">"GET"</span>, <span style="color: #b8bb26;">"POST"</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">isleap</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">if</span> request.method == <span style="color: #b8bb26;">"GET"</span>:
        <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"getyear.html"</span><span style="color: #fe8019;">)</span>
    <span style="color: #fb4934;">elif</span> request.method == <span style="color: #b8bb26;">"POST"</span>:
        year = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">"year"</span><span style="color: #fe8019;">]</span>
        <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"isleap.html"</span>, year=<span style="color: #fe8019;">int</span><span style="color: #cc241d;">(</span>year<span style="color: #cc241d;">)</span>, calendar=calendar<span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">(</span>debug=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
templates/getyear.html
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Get Year</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
&lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"#"</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;Metai:&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"year"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"submit"</span> <span style="color: #83a598;">value</span>=<span style="color: #b8bb26;">"Patikrinti"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;/<span style="color: #b8bb26;">form</span>&gt;
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>

<p>
templates/isleap.html
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Is Leap</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
    {% if calendar.isleap(year) %}
    &lt;<span style="color: #b8bb26;">p</span>&gt;Keliamieji&lt;/<span style="color: #b8bb26;">p</span>&gt;
    {% else %}
    &lt;<span style="color: #b8bb26;">p</span>&gt;Nekeliamieji&lt;/<span style="color: #b8bb26;">p</span>&gt;
    {% endif %}
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>


<div id="org9a0bbc8" class="figure">
<p><img src="./static/images/4.gif" alt="4.gif" width="600px" />
</p>
</div>
</div>
</div>


<div id="outline-container-orga235b90" class="outline-4">
<h4 id="orga235b90"><span class="section-number-4">1.8.5.</span> 5 užduotis (papildomai)</h4>
<div class="outline-text-4" id="text-1-8-5">
<p>
Patobulinti anksčiau kurtą biudžeto programą, panaudojant Flask
(bendravimui su vartotoju) ir SQLAlchemy (darbui su duomenų baze,
kurioje bus saugomi pajamų ir išlaidų įrašai).
</p>

<p>
Run db.py file first to create a database:
</p>

<p>
db.py
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">import</span> datetime
<span style="color: #fb4934;">import</span> os
<span style="color: #fb4934;">from</span> sqlalchemy <span style="color: #fb4934;">import</span> Column, Integer, String, Float, DateTime, create_engine
<span style="color: #fb4934;">from</span> sqlalchemy.ext.declarative <span style="color: #fb4934;">import</span> declarative_base

<span style="color: #83a598;">engine</span> = create_engine<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"sqlite:///.db"</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">Base</span> = declarative_base<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Projektas</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    <span style="color: #83a598;">__tablename__</span> = <span style="color: #b8bb26;">"Projektas"</span>
    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    name = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Pavadinimas"</span>, String<span style="color: #fe8019;">)</span>
    price = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Kaina"</span>, Float<span style="color: #fe8019;">)</span>
    created_date = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Suk&#363;rimo data"</span>, DateTime, default=datetime.datetime.utcnow<span style="color: #fe8019;">)</span>

    <span style="color: #928374;"># </span><span style="color: #928374;">aprasom taip pat kaip paprasta klase. Asocijuojam su klase. Kad zinotu i kuri collumn deti kintamaji</span>
    <span style="color: #928374;"># </span><span style="color: #928374;">created_date matai neidetas apacioje, nes nereikia jo mum patiem irasyti, jis turi default reiksme</span>
    <span style="color: #928374;"># </span><span style="color: #928374;">jeigu noretum irasyti ir keisti - tuomet prie init turetum prirasyti</span>
    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__init__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, name, price<span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">self</span>.name = name
        <span style="color: #fb4934;">self</span>.price = price

    <span style="color: #928374;"># </span><span style="color: #928374;">Kada kvieciam klase su query, kad ja israsytu ir KAIP israsytu apibudinam cia</span>
    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">"</span>{<span style="color: #fb4934;">self</span>.<span style="color: #fe8019;">id</span>}<span style="color: #b8bb26;"> </span>{<span style="color: #fb4934;">self</span>.name}<span style="color: #b8bb26;"> - </span>{<span style="color: #fb4934;">self</span>.price}<span style="color: #b8bb26;">: </span>{<span style="color: #fb4934;">self</span>.created_date}<span style="color: #b8bb26;">"</span>


<span style="color: #928374;"># </span><span style="color: #928374;">kviecia connectiona ir sukuria visas lenteles jeigu jos neegzistuoja. Jos neupdeitins.</span>
Base.metadata.create_all<span style="color: #fe8019;">(</span>engine<span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
main.py
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">import</span> os
<span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, request, render_template, url_for, redirect
<span style="color: #fb4934;">from</span> flask_sqlalchemy <span style="color: #fb4934;">import</span> SQLAlchemy

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    <span style="color: #fb4934;">from</span> models.irasas <span style="color: #fb4934;">import</span> Irasas

basedir = os.path.abspath<span style="color: #fe8019;">(</span>os.path.dirname<span style="color: #cc241d;">(</span>__file__<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
app = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>


app.config<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">"SQLALCHEMY_DATABASE_URI"</span><span style="color: #fe8019;">]</span> = <span style="color: #b8bb26;">"sqlite:///"</span> + os.path.join<span style="color: #fe8019;">(</span>basedir, <span style="color: #b8bb26;">"biudzetas.db"</span><span style="color: #fe8019;">)</span>
app.config<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">"SQLALCHEMY_TRACK_MODIFICATIONS"</span><span style="color: #fe8019;">]</span> = <span style="color: #d3869b;">False</span>
db = SQLAlchemy<span style="color: #fe8019;">(</span>app<span style="color: #fe8019;">)</span>

db.create_all<span style="color: #fe8019;">()</span>


<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/prideti"</span>, methods=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">"GET"</span>, <span style="color: #b8bb26;">"POST"</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">prideti</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">if</span> request.method == <span style="color: #b8bb26;">"POST"</span>:
        suma = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">"suma"</span><span style="color: #fe8019;">]</span>
        info = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">"info"</span><span style="color: #fe8019;">]</span>
        irasas = Irasas<span style="color: #fe8019;">(</span>suma, info<span style="color: #fe8019;">)</span>
        db.session.add<span style="color: #fe8019;">(</span>irasas<span style="color: #fe8019;">)</span>
        db.session.commit<span style="color: #fe8019;">()</span>
        <span style="color: #fb4934;">return</span> sarasas<span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">elif</span> request.method == <span style="color: #b8bb26;">"GET"</span>:
        <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"prideti.html"</span><span style="color: #fe8019;">)</span>


<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">sarasas</span><span style="color: #fe8019;">()</span>:
    biudzetas = Irasas.query.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"sarasas.html"</span>, biudzetas=biudzetas<span style="color: #fe8019;">)</span>


<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/balansas"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">balansas</span><span style="color: #fe8019;">()</span>:
    biudzetas = db.session.query<span style="color: #fe8019;">(</span>Irasas<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>
    balansas = 0
    <span style="color: #fb4934;">for</span> irasas <span style="color: #fb4934;">in</span> biudzetas:
        balansas += irasas.suma
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"balansas.html"</span>, balansas=balansas<span style="color: #fe8019;">)</span>


<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/irasas_delete/&lt;int:id&gt;"</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">irasas_delete</span><span style="color: #fe8019;">(</span><span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>:
    uzklausa = db.session.query<span style="color: #fe8019;">(</span>Irasas<span style="color: #fe8019;">)</span>.get<span style="color: #fe8019;">(</span><span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>
    db.session.delete<span style="color: #fe8019;">(</span>uzklausa<span style="color: #fe8019;">)</span>
    db.session.commit<span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">return</span> redirect<span style="color: #fe8019;">(</span>url_for<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">"sarasas"</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>


<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"/irasas_update/&lt;int:id&gt;"</span>, methods=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">"GET"</span>, <span style="color: #b8bb26;">"POST"</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">irasas_update</span><span style="color: #fe8019;">(</span><span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>:
    <span style="color: #fb4934;">if</span> request.method == <span style="color: #b8bb26;">"POST"</span>:
        irasas = db.session.query<span style="color: #fe8019;">(</span>Irasas<span style="color: #fe8019;">)</span>.get<span style="color: #fe8019;">(</span><span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>
        irasas.suma = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">"suma"</span><span style="color: #fe8019;">]</span>
        irasas.info = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">"info"</span><span style="color: #fe8019;">]</span>
        db.session.commit<span style="color: #fe8019;">()</span>
        <span style="color: #fb4934;">return</span> redirect<span style="color: #fe8019;">(</span>url_for<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">"sarasas"</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    <span style="color: #fb4934;">elif</span> request.method == <span style="color: #b8bb26;">"GET"</span>:
        irasas = db.session.query<span style="color: #fe8019;">(</span>Irasas<span style="color: #fe8019;">)</span>.get<span style="color: #fe8019;">(</span><span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>
        <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"redaguoti.html"</span>, irasas=irasas<span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    app.run<span style="color: #fe8019;">(</span>debug=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
models/irasas.py
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> main <span style="color: #fb4934;">import</span> db


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Irasas</span><span style="color: #fe8019;">(</span>db.Model<span style="color: #fe8019;">)</span>:
    <span style="color: #83a598;">__tablename__</span> = <span style="color: #b8bb26;">"Irasas"</span>
    <span style="color: #fe8019;">id</span> = db.Column<span style="color: #fe8019;">(</span>db.Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    suma = db.Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Suma"</span>, db.Float<span style="color: #fe8019;">)</span>
    info = db.Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Info"</span>, db.String<span style="color: #cc241d;">(</span>120<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__init__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, suma, info<span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">self</span>.suma = suma
        <span style="color: #fb4934;">self</span>.info = info

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">"</span>{<span style="color: #fb4934;">self</span>.<span style="color: #fe8019;">id</span>}<span style="color: #b8bb26;">: suma - </span>{<span style="color: #fb4934;">self</span>.suma}<span style="color: #b8bb26;">, info - </span>{<span style="color: #fb4934;">self</span>.info}<span style="color: #b8bb26;">"</span>


db.create_all<span style="color: #fe8019;">()</span>
</pre>
</div>

<p>
templates/balansas.html
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}
{% block content %}
    &lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Balansas: </span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;{{balansas}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
{% endblock %}
</pre>
</div>

<p>
templates/prideti.html
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}
{% block content %}
&lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"#"</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;Suma:&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"suma"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;Info:&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"info"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"submit"</span> <span style="color: #83a598;">value</span>=<span style="color: #b8bb26;">"&#302;vesti"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;/<span style="color: #b8bb26;">form</span>&gt;
{% endblock %}
</pre>
</div>

<p>
templates/redaguoti.html
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}
{% block content %}
&lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"#"</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;Suma:&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"suma"</span> value={{irasas.suma}} /&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;Info:&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"info"</span> value={{irasas.info}} /&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;&lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"submit"</span> <span style="color: #83a598;">value</span>=<span style="color: #b8bb26;">"&#302;vesti"</span>/&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;/<span style="color: #b8bb26;">form</span>&gt;
{% endblock %}&gt;
</pre>
</div>

<p>
templates/sarasas.html
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}
{% block content %}
&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Biud&#382;eto &#303;ra&#353;ai: </span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
{<span style="color: #83a598;">%for</span> irasas in biudzetas%}
&lt;<span style="color: #b8bb26;">p</span>&gt;{{irasas}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"{{ url_for('irasas_delete', id=irasas['id']) }}"</span>&gt;I&#353;trinti&lt;/<span style="color: #b8bb26;">a</span>&gt;
&lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"{{ url_for('irasas_update', id=irasas['id']) }}"</span>&gt;Redaguoti&lt;/<span style="color: #b8bb26;">a</span>&gt;
&lt;<span style="color: #b8bb26;">hr</span>&gt;
{% endfor %}
{% endblock %}
</pre>
</div>

<p>
templates/base.html
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
  &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Mano biud&#382;etas</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
  &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"utf-8"</span>&gt;
  &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"viewport"</span> <span style="color: #83a598;">content</span>=<span style="color: #b8bb26;">"width=device-width, initial-scale=1"</span>&gt;
  &lt;<span style="color: #b8bb26;">link</span> <span style="color: #83a598;">rel</span>=<span style="color: #b8bb26;">"stylesheet"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"</span>&gt;
  &lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
  &lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
  &lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;

<span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">Navigation</span><span style="color: #928374;"> --&gt;</span>
&lt;<span style="color: #b8bb26;">nav</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar navbar-expand-lg navbar-light bg-light static-top mb-5 shadow"</span>&gt;
  &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"container"</span>&gt;
    &lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-brand"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"#"</span>&gt;
    &lt;<span style="color: #b8bb26;">svg</span> <span style="color: #83a598;">width</span>=<span style="color: #b8bb26;">"1em"</span> <span style="color: #83a598;">height</span>=<span style="color: #b8bb26;">"1em"</span> <span style="color: #83a598;">viewBox</span>=<span style="color: #b8bb26;">"0 0 16 16"</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"bi bi-cash"</span> <span style="color: #83a598;">fill</span>=<span style="color: #b8bb26;">"currentColor"</span> <span style="color: #83a598;">xmlns</span>=<span style="color: #b8bb26;">"http://www.w3.org/2000/svg"</span>&gt;
    &lt;<span style="color: #b8bb26;">path</span> <span style="color: #83a598;">fill-rule</span>=<span style="color: #b8bb26;">"evenodd"</span> <span style="color: #83a598;">d</span>=<span style="color: #b8bb26;">"M15 4H1v8h14V4zM1 3a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1H1z"</span>/&gt;
    &lt;<span style="color: #b8bb26;">path</span> <span style="color: #83a598;">d</span>=<span style="color: #b8bb26;">"M13 4a2 2 0 0 0 2 2V4h-2zM3 4a2 2 0 0 1-2 2V4h2zm10 8a2 2 0 0 1 2-2v2h-2zM3 12a2 2 0 0 0-2-2v2h2zm7-4a2 2 0 1 1-4 0 2 2 0 0 1 4 0z"</span>/&gt;
    &lt;/<span style="color: #b8bb26;">svg</span>&gt;
    Mano biud&#382;etas&lt;/<span style="color: #b8bb26;">a</span>&gt;
    &lt;<span style="color: #b8bb26;">button</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-toggler"</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"button"</span> <span style="color: #83a598;">data-toggle</span>=<span style="color: #b8bb26;">"collapse"</span> <span style="color: #83a598;">data-target</span>=<span style="color: #b8bb26;">"#navbarResponsive"</span> <span style="color: #83a598;">aria-controls</span>=<span style="color: #b8bb26;">"navbarResponsive"</span> <span style="color: #83a598;">aria-expanded</span>=<span style="color: #b8bb26;">"false"</span> <span style="color: #83a598;">aria-label</span>=<span style="color: #b8bb26;">"Toggle navigation"</span>&gt;
          &lt;<span style="color: #b8bb26;">span</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-toggler-icon"</span>&gt;&lt;/<span style="color: #b8bb26;">span</span>&gt;
        &lt;/<span style="color: #b8bb26;">button</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"collapse navbar-collapse"</span> <span style="color: #83a598;">id</span>=<span style="color: #b8bb26;">"navbarResponsive"</span>&gt;
      &lt;<span style="color: #b8bb26;">ul</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"navbar-nav ml-auto"</span>&gt;
        &lt;<span style="color: #b8bb26;">li</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-item"</span>&gt;
          &lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-link"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"/"</span>&gt;S&#261;ra&#353;as&lt;/<span style="color: #b8bb26;">a</span>&gt;
        &lt;/<span style="color: #b8bb26;">li</span>&gt;
        &lt;<span style="color: #b8bb26;">li</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-item"</span>&gt;
          &lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-link"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"/balansas"</span>&gt;Balansas&lt;/<span style="color: #b8bb26;">a</span>&gt;
        &lt;/<span style="color: #b8bb26;">li</span>&gt;
        &lt;<span style="color: #b8bb26;">li</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-item"</span>&gt;
            &lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-link"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"/prideti"</span>&gt;Prid&#279;ti&lt;/<span style="color: #b8bb26;">a</span>&gt;
        &lt;/<span style="color: #b8bb26;">li</span>&gt;
      &lt;/<span style="color: #b8bb26;">ul</span>&gt;
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
  &lt;/<span style="color: #b8bb26;">div</span>&gt;
&lt;/<span style="color: #b8bb26;">nav</span>&gt;

&lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"container"</span>&gt;
    {% block content %}{% endblock %}
&lt;/<span style="color: #b8bb26;">div</span>&gt;

&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>

<p>
Run main.py and open <a href="http://127.0.0.1:5000">http://127.0.0.1:5000</a>, see the magic :)
</p>


<div id="orgbd0f41f" class="figure">
<p><img src="./static/images/5.gif" alt="5.gif" width="600px" />
</p>
</div>

<p>
<code>Important notes</code>!!
</p>

<p>
Jeigu norite paleistį šį projektą savo kompiuteryje, prieš tai
įsitikinkite, jog turite šiam projektui reikiamą flask_sqlalchemy
v2.5.1 versiją.
</p>

<p>
Tai galite padaryti savo virtualioje, šiam projektui skirtoje python
aplinkoje. Terminale tiesiog paleiskite šią komandą, kad įrašyti
reikiamą flask-sqlalchemy versiją:
</p>

<p>
<code>pip install flask-sqlalchemy==2.5.1</code>
</p>

<p>
Arba galite pasinaudoti requirements.txt. failiuku ir vos tik
parsisiuntus šį branch į savo kompiuterį ir pasiruošus virtualią
aplinką, susirašyti visas šiam projektui būtinas "dependencies" su šia
komanda:
</p>

<p>
<code>pip install -r requirements.txt</code>
</p>

<p>
requirements.txt
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #83a598;">click</span>==8.1.3
<span style="color: #83a598;">Flask</span>==2.2.2
Flask-SQLAlchemy==2.5.1
<span style="color: #83a598;">greenlet</span>==2.0.1
importlib-metadata==6.0.0
<span style="color: #83a598;">itsdangerous</span>==2.1.2
<span style="color: #83a598;">Jinja2</span>==3.1.2
<span style="color: #83a598;">MarkupSafe</span>==2.1.2
<span style="color: #83a598;">SQLAlchemy</span>==1.4.46
<span style="color: #83a598;">Werkzeug</span>==2.2.2
<span style="color: #83a598;">zipp</span>==3.11.0
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org486139d" class="outline-2">
<h2 id="org486139d"><span class="section-number-2">2.</span> Flask 1 dalis</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgffabccc" class="outline-3">
<h3 id="orgffabccc"><span class="section-number-3">2.1.</span> Susikurkime paprastą flask aplikaciją</h3>
<div class="outline-text-3" id="text-2-1">
<p>
app.py:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, render_template
<span style="color: #928374;"># </span><span style="color: #928374;">i&#353; flask bibliotekos importuojame klas&#281; Flask ir f-j&#261; render_template.</span>
<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">inicijuojame klas&#279;s Flask objekt&#261;, priskiriame kintam&#261;jam app.</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'/'</span><span style="color: #fe8019;">)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">&#303;velkame f-j&#261; &#303; flask dekoratori&#371;. Be jo  funkcija b&#363;t&#371; bereik&#353;m&#279;. Dekorato riaus parametruose nurodome, kad nor&#279;sime rezultato 127.0.0.1:8000/ url adrese."""</span>

<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">index</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'index.html'</span><span style="color: #fe8019;">)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">funkcijoje index nurodome, kad nor&#279;sime sugeneruoti index.html</span>

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">'__main__'</span>:
  app.run<span style="color: #fe8019;">(</span>host=<span style="color: #b8bb26;">'127.0.0.1'</span>, port=8000, debug=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">patikrin&#281;, ar programa leid&#382;iama ne i&#353; kito failo, leid&#382;iame m&#363;s&#371; app, su parametrais. debug = True klaidos atveju mums rodys informatyvias &#382;inutes nar&#353;ykl&#279;je.</span>
</pre>
</div>

<p>
Komentaruose šiek tiek informacijos, kas vyksta. Dabar mums reikės
susikurti html šabloną. Flask šablonų ieško templates kataloge. :
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!DOCTYPE</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
&lt;<span style="color: #b8bb26;">head</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"UTF-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"viewport"</span> <span style="color: #83a598;">content</span>=<span style="color: #b8bb26;">"width=device-width, initial-scale=1.0"</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">http-equiv</span>=<span style="color: #b8bb26;">"X-UA-Compatible"</span> <span style="color: #83a598;">content</span>=<span style="color: #b8bb26;">"ie=edge"</span>&gt;
    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Demo</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
&lt;/<span style="color: #b8bb26;">head</span>&gt;
&lt;<span style="color: #b8bb26;">body</span>&gt;
    &lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Flask Flask Flask</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
&lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>

<p>
Patikrinkime, ar veikia:
</p>


<div id="orgdc326f3" class="figure">
<p><img src="./static/images/flask1_1.png" alt="flask1_1.png" width="600px" />
</p>
</div>


<p>
Logikos naudojimas šablonuose:
</p>

<p>
Už logiką šablonuose atsako Jinja2 šablonų generatorius (templating
engine), jis per savo sintaksę leidžia mums įterpti kintamuosius ir
logiką į html failus.
</p>

<p>
paruoškime paprastą žodynų sąrašą, kuris galės būti mūsų duomenų bazės
imitacija:
</p>

<p>
dictionary.py:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">data</span> =<span style="color: #fe8019;">[</span><span style="color: #cc241d;">{</span>
    <span style="color: #b8bb26;">'data'</span>:<span style="color: #b8bb26;">'2020 01 01'</span>,
    <span style="color: #b8bb26;">'autorius'</span>: <span style="color: #b8bb26;">'Autorius 1'</span>,
    <span style="color: #b8bb26;">'pavadinimas'</span>: <span style="color: #b8bb26;">'Apie niek&#261;'</span>,
    <span style="color: #b8bb26;">'tekstas'</span>: <span style="color: #b8bb26;">'Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis. Summus brains sit&#8203;&#8203;, morbo vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris.'</span>
<span style="color: #cc241d;">}</span>,
<span style="color: #cc241d;">{</span>
    <span style="color: #b8bb26;">'data'</span>:<span style="color: #b8bb26;">'2020 02 01'</span>,
    <span style="color: #b8bb26;">'autorius'</span>: <span style="color: #b8bb26;">'KITAS AUTORIUS'</span>,
    <span style="color: #b8bb26;">'pavadinimas'</span>: <span style="color: #b8bb26;">'Apie zombius'</span>,
    <span style="color: #b8bb26;">'tekstas'</span>: <span style="color: #b8bb26;">'Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis. Summus brains sit&#8203;&#8203;, morbo vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris. '</span>
<span style="color: #cc241d;">}</span>,
<span style="color: #cc241d;">{</span>
    <span style="color: #b8bb26;">'data'</span>:<span style="color: #b8bb26;">'2020 03 01'</span>,
    <span style="color: #b8bb26;">'autorius'</span>: <span style="color: #b8bb26;">'Dar ka&#382;kas'</span>,
    <span style="color: #b8bb26;">'pavadinimas'</span>: <span style="color: #b8bb26;">'Braiiins!'</span>,
    <span style="color: #b8bb26;">'tekstas'</span>: <span style="color: #b8bb26;">'Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis. Summus brains sit&#8203;&#8203;, morbo vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris.'</span>
<span style="color: #cc241d;">}</span><span style="color: #fe8019;">]</span>
</pre>
</div>


<p>
Pagrindiniame faile importuokime šį kintamąjį ir perduokime į šabloną:
</p>

<p>
app.py:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, render_template
<span style="color: #fb4934;">from</span> dictionary <span style="color: #fb4934;">import</span> data <span style="color: #928374;"># </span><span style="color: #928374;">IMPORTUOJAME</span>
<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>


<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'/'</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">index</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'index.html'</span>, data=data<span style="color: #fe8019;">)</span> <span style="color: #928374;"># </span><span style="color: #928374;">PERDUODAME &#302; &#352;ABLON&#260;</span>

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">'__main__'</span>:
  app.run<span style="color: #fe8019;">(</span>host=<span style="color: #b8bb26;">'127.0.0.1'</span>, port=8000, debug=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
Dabar dirbsime su šablonu. Pradžiai tiesiog perduokime kintamąjį į
body:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #b8bb26;">body</span>&gt;
    &lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Straipsniai:</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
    {{ data }}
&lt;/<span style="color: #b8bb26;">body</span>&gt;
</pre>
</div>


<div id="org2eec2c5" class="figure">
<p><img src="./static/images/flask1_2.png" alt="flask1_2.png" width="600px" />
</p>
</div>

<p>
Čia yra grubus žodynų sąrašo perdavimas, jį ir matome. Pabandykime tai
paversti straipsnių puslapiu:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #b8bb26;">body</span>&gt;
    &lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Straipsniai</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
    &lt;<span style="color: #b8bb26;">br</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;
    {% for straipsnis in data %}
    &lt;<span style="color: #b8bb26;">h3</span>&gt;<span style="font-style: italic; text-decoration: underline;">{{ straipsnis['pavadinimas'] }}</span>&lt;/<span style="color: #b8bb26;">h3</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['data'] }}, {{ straipsnis['autorius'] }}&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">hr</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['tekstas'] }}&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">hr</span>&gt;
    {% endfor %}
&lt;/<span style="color: #b8bb26;">body</span>&gt;
</pre>
</div>


<div id="org0447e99" class="figure">
<p><img src="./static/images/flask1_3.png" alt="flask1_3.png" width="600px" />
</p>
</div>

<p>
Matome, kaip galime iteruoti per duomenis html'e. Pamėginkime įtraukti
if logiką. Pradžiai papildykime 'duomenų bazę'. Kiekviename žodyne
įtraukime 'status'. Dalies statusas bus 'published', dalies
'unpublished':
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fe8019;">{</span>
    <span style="color: #b8bb26;">'data'</span>:<span style="color: #b8bb26;">'2020 01 01'</span>,
    <span style="color: #b8bb26;">'autorius'</span>: <span style="color: #b8bb26;">'Autorius 1'</span>,
    <span style="color: #b8bb26;">'pavadinimas'</span>: <span style="color: #b8bb26;">'Apie niek&#261;'</span>,
    <span style="color: #b8bb26;">'tekstas'</span>: <span style="color: #b8bb26;">'Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis. Summus brains sit&#8203;&#8203;, morbo vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris.'</span>,
    <span style="color: #b8bb26;">'status'</span>: <span style="color: #b8bb26;">'published'</span>
<span style="color: #fe8019;">}</span>, <span style="color: #928374;"># </span><span style="color: #928374;">ir t.t.</span>
</pre>
</div>

<p>
įtraukime if logiką į šabloną:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #b8bb26;">body</span>&gt;
    &lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Straipsniai</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
    &lt;<span style="color: #b8bb26;">br</span>&gt;
    {% for straipsnis in data %}
    {% if straipsnis['status'] == 'published' %}
    &lt;<span style="color: #b8bb26;">h3</span>&gt;<span style="font-style: italic; text-decoration: underline;">{{ straipsnis['pavadinimas'] }}</span>&lt;/<span style="color: #b8bb26;">h3</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['data'] }}, &lt;<span style="color: #b8bb26;">i</span>&gt;<span style="font-style: italic;">{{ straipsnis['autorius'] }}</span>&lt;/<span style="color: #b8bb26;">i</span>&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">hr</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['tekstas'] }}&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">br</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;
    {% endif %}
    {% endfor %}
&lt;/<span style="color: #b8bb26;">body</span>&gt;
</pre>
</div>


<div id="org3e6d1b7" class="figure">
<p><img src="./static/images/flask1_4.png" alt="flask1_4.png" width="600px" />
</p>
</div>

<p>
Matome, kad straipsnis su statusu != 'published' nebuvo publikuotas.
Kaip ir python'e, galima naudoti {%elif %} ir {% else %}. Pvz.:
</p>


<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #b8bb26;">body</span>&gt;
    &lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Straipsniai</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
    &lt;<span style="color: #b8bb26;">br</span>&gt;
    {% for straipsnis in data %}
    {% if straipsnis['status'] == 'published' %}
    &lt;<span style="color: #b8bb26;">h3</span>&gt;<span style="font-style: italic; text-decoration: underline;">{{ straipsnis['pavadinimas'] }}</span>&lt;/<span style="color: #b8bb26;">h3</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['data'] }}, &lt;<span style="color: #b8bb26;">i</span>&gt;<span style="font-style: italic;">{{ straipsnis['autorius'] }}</span>&lt;/<span style="color: #b8bb26;">i</span>&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">hr</span>&gt;
    &lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['tekstas'] }}&lt;/<span style="color: #b8bb26;">p</span>&gt;
    &lt;<span style="color: #b8bb26;">br</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;
    {% else %}
    &lt;<span style="color: #b8bb26;">h3</span>&gt;{{ straipsnis['pavadinimas'] }} - &lt;<span style="color: #b8bb26;">i</span>&gt;<span style="font-style: italic;">Publikavimas laikinai i&#353;jungtas</span>&lt;/<span style="color: #b8bb26;">i</span>&gt;&lt;/<span style="color: #b8bb26;">h3</span>&gt;
    &lt;<span style="color: #b8bb26;">br</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;
    {% endif %}
    {% endfor %}
&lt;/<span style="color: #b8bb26;">body</span>&gt;
</pre>
</div>


<div id="orge3107d8" class="figure">
<p><img src="./static/images/flask1_5.png" alt="flask1_5.png" width="600px" />
</p>
</div>

<p>
Paveldėjimas šablonuose
</p>

<p>
Dažniausiai interneto svetainės turi struktūrą, kai kiekviename
puslapyje atsikartoja tam tikri komponentai. Tai gali būti titulinė
puslapio dalis, &lt;head&gt; komponentai, navigacijos panelė, footer'is,
nuorodos į CSS, JavaScript ir pan. Jinja2 turi mechanizmą, leidžiantį
mums kiekvieną kartą nerašyti į šabloną šių komponentų, t.y. išsaugoti
juos atskirai ir naudoti tik nuorodas į juos. Pabandykime pritaikyti
praktikoje.
</p>

<p>
Pasiskolinkime standartinį išdėstymą iš <a href="https://github.com/StartBootstrap/startbootstrap-bare/blob/master/dist/index.html">čia</a>.
</p>

<p>
Tam, kad veiktų mobiliosios versijos navigacija, data-toggle ir
data-target reikia pakeisti data-bs-toggle ir data-bs-target.
</p>

<p>
Nusikopijuokime nuorodos HTML'ą į kokį nors html failą.
</p>

<p>
Pakeiskime lokalias css ir JavaScript nuorodas į <a href="https://getbootstrap.com/docs/4.3/getting-started/introduction/">Bootstrap CDN</a>
</p>

<p>
Perkelkime savo &lt;body&gt; dalį vietoje tos dalies, kuri yra po komentaru
&lt;!&#x2013; Page Content &#x2013;&gt;
</p>

<p>
senąjį failą pervadinkime backup.html, naująjį - index html.
</p>

<p>
Rezultatas atrodys maždaug taip:
</p>


<div id="orge963663" class="figure">
<p><img src="./static/images/flask1_6.png" alt="flask1_6.png" width="600px" />
</p>
</div>

<p>
Įsivaizduokime, kad mums reikės dar puslapio 'apie', galbūt dar keleto
puslapių ateityje. Visi jie turės tą patį bootstrap'ą, ir tą pačią
navigacijos panelę.
</p>

<p>
templates kataloge susikurkime failą base.html
</p>

<p>
visą turinį iš index.html nukopijuokime į naują base.html.
</p>

<p>
tuomet viską kas yra &lt;div class="container"&gt; viduje, triname ir
pakeičiame į {% block content %}{% endblock %}:
</p>

<div class="org-src-container">
<pre class="src src-html">          &lt;/<span style="color: #b8bb26;">ul</span>&gt;
        &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
&lt;/<span style="color: #b8bb26;">nav</span>&gt;

<span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">Page Content</span><span style="color: #928374;"> --&gt;</span>

&lt;<span style="color: #b8bb26;">body</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"container"</span>&gt;
        {% block content %}
        {% endblock %}
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
&lt;/<span style="color: #b8bb26;">body</span>&gt;


<span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">Bootstrap core JavaScript</span><span style="color: #928374;"> --&gt;</span>
&lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://code.jquery.com/jquery-3.3.1.slim.min.js"</span>
    <span style="color: #83a598;">integrity</span>=<span style="color: #b8bb26;">"sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"</span>
    <span style="color: #83a598;">crossorigin</span>=<span style="color: #b8bb26;">"anonymous"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
</pre>
</div>

<p>
Išsaugokime base.html.
</p>

<p>
index.html pertvarkykime taip:
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Straipsniai</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
&lt;<span style="color: #b8bb26;">br</span>&gt;
{% for straipsnis in data %}
{% if straipsnis['status'] == 'published' %}
&lt;<span style="color: #b8bb26;">h3</span>&gt;<span style="font-style: italic; text-decoration: underline;">{{ straipsnis['pavadinimas'] }}</span>&lt;/<span style="color: #b8bb26;">h3</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['data'] }}, &lt;<span style="color: #b8bb26;">i</span>&gt;<span style="font-style: italic;">{{ straipsnis['autorius'] }}</span>&lt;/<span style="color: #b8bb26;">i</span>&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">hr</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['tekstas'] }}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">br</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;
{% else %}
&lt;<span style="color: #b8bb26;">h3</span>&gt;{{ straipsnis['pavadinimas'] }} - &lt;<span style="color: #b8bb26;">i</span>&gt;<span style="font-style: italic;">Publikavimas laikinai i&#353;jungtas</span>&lt;/<span style="color: #b8bb26;">i</span>&gt;&lt;/<span style="color: #b8bb26;">h3</span>&gt;
&lt;<span style="color: #b8bb26;">br</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;
{% endif %}
{% endfor %}

{% endblock %}
</pre>
</div>


<p>
papildykime savo app.py nauju maršrutu:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'/about'</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">about</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'about.html'</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
base.html susiraskime navigacijoje nuorodą 'About', ir nukreipkime į
savo naująjį maršrutą:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #b8bb26;">li</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-item"</span>&gt;
    &lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"nav-link"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"/about"</span>&gt;About&lt;/<span style="color: #b8bb26;">a</span>&gt;
&lt;/<span style="color: #b8bb26;">li</span>&gt;
susikurkime dar vien&#261; &#353;ablon&#261;, about.html:


{% extends "base.html" %}

{% block content %}

&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Apie</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;&#352;iame puslapyje rasite labai daug naudingos informacijos apie beveik visk&#261;&lt;/<span style="color: #b8bb26;">p</span>&gt;

{% endblock %}
</pre>
</div>

<p>
Svetainėje, paspaudę nuorodą atsidursime puslapyje "Apie":
</p>


<div id="org503bf43" class="figure">
<p><img src="./static/images/flask1_7.png" alt="flask1_7.png" width="600px" />
</p>
</div>

<p>
<a href="https://github.com/CodeAcademy-Online/Python/tree/lesson-14">result here</a>.
</p>
</div>
</div>
</div>

<div id="outline-container-org2e0c903" class="outline-2">
<h2 id="org2e0c903"><span class="section-number-2">3.</span> Flask 2 dalis</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org52621a0" class="outline-3">
<h3 id="org52621a0"><span class="section-number-3">3.1.</span> Dinaminiai maršrutai ir formos</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-orgb6b4531" class="outline-4">
<h4 id="orgb6b4531"><span class="section-number-4">3.1.1.</span> Dinaminiai maršrutai</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
Tęskime su praeitos paskaitos medžiaga. Įsivaizduokime, kad mums
reikės straipsnių sąrašo, su dalimi teksto, ir po kiekvienu sąrašo
elementu nuorodos 'skaityti toliau&#x2026;'. Tokiose situacijose labai
praverčia dinaminiai maršrutai. Susikurkime naują maršrutą app.py:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'/&lt;string:title&gt;'</span><span style="color: #fe8019;">)</span> <span style="color: #928374;"># </span><span style="color: #928374;">parametruose nurodomas kintamasis (title) ir jo tipas (string)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">article</span><span style="color: #fe8019;">(</span>title<span style="color: #fe8019;">)</span>: <span style="color: #928374;"># </span><span style="color: #928374;">kintam1j&#303; b&#363;tinai nurodykite ir funkcijos parametruose</span>
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'article.html'</span>, title=title, data=data<span style="color: #fe8019;">)</span> <span style="color: #928374;"># </span><span style="color: #928374;">taip pat ir &#269;ia reikia j&#303; perduoti</span>
</pre>
</div>

<p>
dabar pakoreguokime mūsų index.html:
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Straipsniai</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
&lt;<span style="color: #b8bb26;">br</span>&gt;
{% for straipsnis in data %}
&lt;<span style="color: #b8bb26;">h3</span>&gt;<span style="font-style: italic; text-decoration: underline;">{{ straipsnis['pavadinimas'] }}</span>&lt;/<span style="color: #b8bb26;">h3</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['data'] }}, &lt;<span style="color: #b8bb26;">i</span>&gt;<span style="font-style: italic;">{{ straipsnis['autorius'] }}</span>&lt;/<span style="color: #b8bb26;">i</span>&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">hr</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['tekstas'][:30] }}&lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"{{ url_for('article', title=straipsnis['pavadinimas']) }}"</span>&gt;...skaityti toliau&lt;/<span style="color: #b8bb26;">a</span>&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">br</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;
{% endfor %}

{% endblock %}
</pre>
</div>

<p>
panagrinėkime &lt;p&gt; bloką.
</p>

<ul class="org-ul">
<li>{{ straipsnis['tekstas'][:30] }} - vietoje pilno teksto pasiliekame
ištrauką pirmų 30ties simbolių</li>

<li>nuorodoje naudojama url_for() yra pagalbinė Jinja funkcija. Į
parametrus priima maršruto funkcijos pavadinimą. Paprastesniu
atveju, url_for('about') nukreiptų į mūsų 'Apie' puslapį.</li>

<li>{{ url_for('article', title=straipsnis['pavadinimas']) }} - šiuo
atveju mes nurodėme, kad norime į 'article' ir kad jo parametruose
esantis title būtų prilygintas straipsnio pavadinimui.</li>
</ul>

<p>
Mūsų straipsnių puslapis dabar atrodo taip:
</p>


<div id="org92f53fc" class="figure">
<p><img src="./static/images/flask2_1.png" alt="flask2_1.png" width="300px" />
</p>
</div>

<p>
Susikurkime tuščią article.html ir pažiūrėkime, kas vyksta:
</p>

<p>
article.html tuščias, todėl nėra jokio turinio. Tačiau URL eilutėje
matome, kad puslaio endpoint'as yra straipsnio pavadinimas. Padarykime
taip, kad matytumėm straipsnio turinį
</p>

<p>
article.html:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fe8019;">{</span>% extends <span style="color: #b8bb26;">"base.html"</span> %<span style="color: #fe8019;">}</span>

<span style="color: #fe8019;">{</span>% block content %<span style="color: #fe8019;">}</span>

<span style="color: #fe8019;">{</span>% <span style="color: #fb4934;">for</span> straipsnis <span style="color: #fb4934;">in</span> data %<span style="color: #fe8019;">}</span>
<span style="color: #fe8019;">{</span>% <span style="color: #fb4934;">if</span> straipsnis<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">'pavadinimas'</span><span style="color: #cc241d;">]</span> == title %<span style="color: #fe8019;">}</span>

&lt;h1&gt;<span style="color: #fe8019;">{</span><span style="color: #cc241d;">{</span> straipsnis<span style="color: #b8bb26;">[</span><span style="color: #b8bb26;">'pavadinimas'</span><span style="color: #b8bb26;">]</span> <span style="color: #cc241d;">}</span><span style="color: #fe8019;">}</span>&lt;/h1&gt;
&lt;p&gt;<span style="color: #fe8019;">{</span><span style="color: #cc241d;">{</span> straipsnis<span style="color: #b8bb26;">[</span><span style="color: #b8bb26;">'data'</span><span style="color: #b8bb26;">]</span> <span style="color: #cc241d;">}</span><span style="color: #fe8019;">}</span>, &lt;i&gt;<span style="color: #fe8019;">{</span><span style="color: #cc241d;">{</span> straipsnis<span style="color: #b8bb26;">[</span><span style="color: #b8bb26;">'autorius'</span><span style="color: #b8bb26;">]</span> <span style="color: #cc241d;">}</span><span style="color: #fe8019;">}</span>&lt;/i&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;<span style="color: #fe8019;">{</span><span style="color: #cc241d;">{</span> straipsnis<span style="color: #b8bb26;">[</span><span style="color: #b8bb26;">'tekstas'</span><span style="color: #b8bb26;">]</span> <span style="color: #cc241d;">}</span><span style="color: #fe8019;">}</span>&lt;/p&gt;
&lt;br&gt;&lt;br&gt;

<span style="color: #fe8019;">{</span>% endif %<span style="color: #fe8019;">}</span>
<span style="color: #fe8019;">{</span>% endfor %<span style="color: #fe8019;">}</span>

<span style="color: #fe8019;">{</span>% endblock %<span style="color: #fe8019;">}</span>
</pre>
</div>

<p>
išbandykime:
</p>


<div id="orgd965e68" class="figure">
<p><img src="./static/images/flask2_2.png" alt="flask2_2.png" width="800px" />
</p>
</div>
</div>
</div>
<div id="outline-container-orgeb8264a" class="outline-4">
<h4 id="orgeb8264a"><span class="section-number-4">3.1.2.</span> Formos</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
Formas flaske galima kurti dviem būdais. Aptarsime abu. Pirmas iš jų
būtų paprastos formos iš HTML duomenų surinkimas. Tinka įvairiems
testavimams, ne kritiniams duomenims apdoroti. Veikimo principas buvo
glaustai pademonstruotas įžangos skyriuje. Žinoma, tas formas galima
privesti iki profesionalaus lygmens, tačiau reikės nemažai papildomo
darbo.
</p>

<p>
sukurkime naują maršrutą:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'/add_article'</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">add_article</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'add_article.html'</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
papildykime index.html nuoroda po straipsniais "Rašyti straipsnį"
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Straipsniai</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
&lt;<span style="color: #b8bb26;">br</span>&gt;
{% for straipsnis in data %}
&lt;<span style="color: #b8bb26;">h3</span>&gt;<span style="font-style: italic; text-decoration: underline;">{{ straipsnis['pavadinimas'] }}</span>&lt;/<span style="color: #b8bb26;">h3</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['data'] }}, &lt;<span style="color: #b8bb26;">i</span>&gt;<span style="font-style: italic;">{{ straipsnis['autorius'] }}</span>&lt;/<span style="color: #b8bb26;">i</span>&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">hr</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{ straipsnis['tekstas'][:30] }}&lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"{{ url_for('article', title=straipsnis['pavadinimas']) }}"</span>&gt;...skaityti toliau&lt;/<span style="color: #b8bb26;">a</span>&gt;&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">br</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;
{% endfor %}
&lt;<span style="color: #b8bb26;">h1</span>&gt;&lt;<span style="color: #b8bb26;">a</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"{{ url_for('add_article') }}"</span>&gt; Ra&#353;yti straipsn&#303;&lt;/<span style="color: #b8bb26;">a</span>&gt;&lt;/<span style="color: #b8bb26;">h1</span>&gt;
{% endblock %}
</pre>
</div>

<p>
sukurkime naują šabloną add_article.html:
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

&lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"/"</span>, <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span>&gt;
  &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
    &lt;<span style="color: #b8bb26;">label</span> <span style="color: #83a598;">for</span>=<span style="color: #b8bb26;">"autorius"</span>&gt;Autorius&lt;/<span style="color: #b8bb26;">label</span>&gt;
    &lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-control"</span> <span style="color: #83a598;">id</span>=<span style="color: #b8bb26;">"autorius"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"autorius"</span>&gt;
  &lt;/<span style="color: #b8bb26;">div</span>&gt;
  &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
    &lt;<span style="color: #b8bb26;">label</span> <span style="color: #83a598;">for</span>=<span style="color: #b8bb26;">"pavadinimas"</span>&gt;Pavadinimas&lt;/<span style="color: #b8bb26;">label</span>&gt;
    &lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-control"</span> <span style="color: #83a598;">id</span>=<span style="color: #b8bb26;">"pavadinimas"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"pavadinimas"</span>&gt;
  &lt;/<span style="color: #b8bb26;">div</span>&gt;
  &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
    &lt;<span style="color: #b8bb26;">label</span> <span style="color: #83a598;">for</span>=<span style="color: #b8bb26;">"date"</span>&gt;Data&lt;/<span style="color: #b8bb26;">label</span>&gt;
    &lt;<span style="color: #b8bb26;">input</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"text"</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-control"</span> <span style="color: #83a598;">id</span>=<span style="color: #b8bb26;">"date"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"date"</span>&gt;
  &lt;/<span style="color: #b8bb26;">div</span>&gt;
  &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
    &lt;<span style="color: #b8bb26;">label</span> <span style="color: #83a598;">for</span>=<span style="color: #b8bb26;">"tekstas"</span>&gt;Example textarea&lt;/<span style="color: #b8bb26;">label</span>&gt;
    &lt;<span style="color: #b8bb26;">textarea</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-control"</span> <span style="color: #83a598;">id</span>=<span style="color: #b8bb26;">"tekstas"</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"tekstas"</span> <span style="color: #83a598;">rows</span>=<span style="color: #b8bb26;">"3"</span>&gt;&lt;/<span style="color: #b8bb26;">textarea</span>&gt;
  &lt;/<span style="color: #b8bb26;">div</span>&gt;
  &lt;<span style="color: #b8bb26;">button</span> <span style="color: #83a598;">type</span>=<span style="color: #b8bb26;">"submit"</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"btn btn-primary"</span>&gt;I&#353;saugoti&lt;/<span style="color: #b8bb26;">button</span>&gt;
&lt;/<span style="color: #b8bb26;">form</span>&gt;

{% endblock %}
</pre>
</div>


<p>
užeikime į "Rašyti straipsnį" nuorodą:
</p>


<div id="org0b268f5" class="figure">
<p><img src="./static/images/flask2_3.png" alt="flask2_3.png" width="600px" />
</p>
</div>

<p>
Turime neveikiančią formą.
</p>

<p>
Prie importų iš flask pridėkime <code>request</code>. Pakoreguokime index()
funkciją:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'/'</span>, methods=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">'GET'</span>, <span style="color: #b8bb26;">'POST'</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">index</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">if</span> request.method == <span style="color: #b8bb26;">'POST'</span>:
        date = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'date'</span><span style="color: #fe8019;">]</span>
        autorius = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'autorius'</span><span style="color: #fe8019;">]</span>
        tekstas = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'tekstas'</span><span style="color: #fe8019;">]</span>
        pavadinimas = request.form<span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'pavadinimas'</span><span style="color: #fe8019;">]</span>
        data.append<span style="color: #fe8019;">(</span><span style="color: #cc241d;">{</span>
            <span style="color: #b8bb26;">'data'</span>: date,
            <span style="color: #b8bb26;">'autorius'</span>: autorius,
            <span style="color: #b8bb26;">'pavadinimas'</span>: pavadinimas,
            <span style="color: #b8bb26;">'tekstas'</span>: tekstas,
            <span style="color: #b8bb26;">'status'</span>: <span style="color: #b8bb26;">'published'</span>
        <span style="color: #cc241d;">}</span><span style="color: #fe8019;">)</span>
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'index.html'</span>, data=data<span style="color: #fe8019;">)</span>
</pre>
</div>


<p>
funkcijoje pasitikriname, ar yra 'post' užklausa, jeigu yra, tai
papildome mūsų "duomenų bazę" naujais duomenimis:
</p>


<div id="org97e8bf4" class="figure">
<p><img src="./static/images/flask2_4.png" alt="flask2_4.png" width="600px" />
</p>
</div>
</div>
</div>

<div id="outline-container-org3093888" class="outline-4">
<h4 id="org3093888"><span class="section-number-4">3.1.3.</span> flask-wtf</h4>
<div class="outline-text-4" id="text-3-1-3">
<p>
Antras būdas tvarkytis su formomis yra trečios šalies bibliotekos
<code>flask_wtf</code> naudojimas. Ji pasirūpina saugumo klausimais "out of the
box" ir yra industrijos standartas dirbant su flask. Pamėginsime
kontaktuose sukurti paprastą formą. Reikia šiek tiek pasiruošti:
</p>

<ul class="org-ul">
<li>sukurkime naują tuščią maršrutą contact_us</li>

<li>sukurkime naują tuščią šabloną tam maršrutui</li>

<li>navigacijoje aktyvuokime nuorodą į contact_us</li>

<li>sukurkime naują failą forms.py</li>

<li>įsidiekime flask-wtf biblioteką (pip install flask-wtf)</li>
</ul>

<p>
forms.py:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask_wtf <span style="color: #fb4934;">import</span> FlaskForm
<span style="color: #fb4934;">from</span> wtforms <span style="color: #fb4934;">import</span> StringField, TextAreaField, SubmitField
<span style="color: #fb4934;">from</span> wtforms.validators <span style="color: #fb4934;">import</span> DataRequired, Length, Email


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">ContactForm</span><span style="color: #fe8019;">(</span>FlaskForm<span style="color: #fe8019;">)</span>:
    <span style="color: #83a598;">name</span> = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Vardas'</span>, <span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">()</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    <span style="color: #83a598;">email</span> = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'El.pa&#353;tas'</span>, <span style="color: #cc241d;">[</span>Email<span style="color: #b8bb26;">(</span>message=<span style="color: #83a598;">(</span><span style="color: #b8bb26;">'Neteisingas adresas.'</span><span style="color: #83a598;">)</span><span style="color: #b8bb26;">)</span>, DataRequired<span style="color: #b8bb26;">()</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    body = TextAreaField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'J&#363;s&#371; prane&#353;imas'</span>, <span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">()</span>,
                                        Length<span style="color: #b8bb26;">(</span><span style="color: #fe8019;">min</span>=10,
                                        message=<span style="color: #83a598;">(</span><span style="color: #b8bb26;">'Per trumpas tekstas.'</span><span style="color: #83a598;">)</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    submit = SubmitField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Submit'</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
Šį kartą mūsų forma aprašoma, kaip klasė. Visus laukų tipus ir
validatorius (patvirtintojus?..) reikia importuotis atskirai. Pvz.:
eilutę priskirtą kintamąjam body galima dekonstruoti taip:
</p>

<p>
TextAreaField - nurodome, kokio tipo formos lauką generuoti.
</p>

<p>
'Jūsų pranešimas' - formos lauko pavadinimas (label).
</p>

<p>
[DataRequired(), Length(min=10, message=('Per trumpas tekstas.'))]) -
sąraše yra validators - Nurodome kad laukas būtinas užpildyti, kad
minimum 10 simbolių, ir kokia klaidos žinutė.
</p>

<p>
Kokie yra galimi laukai, galima pažiūrėti <a href="https://wtforms.readthedocs.io/en/stable/fields/">čia</a>. Kokie yra galimi
validators, galima pažiūrėti <a href="https://wtforms.readthedocs.io/en/stable/validators/">čia</a>.
</p>

<p>
pakoreguokime maršrutą:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'/contact_us'</span>, methods=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">'GET'</span>, <span style="color: #b8bb26;">'POST'</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">contact_us</span><span style="color: #fe8019;">()</span>:
    form = ContactForm<span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">if</span> form.validate_on_submit<span style="color: #fe8019;">()</span>:
        <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'contact_success.html'</span>, form=form<span style="color: #fe8019;">)</span>
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'contact_us.html'</span>, form=form<span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
Pakoregavome contact_us maršrutą taip, kad jeigu forma sėkmingai
praėjo validaciją, nukreiptų mus į sėkmės puslapį.
</p>

<p>
pasidarykime šablonus - contact_us.html:
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

  &lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"{{ url_for('contact_success') }}"</span>&gt;
      {{ form.hidden_tag() }}
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
      {{ form.name.label(class="form-control-label") }}
      {{ form.name(class="form-control") }}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
      {{ form.email.label(class="form-control-label") }}
      {{ form.email(class="form-control") }}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
      {{ form.body.label(class="form-control-label") }}
      {{ form.body(class="form-control", <span style="color: #83a598;">rows</span>="5") }}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      {{ form.submit }}
  &lt;/<span style="color: #b8bb26;">form</span>&gt;
{% endblock %}
</pre>
</div>

<p>
reikėtų atkreipti dėmesį, kad Bootstrap klasės rašomos į kintamųjų
parametrus
</p>

<p>
ir sėkmės puslapiui - contact_success.html
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Forma u&#382;pildyta s&#279;kmingai!</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;Vardas: {{form.name.data}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;El. pa&#353;tas: {{form.email.data}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;Tekstas:&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{form.body.data}}&lt;/<span style="color: #b8bb26;">p</span>&gt;

{% endblock %}
</pre>
</div>

<p>
kadangi apie duomenų bazes kalbėsime sekančioje paskaitoje, su šiuo
labai nesistengėme, išgaudysime formos reikšmes į pliką HTML.
</p>


<div id="orgf8585e0" class="figure">
<p><img src="./static/images/flask2_5.png" alt="flask2_5.png" width="600px" />
</p>
</div>

<p>
paspaudus 'Submit' mygtuką, mes niekur nenukreipiami, nes forma
nepraėjo validacijos filtrų. Būtų gerai, jeigu mus informuotų, kas
atsitiko. Reikia koreguoti formos šabloną:
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}

{% block content %}

  &lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"#"</span>&gt;
      {{ form.csrf_token }}
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
      {{ form.name.label(class="form-control-label") }}
      {{ form.name(class="form-control") }}
      {% if form.name.errors %}
        {% for error in form.name.errors %}
          &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
        {% endfor %}
      {% endif %}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
      {{ form.email.label(class="form-control-label") }}
      {{ form.email(class="form-control") }}
      {% if form.email.errors %}
        {% for error in form.email.errors %}
          &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
        {% endfor %}
      {% endif %}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
      {{ form.body.label(class="form-control-label") }}
      {{ form.body(class="form-control", <span style="color: #83a598;">rows</span>="5") }}
      {% if form.body.errors %}
        {% for error in form.body.errors %}
          &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
        {% endfor %}
      {% endif %}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      {{ form.submit }}
  &lt;/<span style="color: #b8bb26;">form</span>&gt;

{% endblock %}
</pre>
</div>

<p>
Atrodo painiai :) Tai tik po kiekvienu lauku nurodyta sąlyga, kad
jeigu tam laukui yra kažkokios klaidos, praiteruojame jas, ir
parašome, kas tai per klaida:
</p>


<div id="org8f2d4ab" class="figure">
<p><img src="./static/images/flask2_6.png" alt="flask2_6.png" width="600px" />
</p>
</div>

<p>
Na ir pagaliau pabandykime teisingai suvesti:
</p>


<div id="org3111eaf" class="figure">
<p><img src="./static/images/flask2_7.png" alt="flask2_7.png" width="600px" />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc4c649a" class="outline-3">
<h3 id="orgc4c649a"><span class="section-number-3">3.2.</span> Uzduotis</h3>
<div class="outline-text-3" id="text-3-2">
</div>
<div id="outline-container-org5eccf17" class="outline-4">
<h4 id="org5eccf17"><span class="section-number-4">3.2.1.</span> app.py</h4>
<div class="outline-text-4" id="text-3-2-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask, render_template, request, redirect, url_for, flash
<span style="color: #fb4934;">from</span> form <span style="color: #fb4934;">import</span> ContactForm


<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>
app.<span style="color: #83a598;">config</span><span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'SECRET_KEY'</span><span style="color: #fe8019;">]</span> = <span style="color: #b8bb26;">'bet kokia simboli&#371; eilut&#279;'</span>

<span style="color: #fabd2f;">@app.route</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'/'</span>, methods=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">'GET'</span>, <span style="color: #b8bb26;">'POST'</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">form</span><span style="color: #fe8019;">()</span>:
    form = ContactForm<span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">if</span> form.validate_on_submit<span style="color: #fe8019;">()</span>:
        <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'success.html'</span>, form=form<span style="color: #fe8019;">)</span>
    <span style="color: #fb4934;">return</span> render_template<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'form.html'</span>, form=form<span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">'__main__'</span>:
  app.run<span style="color: #fe8019;">(</span>host=<span style="color: #b8bb26;">'127.0.0.1'</span>, port=8000, debug=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgaeaa603" class="outline-4">
<h4 id="orgaeaa603"><span class="section-number-4">3.2.2.</span> form.py</h4>
<div class="outline-text-4" id="text-3-2-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> flask_wtf <span style="color: #fb4934;">import</span> FlaskForm
<span style="color: #fb4934;">from</span> wtforms <span style="color: #fb4934;">import</span> StringField, PasswordField, SelectField, SubmitField, BooleanField
<span style="color: #fb4934;">from</span> wtforms.validators <span style="color: #fb4934;">import</span> DataRequired, Length, Email, InputRequired


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">ContactForm</span><span style="color: #fe8019;">(</span>FlaskForm<span style="color: #fe8019;">)</span>:

    <span style="color: #83a598;">email</span> = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Vardas'</span>, <span style="color: #cc241d;">[</span>Email<span style="color: #b8bb26;">(</span>message=<span style="color: #83a598;">(</span><span style="color: #b8bb26;">'Neteisingas adresas.'</span><span style="color: #83a598;">)</span><span style="color: #b8bb26;">)</span>, DataRequired<span style="color: #b8bb26;">(</span>message=<span style="color: #b8bb26;">'Lauk&#261; b&#363;tina u&#382;pildyti'</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    password = PasswordField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Slapta&#382;odis'</span>, validators=<span style="color: #cc241d;">[</span>Length<span style="color: #b8bb26;">(</span><span style="color: #fe8019;">min</span>=8, message=<span style="color: #83a598;">(</span><span style="color: #b8bb26;">'Per ma&#382;ai simboli&#371;!'</span><span style="color: #83a598;">)</span><span style="color: #b8bb26;">)</span>, DataRequired<span style="color: #b8bb26;">(</span>message=<span style="color: #b8bb26;">'Lauk&#261; b&#363;tina u&#382;pildyti'</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    address1 = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Adresas (pirma eilut&#279;)'</span>, validators=<span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">(</span>message=<span style="color: #83a598;">(</span><span style="color: #b8bb26;">'Lauk&#261; b&#363;tina u&#382;pildyti'</span><span style="color: #83a598;">)</span><span style="color: #b8bb26;">)</span>, Length<span style="color: #b8bb26;">(</span><span style="color: #fe8019;">min</span>=4, message=<span style="color: #83a598;">(</span><span style="color: #b8bb26;">'Per ma&#382;ai simboli&#371;!'</span><span style="color: #83a598;">)</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    address2 = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Adresas (antra eilut&#279;)'</span>, validators=<span style="color: #cc241d;">[</span>Length<span style="color: #b8bb26;">(</span><span style="color: #fe8019;">min</span>=4, message=<span style="color: #83a598;">(</span><span style="color: #b8bb26;">'Per ma&#382;ai simboli&#371;'</span><span style="color: #83a598;">)</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    city = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Miestas'</span>, validators=<span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">(</span>message=<span style="color: #b8bb26;">'Lauk&#261; b&#363;tina u&#382;pildyti'</span><span style="color: #b8bb26;">)</span>, Length<span style="color: #b8bb26;">(</span><span style="color: #fe8019;">min</span>=4, message=<span style="color: #83a598;">(</span><span style="color: #b8bb26;">'Per ma&#382;ai simboli&#371;'</span><span style="color: #83a598;">)</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    state = SelectField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Rajonas'</span>, choices=<span style="color: #cc241d;">[</span><span style="color: #b8bb26;">(</span><span style="color: #b8bb26;">'vln'</span>, <span style="color: #b8bb26;">'Vilniaus'</span><span style="color: #b8bb26;">)</span>, <span style="color: #b8bb26;">(</span><span style="color: #b8bb26;">'kns'</span>, <span style="color: #b8bb26;">'Kauno'</span><span style="color: #b8bb26;">)</span>, <span style="color: #b8bb26;">(</span><span style="color: #b8bb26;">'klp'</span>, <span style="color: #b8bb26;">'Klaip&#279;dos'</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">]</span>, validators=<span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">(</span>message=<span style="color: #b8bb26;">'Lauk&#261; b&#363;tina u&#382;pildyti'</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    zip_code = StringField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Pa&#353;to kodas'</span>, validators=<span style="color: #cc241d;">[</span>DataRequired<span style="color: #b8bb26;">(</span>message=<span style="color: #b8bb26;">'Lauk&#261; b&#363;tina u&#382;pildyti'</span><span style="color: #b8bb26;">)</span>, Length<span style="color: #b8bb26;">(</span><span style="color: #fe8019;">min</span>=4, message=<span style="color: #83a598;">(</span><span style="color: #b8bb26;">'Per ma&#382;ai simboli&#371;'</span><span style="color: #83a598;">)</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
    agree = BooleanField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Sutinku gauti &#353;lam&#353;t&#261;'</span><span style="color: #fe8019;">)</span>
    submit = SubmitField<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Submit'</span><span style="color: #fe8019;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfb4dcff" class="outline-4">
<h4 id="orgfb4dcff"><span class="section-number-4">3.2.3.</span> templates/base.html</h4>
<div class="outline-text-4" id="text-3-2-3">
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #fb4934;">!doctype</span> html&gt;
&lt;<span style="color: #b8bb26;">html</span> <span style="color: #83a598;">lang</span>=<span style="color: #b8bb26;">"en"</span>&gt;
  &lt;<span style="color: #b8bb26;">head</span>&gt;
    <span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">Required meta tags</span><span style="color: #928374;"> --&gt;</span>
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">charset</span>=<span style="color: #b8bb26;">"utf-8"</span>&gt;
    &lt;<span style="color: #b8bb26;">meta</span> <span style="color: #83a598;">name</span>=<span style="color: #b8bb26;">"viewport"</span> <span style="color: #83a598;">content</span>=<span style="color: #b8bb26;">"width=device-width, initial-scale=1, shrink-to-fit=no"</span>&gt;

    <span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">Bootstrap CSS</span><span style="color: #928374;"> --&gt;</span>
    &lt;<span style="color: #b8bb26;">link</span> <span style="color: #83a598;">rel</span>=<span style="color: #b8bb26;">"stylesheet"</span> <span style="color: #83a598;">href</span>=<span style="color: #b8bb26;">"https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"</span> <span style="color: #83a598;">integrity</span>=<span style="color: #b8bb26;">"sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"</span> <span style="color: #83a598;">crossorigin</span>=<span style="color: #b8bb26;">"anonymous"</span>&gt;

    &lt;<span style="color: #b8bb26;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Superform</span>&lt;/<span style="color: #b8bb26;">title</span>&gt;
  &lt;/<span style="color: #b8bb26;">head</span>&gt;
  &lt;<span style="color: #b8bb26;">body</span>&gt;
    &lt;<span style="color: #b8bb26;">br</span>&gt;
        &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"container"</span>&gt;
            {% block content %}
            {% endblock %}
        &lt;/<span style="color: #b8bb26;">div</span>&gt;

    <span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">Optional JavaScript</span><span style="color: #928374;"> --&gt;</span>
    <span style="color: #928374;">&lt;!-- </span><span style="color: #928374;">jQuery first, then Popper.js, then Bootstrap JS</span><span style="color: #928374;"> --&gt;</span>
    &lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://code.jquery.com/jquery-3.4.1.slim.min.js"</span> <span style="color: #83a598;">integrity</span>=<span style="color: #b8bb26;">"sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"</span> <span style="color: #83a598;">crossorigin</span>=<span style="color: #b8bb26;">"anonymous"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
    &lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"</span> <span style="color: #83a598;">integrity</span>=<span style="color: #b8bb26;">"sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"</span> <span style="color: #83a598;">crossorigin</span>=<span style="color: #b8bb26;">"anonymous"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
    &lt;<span style="color: #b8bb26;">script</span> <span style="color: #83a598;">src</span>=<span style="color: #b8bb26;">"https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"</span> <span style="color: #83a598;">integrity</span>=<span style="color: #b8bb26;">"sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"</span> <span style="color: #83a598;">crossorigin</span>=<span style="color: #b8bb26;">"anonymous"</span>&gt;&lt;/<span style="color: #b8bb26;">script</span>&gt;
  &lt;/<span style="color: #b8bb26;">body</span>&gt;
&lt;/<span style="color: #b8bb26;">html</span>&gt;
</pre>
</div>
</div>
</div>
<div id="outline-container-org44caffa" class="outline-4">
<h4 id="org44caffa"><span class="section-number-4">3.2.4.</span> templates/form.html</h4>
<div class="outline-text-4" id="text-3-2-4">
<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}
{% block content %}

&lt;<span style="color: #b8bb26;">form</span> <span style="color: #83a598;">method</span>=<span style="color: #b8bb26;">"post"</span> <span style="color: #83a598;">action</span>=<span style="color: #b8bb26;">"#"</span>&gt;
    {{ form.csrf_token }}
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-row"</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group col-md-6"</span>&gt;
        {{ form.email.label(class="form-control-label") }}
        {{ form.email(class="form-control") }}
        {% if form.email.errors %}
        {% for error in form.email.errors %}
          &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
        {% endfor %}
        {% endif %}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group col-md-6"</span>&gt;
        {{ form.password.label(class="form-control-label") }}
        {{ form.password(class="form-control") }}
        {% if form.password.errors %}
        {% for error in form.password.errors %}
          &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
        {% endfor %}
        {% endif %}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
        {{ form.address1.label(class="form-control-label") }}
        {{ form.address1(class="form-control") }}
        {% if form.address1.errors %}
        {% for error in form.address1.errors %}
          &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
        {% endfor %}
        {% endif %}
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group"</span>&gt;
        {{ form.address2.label(class="form-control-label") }}
        {{ form.address2(class="form-control") }}
        {% if form.address2.errors %}
        {% for error in form.address2.errors %}
          &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
        {% endfor %}
        {% endif %}
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-row"</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group col-md-6"</span>&gt;
            {{ form.city.label(class="form-control-label") }}
            {{ form.city(class="form-control") }}
            {% if form.city.errors %}
            {% for error in form.city.errors %}
                &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
            {% endfor %}
            {% endif %}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group col-md-4"</span>&gt;
            {{ form.state.label(class="form-control-label") }}
            {{ form.state(class="form-control") }}
            {% if form.state.errors %}
            {% for error in form.state.errors %}
                &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
            {% endfor %}
            {% endif %}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
      &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-group col-md-2"</span>&gt;
            {{ form.zip_code.label(class="form-control-label") }}
            {{ form.zip_code(class="form-control") }}
            {% if form.zip_code.errors %}
            {% for error in form.zip_code.errors %}
                &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
            {% endfor %}
            {% endif %}
      &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;<span style="color: #b8bb26;">div</span> <span style="color: #83a598;">class</span>=<span style="color: #b8bb26;">"form-check"</span>&gt;
            {{ form.agree(class="form-check-input") }}
            {{ form.agree.label(class="form-check-label") }}
            {% if form.agree.errors %}
            {% for error in form.agree.errors %}
                &lt;<span style="color: #b8bb26;">small</span>&gt;&lt;<span style="color: #b8bb26;">font</span> <span style="color: #83a598;">color</span>=<span style="color: #b8bb26;">"red"</span>&gt;{{ error }}&lt;/<span style="color: #b8bb26;">font</span>&gt;&lt;/<span style="color: #b8bb26;">small</span>&gt;
            {% endfor %}
            {% endif %}
    &lt;/<span style="color: #b8bb26;">div</span>&gt;
    &lt;<span style="color: #b8bb26;">br</span>&gt;
    {{ form.submit }}
  &lt;/<span style="color: #b8bb26;">form</span>&gt;

{% endblock %}
</pre>
</div>
</div>
</div>
<div id="outline-container-org1ac0cce" class="outline-4">
<h4 id="org1ac0cce"><span class="section-number-4">3.2.5.</span> templates/success.html</h4>
<div class="outline-text-4" id="text-3-2-5">
<div class="org-src-container">
<pre class="src src-html">{% extends "base.html" %}
{% block content %}

&lt;<span style="color: #b8bb26;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Forma u&#382;pildyta s&#279;kmingai!</span>&lt;/<span style="color: #b8bb26;">h1</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;&lt;<span style="color: #b8bb26;">br</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;Email: {{form.email.data}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;Password: {{form.password.data}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;Adresas:&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{form.address1.data}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{form.address2.data}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{form.zip_code.data}} {{form.city.data}}&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{form.state.data}} raj.&lt;/<span style="color: #b8bb26;">p</span>&gt;
&lt;<span style="color: #b8bb26;">p</span>&gt;{{form.agree.data}}&lt;/<span style="color: #b8bb26;">p</span>&gt;

{% endblock %}
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgc8ded4c" class="outline-2">
<h2 id="orgc8ded4c"><span class="section-number-2">4.</span> Flask 3 dalis</h2>
<div class="outline-text-2" id="text-4">
<p>
once again, do pip install flask-sqlalchemy==2.5.1
</p>

<p>
we will use this, not the current +3 version for some of the projects
listed below to work.
</p>
</div>

<div id="outline-container-org0f74cbb" class="outline-3">
<h3 id="org0f74cbb"><span class="section-number-3">4.1.</span> Duomenų bazės sukūrimas</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Flask leidžia mums dirbti su duomenų bazėmis, praktiškai nesitepant
rankų su SQL užklausomis. Viskuo pasirūpina modulis Flask-SQLAlchemy.
Iš principo tai yra SQLAlchemy, optimizuota Flask'ui. Ją galima
įdiegti naudojant pip install Flask-SQLAlchemy komandą.
</p>

<p>
Susikurkime pirmą duomenų bazę:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">import</span> os
<span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask
<span style="color: #fb4934;">from</span> flask_sqlalchemy <span style="color: #fb4934;">import</span> SQLAlchemy

<span style="color: #83a598;">basedir</span> = os.path.abspath<span style="color: #fe8019;">(</span>os.path.dirname<span style="color: #cc241d;">(</span>__file__<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">pilnas kelias iki &#353;io failo.</span>
<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>
app.app_context<span style="color: #fe8019;">()</span>.push<span style="color: #fe8019;">()</span>

app.<span style="color: #83a598;">config</span><span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'SQLALCHEMY_DATABASE_URI'</span><span style="color: #fe8019;">]</span> = <span style="color: #b8bb26;">'sqlite:///'</span>+os.path.join<span style="color: #fe8019;">(</span>basedir, <span style="color: #b8bb26;">'data.sqlite'</span><span style="color: #fe8019;">)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">nustat&#279;me, kad m&#363;s&#371; duomen&#371; baz&#279; bus &#353;alia &#353;io failo esants data.sqlite failas</span>
app.<span style="color: #83a598;">config</span><span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'SQLALCHEMY_TRACK_MODIFICATIONS'</span><span style="color: #fe8019;">]</span> = <span style="color: #d3869b;">False</span>
<span style="color: #928374;"># </span><span style="color: #928374;">neseksime kiekvienos modifikacijos</span>
<span style="color: #83a598;">db</span> = SQLAlchemy<span style="color: #fe8019;">(</span>app<span style="color: #fe8019;">)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">sukuriame duomen&#371; baz&#279;s objekt&#261;</span>
<span style="color: #928374;"># </span><span style="color: #928374;">sukurkime model&#303; u&#382;klausos formai, kuris sukurs duomen&#371; baz&#279;je lentel&#281;</span>


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Message</span><span style="color: #fe8019;">(</span>db.Model<span style="color: #fe8019;">)</span>:
    <span style="color: #928374;"># </span><span style="color: #928374;">DB lentelei priskiria pavadinim&#261;, jei nenurodysite, priskirs automati&#353;kai pagal klas&#279;s pavadinim&#261;.</span>
    <span style="color: #83a598;">__tablename__</span> = <span style="color: #b8bb26;">'messages'</span>
    <span style="color: #fe8019;">id</span> = db.Column<span style="color: #fe8019;">(</span>db.Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>  <span style="color: #928374;"># </span><span style="color: #928374;">stulpelis, kurio reik&#353;m&#279;s integer. Taip pat jis bus primary_key.</span>
    name = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>80<span style="color: #cc241d;">)</span>, nullable=<span style="color: #d3869b;">False</span><span style="color: #fe8019;">)</span>
    email = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>120<span style="color: #cc241d;">)</span>, unique=<span style="color: #d3869b;">True</span>, nullable=<span style="color: #d3869b;">False</span><span style="color: #fe8019;">)</span>
    message = db.Column<span style="color: #fe8019;">(</span>db.Text, nullable=<span style="color: #d3869b;">False</span><span style="color: #fe8019;">)</span>

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__init__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, name, email, message<span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">self</span>.name = name
        <span style="color: #fb4934;">self</span>.email = email
        <span style="color: #fb4934;">self</span>.message = message

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">'</span>{<span style="color: #fb4934;">self</span>.name}<span style="color: #b8bb26;"> - </span>{<span style="color: #fb4934;">self</span>.email}<span style="color: #b8bb26;">'</span>
</pre>
</div>

<p>
class Message yra aprašyta mūsų duomenų bazės lentelė. Paleidus šį
failą, duomenų bazė nesusikurs, reikia inicijuoti šį veiksmą iš išorės
(per konsolę arba kitą Python script'ą). Susikurkime dar vieną Python
failą:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> app <span style="color: #fb4934;">import</span> db, Message

db.create_all<span style="color: #fe8019;">()</span>  <span style="color: #928374;"># </span><span style="color: #928374;">sukurs m&#363;s&#371; lentel&#281; DB</span>

<span style="color: #928374;"># </span><span style="color: #928374;">I&#353; karto inicijuosime testams kelet&#261; &#303;ra&#353;&#371;:</span>
jonas = Message<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Jonas'</span>, <span style="color: #b8bb26;">'jonas@mail.com'</span>, <span style="color: #b8bb26;">'Ka&#382;koks labai rimtas atsiliepimas.'</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">antanas</span> = Message<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Antanas'</span>, <span style="color: #b8bb26;">'antanas@mail.lt'</span>, <span style="color: #b8bb26;">'Antano nuomon&#279; labai svarbi.'</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">juozas</span> = Message<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Juozas'</span>, <span style="color: #b8bb26;">'juozukas@friends.lt'</span>, <span style="color: #b8bb26;">'A&#353; labai piktas, nes blogai.'</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">bronius</span> = Message<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Bronius'</span>, <span style="color: #b8bb26;">'bronka@yahoo.com'</span>, <span style="color: #b8bb26;">'A&#353; tai linksmas esu, man patinka.'</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">Prid&#279;sime &#353;iuos veik&#279;jus &#303; m&#363;s&#371; DB</span>
db.session.add_all<span style="color: #fe8019;">(</span><span style="color: #cc241d;">[</span>jonas, antanas, juozas, bronius<span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">.commit i&#353;saugo pakeitimus</span>
db.session.commit<span style="color: #fe8019;">()</span>

<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>jonas.<span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>antanas.<span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>bronius.<span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>juozas.<span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">1</span>
<span style="color: #928374;"># </span><span style="color: #928374;">2</span>
<span style="color: #928374;"># </span><span style="color: #928374;">4</span>
<span style="color: #928374;"># </span><span style="color: #928374;">3</span>
</pre>
</div>

<p>
.create_all() įrašė lentelę į DB, inicijuoti testiniai duomenys taip
pat sėkmingai nukeliavo į lentelę, atsispausdinome jų ID, kurie buvo
sugeneruoti automatiškai.
</p>
</div>

<div id="outline-container-orgc80e367" class="outline-4">
<h4 id="orgc80e367"><span class="section-number-4">4.1.1.</span> Paprastos CRUD operacijos</h4>
<div class="outline-text-4" id="text-4-1-1">
<p>
Susikurkime dar vieną failą, crud operacijų demonstracijai.
Atsispausdinkime visus lentelėje esančius objektus:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> app <span style="color: #fb4934;">import</span> db, Message

<span style="color: #83a598;">all_messages</span> = Message.query.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>all_messages<span style="color: #fe8019;">)</span>

<span style="color: #928374;">#  </span><span style="color: #928374;">[Jonas - jonas@mail.com, Antanas - antanas@mail.lt, Juozas - juozukas@friends.lt, Bronius - bronka@yahoo.com]</span>
</pre>
</div>

<p>
Atsispausdinkime vieną iš objektų:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">message_1</span> = Message.query.get<span style="color: #fe8019;">(</span>1<span style="color: #fe8019;">)</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>message_1<span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">Jonas - jonas@mail.com</span>
</pre>
</div>


<p>
Išfiltruokime objektą pagal nurodytą požymį:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">message_antanas</span> = Message.query.filter_by<span style="color: #fe8019;">(</span>name=<span style="color: #b8bb26;">'Antanas'</span><span style="color: #fe8019;">)</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>message_antanas.<span style="color: #fe8019;">all</span><span style="color: #cc241d;">()</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">[Antanas - antanas@mail.lt]</span>
</pre>
</div>

<p>
filter_by išrinks mums visus įrašus, kuriuose name='Antanas'
</p>

<p>
Pakeiskime Antano el. paštą:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">antanas</span> = Message.query.get<span style="color: #fe8019;">(</span>2<span style="color: #fe8019;">)</span>
antanas.<span style="color: #83a598;">email</span> = <span style="color: #b8bb26;">'geras.zmogus@lrs.lt'</span>
db.session.add<span style="color: #fe8019;">(</span>antanas<span style="color: #fe8019;">)</span>
db.session.commit<span style="color: #fe8019;">()</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>Message.query.<span style="color: #fe8019;">all</span><span style="color: #cc241d;">()</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">[Jonas - jonas@mail.com, Antanas - geras.zmogus@lrs.lt, Juozas - juozukas@friends.lt, Bronius - bronka@yahoo.com]</span>
</pre>
</div>

<p>
Ištrinkime Joną:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">jonas</span> = Message.query.get<span style="color: #fe8019;">(</span>1<span style="color: #fe8019;">)</span>
db.session.delete<span style="color: #fe8019;">(</span>jonas<span style="color: #fe8019;">)</span>
db.session.commit<span style="color: #fe8019;">()</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>Message.query.<span style="color: #fe8019;">all</span><span style="color: #cc241d;">()</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">[Antanas - geras.zmogus@lrs.lt, Juozas - juozukas@friends.lt, Bronius - bronka@yahoo.com]</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0f7d951" class="outline-3">
<h3 id="org0f7d951"><span class="section-number-3">4.2.</span> Duomenų bazės migracija</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Jeigu mums prireiktų papildyti savo lentelę papildomu stulpeliu,
tiesiog papildžius klasę Message nauja eilute mums nepavyktų, kadangi
duomenų bazė jau inicijuota tokia, kokią nurodėme pirmą kartą. Tą
reikia turėti omenyje, kas kartą, kuriant duomenų bazę stengtis
pasidaryti ją kuo išbaigtesnę. Tuomet ateityje, norint ją papildyti
naujais stulpeliais, ar pakeisti esamų nustatymus, reikės mažiau
migracijos procesų. Susitvarkykime savo projektą taip, kad galėtumėm
vykdyti migracijas:
</p>

<p>
nustatykime FLASK-APP aplinkos kintamąjį (environment variable). Tą
reikės padaryti Windows komandinėje eilutėje, arba Linux/MacOS
terminale:
</p>

<p>
<b>windows</b> - set FLASK_APP=failas_kuriame_musu_db_modelis.py
</p>

<p>
<b>linux/macOS</b> - <code>export FLASK_APP=failas_kuriame_musu_db_modelis.py</code>
</p>

<p>
įsitikinkite, kad komandą leidžiate iš to paties katalogo, kuriame
failas su jūsų DB modeliu.
</p>

<p>
įdiekime Flask-Migrate paketą (pip install Flask-Migrate)
</p>

<p>
pertvarkykime savo .py failą:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">import</span> os
<span style="color: #fb4934;">from</span> flask <span style="color: #fb4934;">import</span> Flask
<span style="color: #fb4934;">from</span> flask_sqlalchemy <span style="color: #fb4934;">import</span> SQLAlchemy
<span style="color: #fb4934;">from</span> flask_migrate <span style="color: #fb4934;">import</span> Migrate  <span style="color: #928374;"># </span><span style="color: #928374;">importuojame migracijas</span>

<span style="color: #83a598;">basedir</span> = os.path.abspath<span style="color: #fe8019;">(</span>os.path.dirname<span style="color: #cc241d;">(</span>__file__<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">app</span> = Flask<span style="color: #fe8019;">(</span><span style="color: #fe8019;">__name__</span><span style="color: #fe8019;">)</span>

app.<span style="color: #83a598;">config</span><span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'SQLALCHEMY_DATABASE_URI'</span><span style="color: #fe8019;">]</span> = <span style="color: #b8bb26;">'sqlite:///'</span>+os.path.join<span style="color: #fe8019;">(</span>basedir, <span style="color: #b8bb26;">'data.sqlite'</span><span style="color: #fe8019;">)</span>
app.<span style="color: #83a598;">config</span><span style="color: #fe8019;">[</span><span style="color: #b8bb26;">'SQLALCHEMY_TRACK_MODIFICATIONS'</span><span style="color: #fe8019;">]</span> = <span style="color: #d3869b;">False</span>
<span style="color: #83a598;">db</span> = SQLAlchemy<span style="color: #fe8019;">(</span>app<span style="color: #fe8019;">)</span>

Migrate<span style="color: #fe8019;">(</span>app, db<span style="color: #fe8019;">)</span>  <span style="color: #928374;"># </span><span style="color: #928374;">Susiejame app ir db.</span>


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Message</span><span style="color: #fe8019;">(</span>db.Model<span style="color: #fe8019;">)</span>:
    <span style="color: #83a598;">__tablename__</span> = <span style="color: #b8bb26;">'messages'</span>
    <span style="color: #fe8019;">id</span> = db.Column<span style="color: #fe8019;">(</span>db.Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    name = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>80<span style="color: #cc241d;">)</span>, nullable=<span style="color: #d3869b;">False</span><span style="color: #fe8019;">)</span>
    email = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>120<span style="color: #cc241d;">)</span>, unique=<span style="color: #d3869b;">True</span>, nullable=<span style="color: #d3869b;">False</span><span style="color: #fe8019;">)</span>
    phone = db.Column<span style="color: #fe8019;">(</span>db.String<span style="color: #cc241d;">(</span>40<span style="color: #cc241d;">)</span>, unique=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>  <span style="color: #928374;"># </span><span style="color: #928374;">Papildome duomen&#371; baz&#279;s model&#303; nauju stulpeliu.</span>
    message = db.Column<span style="color: #fe8019;">(</span>db.Text, nullable=<span style="color: #d3869b;">False</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">prie konstruktoriaus irgi nepamir&#353;tame prid&#279;ti:</span>
    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__init__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, name, email, message, phone<span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">self</span>.name = name
        <span style="color: #fb4934;">self</span>.email = email
        <span style="color: #fb4934;">self</span>.message = message
        <span style="color: #fb4934;">self</span>.phone = phone

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">'</span>{<span style="color: #fb4934;">self</span>.name}<span style="color: #b8bb26;"> - </span>{<span style="color: #fb4934;">self</span>.email}<span style="color: #b8bb26;">'</span>
</pre>
</div>

<p>
Importus papildėme migracijos 'tarnyba':) Jai nurodėme, kokią
aplikaciją susieti su kokia duomenų baze. Papildėme duomenų bazės
modelį nauju stulpeliu (phone).
</p>

<p>
Inicijuokime migracijas mūsų projektui su komanda <code>flask db init</code>:
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #fe8019;">(</span>flask-kursui<span style="color: #fe8019;">)</span> robotautas@robotautas-MS-7A34:~/Dropbox/Flask 3 dalis/Code$ flask db init
Creating directory /home/robotautas/Dropbox/Flask 3 dalis/Code/migrations ...  done
Creating directory /home/robotautas/Dropbox/Flask 3 dalis/Code/migrations/versions ...  done
Generating /home/robotautas/Dropbox/Flask 3 dalis/Code/migrations/alembic.ini ...  done
Generating /home/robotautas/Dropbox/Flask 3 dalis/Code/migrations/README ...  done
Generating /home/robotautas/Dropbox/Flask 3 dalis/Code/migrations/env.py ...  done
Generating /home/robotautas/Dropbox/Flask 3 dalis/Code/migrations/script.py.mako ...  done
Please edit configuration/connection/logging settings<span style="color: #fb4934;"> in</span> <span style="color: #b8bb26;">'/home/robotautas/Dropbox/Flask 3 dalis/Code/migrations/alembic.ini'</span> before proceeding.
<span style="color: #fe8019;">(</span>flask-kursui<span style="color: #fe8019;">)</span> robotautas@robotautas-MS-7A34:~/Dropbox/Flask 3 dalis/Code$ ls
app.py  data.sqlite  migrations  __pycache__  setupdb.py  simple_crud.py  test.py
</pre>
</div>

<p>
matome, kad sukurtas migracijų katalogas. Dabar paruoškime savo pirmą
migraciją, <code>flask db migrate -m "žinutė atminčiai"</code>:
</p>

<p>
(jei tai darome pakartotinai ir matome klaidą "ERROR [flask_migrate]
Error: Target database is not up to date.", reikės prieš tai paleisti
"flask db stamp head")
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #fe8019;">(</span>flask-kursui<span style="color: #fe8019;">)</span> robotautas@robotautas-MS-7A34:~/Dropbox/Flask 3 dalis/Code$ flask db migrate -m <span style="color: #b8bb26;">"prid&#279;tas stulpelis phone"</span>
INFO  <span style="color: #fe8019;">[</span>alembic.runtime.migration<span style="color: #fe8019;">]</span> Context impl SQLiteImpl.
INFO  <span style="color: #fe8019;">[</span>alembic.runtime.migration<span style="color: #fe8019;">]</span> Will assume non-transactional DDL.
INFO  <span style="color: #fe8019;">[</span>alembic.autogenerate.compare<span style="color: #fe8019;">]</span> Detected added column <span style="color: #b8bb26;">'messages.phone'</span>
INFO  <span style="color: #fe8019;">[</span>alembic.autogenerate.compare<span style="color: #fe8019;">]</span> Detected added unique constraint <span style="color: #b8bb26;">'None'</span> on <span style="color: #b8bb26;">'['</span>phone<span style="color: #b8bb26;">']'</span>
Generating /home/robotautas/Dropbox/Flask 3 dalis/Code/migrations/versions/d31d8cda085d_prid&#279;tas_stulpelis_phone.py ...  done
</pre>
</div>

<p>
matome, kad aptikti pakeitimai. Dabar įvykdykime pačią migraciją,
<code>flask db upgrade</code>:
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #fe8019;">(</span>flask-kursui<span style="color: #fe8019;">)</span> robotautas@robotautas-MS-7A34:~/Dropbox/Flask 3 dalis/Code$ flask db upgrade
INFO  <span style="color: #fe8019;">[</span>alembic.runtime.migration<span style="color: #fe8019;">]</span> Context impl SQLiteImpl.
INFO  <span style="color: #fe8019;">[</span>alembic.runtime.migration<span style="color: #fe8019;">]</span> Will assume non-transactional DDL.
INFO  <span style="color: #fe8019;">[</span>alembic.runtime.migration<span style="color: #fe8019;">]</span> Running upgrade  -&gt; d31d8cda085d, prid&#279;tas stulpelis phone
ERROR <span style="color: #fe8019;">[</span>root<span style="color: #fe8019;">]</span> Error: No support for ALTER of constraints<span style="color: #fb4934;"> in</span> SQLite dialect

<span style="color: #928374;"># </span><span style="color: #928374;">klaidel&#281; galime ignoruoti, ne visi&#353;kas dialekto palaikymas..</span>
</pre>
</div>

<p>
patikrinkime, ar suveikė:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">messages</span> = Message.query.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>

<span style="color: #fb4934;">for</span> i <span style="color: #fb4934;">in</span> <span style="color: #83a598;">messages</span>:
    random_phone = randint<span style="color: #fe8019;">(</span>999999, 10000000<span style="color: #fe8019;">)</span>
    i.<span style="color: #83a598;">phone</span> = <span style="color: #fe8019;">str</span><span style="color: #fe8019;">(</span>random_phone<span style="color: #fe8019;">)</span>
    db.session.add<span style="color: #fe8019;">(</span>i<span style="color: #fe8019;">)</span>

db.session.commit<span style="color: #fe8019;">()</span>

<span style="color: #fb4934;">for</span> x <span style="color: #fb4934;">in</span> messages:
    <span style="color: #fe8019;">print</span> <span style="color: #fe8019;">(</span>f<span style="color: #b8bb26;">'</span>{x.<span style="color: #fe8019;">id</span>}<span style="color: #b8bb26;">, </span>{x.name}<span style="color: #b8bb26;">, </span>{x.email}<span style="color: #b8bb26;">, </span>{x.phone}<span style="color: #b8bb26;">, </span>{x.message}<span style="color: #b8bb26;">'</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">2, Antanas, geras.zmogus@lrs.lt, 9033639, Antano nuomon&#279; labai svarbi.</span>
<span style="color: #928374;"># </span><span style="color: #928374;">3, Juozas, juozukas@friends.lt, 2233484, A&#353; labai piktas, nes blogai.</span>
<span style="color: #928374;"># </span><span style="color: #928374;">4, Bronius, bronka@yahoo.com, 4211290, A&#353; tai linksmas esu, man patinka.</span>
</pre>
</div>

<p>
Jeigu atkreipėte dėmesį, migracijų procesas labai panašus į GIT procesus.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2023-01-30 Mon 19:48</p>
<p class="author">Author: arvydas</p>
<p class="date">Created: 2023-02-15 Wed 05:27</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
