<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
        <meta charset="UTF-8">
        <meta name="description" content="CodeAcademy Python notes">
        <link rel="alternate"
              type="application/rss+xml"
              href="https://arvydasg.github.io/rss.xml"
              title="RSS feed for https://arvydasg.github.io/">
        <title>CodeAcademy Databases</title>
        <meta name="author" content="Arvydas Gasparavicius">
        <meta name="referrer" content="no-referrer">
        <meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1">
        <link href= "./readtheorg.css" rel="stylesheet" type="text/css" />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
            integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
            crossorigin="anonymous"
        />
        <script src="static/lightbox.js"></script>
        <script src="static/auto-render.min.js"></script>
        <link rel="icon" href="static/ag.ico">
</head>
<body>
    <nav class="text-center navbar navbar-expand-lg navbar-light bg-light">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div style="justify-content:center" class="collapse navbar-collapse " id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="https://arvydas.dev/codeacademy/">Home <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://arvydas.dev/codeacademy/html_css/index.html">HTML/CSS</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://arvydas.dev/codeacademy/javascript/index.html">JavaScript</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link " href="https://arvydas.dev/codeacademy/python/index.html">Python</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active " href="https://arvydas.dev/codeacademy/databases/index.html">Databases</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link " href="https://arvydas.dev/codeacademy/flask/index.html">Flask</a>
                    </li>
                </ul>
            </div>
    </nav>

    <div id="content" class="content">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org40dcc74">1. Lesson 1 - Įvadas į duomenų bazes</a></li>
<li><a href="#orgfeda1fc">2. Lesson 2 - WHERE panaudojimas</a></li>
<li><a href="#orgde5323c">3. Lesson 3 - Darbas su SQL Python aplinkoje</a>
<ul>
<li><a href="#org62e3179">3.1. intro</a></li>
<li><a href="#orgbf6a2fe">3.2. Įrašymas</a></li>
<li><a href="#orgf02a7ea">3.3. Įrašų paieška</a></li>
<li><a href="#org0ce895a">3.4. Įrašų keitimas ir trynimas</a></li>
<li><a href="#org1b95c6a">3.5. Dinaminės užklausos</a></li>
<li><a href="#orge51eda6">3.6. Saugus būdas</a></li>
<li><a href="#orgfe391c5">3.7. excecutemany()</a></li>
<li><a href="#orga3e5200">3.8. Rowid</a></li>
</ul>
</li>
<li><a href="#org3e549c7">4. Lesson 4 - Duomenu jungimas(joins)</a>
<ul>
<li><a href="#orgc7db7e7">4.1. intro</a></li>
<li><a href="#org5c955a7">4.2. Where</a></li>
<li><a href="#orgf980289">4.3. Join</a></li>
<li><a href="#org0b6c51f">4.4. Join rusys</a></li>
<li><a href="#orga31b7ba">4.5. Praktika</a></li>
</ul>
</li>
<li><a href="#org523e144">5. Lesson 5 - Lenteliu kurimas, constraints</a>
<ul>
<li><a href="#orgfeaca2c">5.1. create table</a></li>
<li><a href="#orgbd0c6ee">5.2. Constraints</a></li>
<li><a href="#orge18fa8d">5.3. Alter table</a></li>
<li><a href="#orgc0296e2">5.4. Loginiai rysiai</a></li>
<li><a href="#org326cbf9">5.5. Praktika</a></li>
</ul>
</li>
<li><a href="#org255d9a7">6. Lesson 6 - SQLAlchemy</a>
<ul>
<li><a href="#orgdca8693">6.1. Intro</a></li>
<li><a href="#org658285e">6.2. SQL Alchemy ORM</a></li>
<li><a href="#org06dae08">6.3. Kaip įrašyti, nuskaityti, atnaujinti, ištrinti duomenys SQLAlchemy lentelėje (CRUD)</a></li>
<li><a href="#org2fb0010">6.4. Programos su duomenų baze (konsolėje) pavyzdys:</a></li>
<li><a href="#org6e814ce">6.5. Uzduotys</a></li>
</ul>
</li>
<li><a href="#orgf605965">7. Lesson 7 - SQLAlchemy 2</a>
<ul>
<li><a href="#org835b4f6">7.1. Many To One</a></li>
<li><a href="#orgb99b617">7.2. One To Many</a></li>
<li><a href="#orgeff0d62">7.3. Many To Many</a></li>
<li><a href="#orga7635da">7.4. Žygimantas examples</a></li>
<li><a href="#orgc0e93c9">7.5. Užduotys</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org40dcc74" class="outline-2">
<h2 id="org40dcc74"><span class="section-number-2">1.</span> Lesson 1 - Įvadas į duomenų bazes</h2>
<div class="outline-text-2" id="text-1">
<p>
SVARBIAUSIOS SQL UZKLAUSOS
</p>

<p>
    <code>SELECT</code> sakinys naudojamas įrašams iš vienos ar daugiau lentelių
    atrinkti.
    <br>
    <code>FROM</code> sakinyje nurodomos lentelės, iš kurių reikia išrinkti eilutes
    (sąryšiai gali būti nurodomi skirtingais JOIN variantais).
    <br>
    <code>WHERE</code> sakinyje nurodoma sąlyga, kurią turi tenkinti grąžinamos
    eilutės.
    <br>
    <code>GROUP</code> BY sąlygoje nurodoma, kad reikia grupuoti tam tikras eilutes.
    Grupuojant eilutes, dažniausiai naudojamos agregatinės funkcijos
    maksimalioms, vidutinėms ir panašioms reikšmėms išrinkti iš grupuotų
    eilučių.
    <br>
    <code>ORDER</code> BY sakiniu nurodoma viena ar daugiau rikiavimo sąlygų.
    <br>
    <code>HAVING</code> sakinyje nurodomas kriterijus, taikomas grupuojamoms eilutėms;
    <br>
    <code>HAVING</code> raktinis žodis gali būti naudojamas tik tais atvejais, jeigu
    užklausoje yra GROUP BY sakinys.
    <br>
    <code>INSERT</code> vartojamas naujų įrašų įterpimui į lentelę.
    <br>
    <code>DELETE</code> leidžia ištrinti įrašus iš lentelės.
    <br>
    <code>UPDATE</code> naudojamas pakeisti vieno ar daugiau įrašų reikšmes.
    <br>
    <code>DISTINCT</code> - skirtingų reikšmių išrinkimas.
    <br>
    <code>DROP TABLE</code> pašalina visą lentelę.
</p>

<p>
KAIP SUKURTI LENTELĘ
</p>

<div class="org-src-container">
<pre class="src src-sql"><span style="color: #fb4934;">CREATE</span> <span style="color: #fb4934;">TABLE</span> <span style="color: #b8bb26;">darbuotojai</span> <span style="color: #fe8019;">(</span>vardas text, pavarde text, atlyginimas <span style="color: #fabd2f;">integer</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
KAIP ĮDĖTI ĮRAŠĄ (EILUTĘ) Į LENTELĘ:
</p>

<div class="org-src-container">
<pre class="src src-sql"><span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> darbuotojai <span style="color: #fe8019;">(</span>vardas, pavarde, atlyginimas<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span>naujasvardas, naujapavarde, naujasatlyginimas<span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
KAIP PERŽIŪRĖTI ĮRAŠUS LENTELĖJE:
</p>

<div class="org-src-container">
<pre class="src src-sql"><span style="color: #fb4934;">SELECT</span> * <span style="color: #fb4934;">FROM</span> darbuotojai
<span style="color: #fb4934;">SELECT</span> * <span style="color: #fb4934;">FROM</span> darbuotojai <span style="color: #fb4934;">WHERE</span> pavarde = "ieskomapavarde"
</pre>
</div>

<p>
KAIP PAKEISTI ĮRAŠĄ LENTELĖJE:
</p>

<div class="org-src-container">
<pre class="src src-sql"><span style="color: #fb4934;">UPDATE</span> darbuotojai <span style="color: #fb4934;">SET</span> atlyginimas = naujasatlyginimas <span style="color: #fb4934;">WHERE</span> pavarde = ieskomapavarde
</pre>
</div>

<p>
KAIP IŠTRINTI LENTELĖS ĮRAŠĄ:
</p>

<div class="org-src-container">
<pre class="src src-sql"><span style="color: #fb4934;">DELETE</span> <span style="color: #fb4934;">from</span> darbuotojai <span style="color: #fb4934;">WHERE</span> vardas = ieskomasvardas <span style="color: #fb4934;">AND</span> pavarde = ieskomapavarde
</pre>
</div>

<p>
PRAKTIKA: DUOMENŲ IŠRINKIMAS IR VALDYMAS
</p>

<p>
Parsisiųskite <a href="https://github.com/CodeAcademy-Online/Python/tree/lesson-11/pradiniai-failai">lentelę</a>, atsidarykite ją programoje <a href="https://sqlitebrowser.org/">DB Browser for
SQLite</a> ir skiltyje "Execute SQL" atlikite šias SQL užklausas:
</p>

<p>
su emacs
</p>

<div class="org-src-container">
<pre class="src src-sqlite"> <span style="color: #928374;">-- </span><span style="color: #928374;">DELETE from darbuotojai WHERE PAVARD&#278; = "Sabutis"</span>
  <span style="color: #928374;">-- </span><span style="color: #928374;">select * from darbuotojai where vardas = "Petras"</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">UPDATE darbuotojai SET PAREIGOS = "IT Technikas" WHERE PAVARD&#278; = "Petrauskas"</span>
     <span style="color: #928374;">-- </span><span style="color: #928374;">select * from darbuotojai</span>
   <span style="color: #928374;">-- </span><span style="color: #928374;">SELECT COUNT(PAREIGOS) FROM DARBUOTOJAI WHERE PAREIGOS = "IT Technikas";</span>
   <span style="color: #fb4934;">UPDATE</span> DARBUOTOJAI <span style="color: #fb4934;">SET</span> PAREIGOS = "testuotojas" <span style="color: #fb4934;">WHERE</span> PAVARD&#278; = "Gabalis"
</pre>
</div>
<div class="org-src-container">
<pre class="src src-sqlite"> <span style="color: #928374;">-- </span><span style="color: #928374;">DELETE from darbuotojai WHERE PAVARD&#278; = "Sabutis"</span>
  <span style="color: #928374;">-- </span><span style="color: #928374;">select * from darbuotojai where vardas = "Petras"</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">UPDATE darbuotojai SET PAREIGOS = "IT Technikas" WHERE PAVARD&#278; = "Petrauskas"</span>
     <span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> darbuotojai
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sql"><span style="color: #928374;">-- </span><span style="color: #928374;">Pasirinkite visus duomenis i&#353; lentel&#279;s &#8220;DARBUOTOJAI&#8221;.</span>
<span style="color: #fb4934;">SELECT</span> * <span style="color: #fb4934;">from</span> DARBUOTOJAI

<span style="color: #928374;">-- </span><span style="color: #928374;">Pasirinkite visus duomenis i&#353; stulpelio &#8220;GIMIMO_DATA&#8221; - lentel&#279;je</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">&#8220;DARBUOTOJAS&#8221;.</span>

<span style="color: #fb4934;">SELECT</span> GIMIMO_DATA <span style="color: #fb4934;">from</span> DARBUOTOJAI

<span style="color: #928374;">-- </span><span style="color: #928374;">Pasirinkite visus duomenis i&#353; stulpeli&#371; &#8220;VARDAS&#8221;,&#8221;PAVARD&#278;&#8221;,</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">&#8220;PAREIGOS&#8221; - lentel&#279;je &#8220;DARBUOTOJAI&#8221;.</span>

<span style="color: #fb4934;">SELECT</span> VARDAS, PAVARD&#278;, PAREIGOS <span style="color: #fb4934;">from</span> DARBUOTOJAI

<span style="color: #928374;">-- </span><span style="color: #928374;">Pasirinkite skirtingas reik&#353;mes i&#353; stulpelio SKYRIUS_PAVADINIMAS -</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">lentel&#279;je &#8220;DARBUOTOJAI&#8221;.</span>

<span style="color: #fb4934;">SELECT</span> <span style="color: #fb4934;">DISTINCT</span> SKYRIUS_PAVADINIMAS <span style="color: #fb4934;">FROM</span> DARBUOTOJAI

<span style="color: #928374;">-- </span><span style="color: #928374;">Pasirinkite visus duomenis apie darbuotojus, kurie dirba Gamybos</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">skyriuje.</span>

<span style="color: #fb4934;">SELECT</span> * <span style="color: #fb4934;">FROM</span> DARBUOTOJAI <span style="color: #fb4934;">WHERE</span> SKYRIUS_PAVADINIMAS = "Gamybos"

<span style="color: #928374;">-- </span><span style="color: #928374;">Pasirinkite duomenis, kokias pareigas u&#382;ima Giedrius,</span>

<span style="color: #fb4934;">SELECT</span> * <span style="color: #fb4934;">FROM</span> DARBUOTOJAI <span style="color: #fb4934;">WHERE</span> VARDAS = "Giedrius"

<span style="color: #928374;">-- </span><span style="color: #928374;">Pasirinkite visus duomenis apie darbuotojus, kuri&#371; gimimo data -</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">1986-09-19.</span>

<span style="color: #fb4934;">SELECT</span> * <span style="color: #fb4934;">FROM</span> DARBUOTOJAI <span style="color: #fb4934;">WHERE</span> GIMIMO_DATA = "1986-09-19"

<span style="color: #928374;">-- </span><span style="color: #928374;">Pasirinkite darbuotoj&#371; vardus, kuri&#371; pavard&#279;s yra Sabutis.</span>

<span style="color: #fb4934;">SELECT</span> * <span style="color: #fb4934;">FROM</span> DARBUOTOJAI <span style="color: #fb4934;">WHERE</span> PAVARD&#278; = "Sabutis"

<span style="color: #928374;">-- </span><span style="color: #928374;">Pasirinkite duomenis (vard&#261; ir pavard&#281;) apie programuotojus i&#353; Gamybos</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">skyriaus.</span>

<span style="color: #fb4934;">SELECT</span> VARDAS,PAVARD&#278; <span style="color: #fb4934;">FROM</span> DARBUOTOJAI <span style="color: #fb4934;">WHERE</span> PAREIGOS = "Programuotojas"

<span style="color: #928374;">-- </span><span style="color: #928374;">&#302;terpkite &#303; lentel&#281; &#8220;DARBUOTOJAI&#8221; nauj&#261; darbuotoj&#261;, u&#382;pildydami visus</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">reikiamus laukus (vard&#261;, pavard&#281;, gimimo dat&#261;, pareigas ir skyriaus</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">pavadinim&#261;).</span>

<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> darbuotojai <span style="color: #fe8019;">(</span>VARDAS, PAVARD&#278;, GIMIMO_DATA, PAREIGOS, SKYRIUS_PAVADINIMAS<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span>"Petras", "Petrauskas", "1999-12-12", "Slavejas", "Vadovas"<span style="color: #fe8019;">)</span>

<span style="color: #928374;">-- </span><span style="color: #928374;">&#302;terpkite &#303; lentel&#281; &#8220;DARBUOTOJAI&#8221; nauj&#261; darbuotoj&#261;, u&#382;pildydami tik</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">laukus (vard&#261;, pavard&#281;, gimimo dat&#261;). Pareigas ir skyriaus pavadinim&#261;</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">palikite neu&#382;pildytus.</span>

<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> darbuotojai <span style="color: #fe8019;">(</span>VARDAS, PAVARD&#278;, GIMIMO_DATA<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span>"Antanas", "Antanauskas", "1999-105-12"<span style="color: #fe8019;">)</span>

<span style="color: #928374;">-- </span><span style="color: #928374;">U&#382;pildykite likusius tu&#353;&#269;ius laukus &#8220;DARBUOTOJAI&#8221; lentel&#279;je, j&#363;s&#371;</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">prie&#353; tai &#303;terptame &#303;ra&#353;e. Priskirkite darbuotojui pareigas ir skyri&#371;.</span>

<span style="color: #fb4934;">UPDATE</span> darbuotojai <span style="color: #fb4934;">SET</span> PAREIGOS = "IT Technikas" <span style="color: #fb4934;">WHERE</span> PAVARD&#278; = "Antanauskas"
<span style="color: #fb4934;">UPDATE</span> darbuotojai <span style="color: #fb4934;">SET</span> SKYRIUS_PAVADINIMAS = "IT" <span style="color: #fb4934;">WHERE</span> PAVARD&#278; = "Antanauskas"

<span style="color: #928374;">-- </span><span style="color: #928374;">I&#353;trinkite lentel&#279;s &#8220;DARBUOTOJAI&#8221; &#303;ra&#353;&#261;, kurio gimimo data yra tokia,</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">kuri&#261; j&#363;s suk&#363;r&#279;te.</span>

<span style="color: #fb4934;">DELETE</span> <span style="color: #fb4934;">from</span> darbuotojai <span style="color: #fb4934;">WHERE</span> GIMIMO_DATA = "1999-105-12" <span style="color: #fb4934;">AND</span> PAVARD&#278; = "Antanauskas"

<span style="color: #928374;">-- </span><span style="color: #928374;">&#302;terpkite, du darbuotojus, pavarde Antanaitis kuri&#371; pareigos b&#363;t&#371;</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">&#8220;Programuotojas&#8221;.</span>

<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> darbuotojai <span style="color: #fe8019;">(</span>PAVARD&#278;<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span>"Antanaitis"<span style="color: #fe8019;">)</span>

<span style="color: #928374;">-- </span><span style="color: #928374;">Pakeiskite, abiej&#371; Antanai&#269;i&#371; pareigas &#303; &#8220;Testuotojas&#8221; vienu sakiniu.</span>

<span style="color: #fb4934;">UPDATE</span> DARBUOTOJAI <span style="color: #fb4934;">SET</span> PAREIGOS = "testuotojas" <span style="color: #fb4934;">WHERE</span> PAVARD&#278; = "Antanaitis"

<span style="color: #928374;">-- </span><span style="color: #928374;">Suskai&#269;iuokite, kiek &#303;mon&#279;je dirba Testuotoj&#371;.</span>

<span style="color: #fb4934;">SELECT</span> <span style="color: #fe8019;">COUNT</span><span style="color: #fe8019;">(</span>PAREIGOS<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">FROM</span> DARBUOTOJAI <span style="color: #fb4934;">WHERE</span> PAREIGOS = "testuotojas";
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfeda1fc" class="outline-2">
<h2 id="orgfeda1fc"><span class="section-number-2">2.</span> Lesson 2 - WHERE panaudojimas</h2>
<div class="outline-text-2" id="text-2">
<p>
BETWEEN&#x2026;AND
</p>

<p>
Nurodo žemiausios ir aukščiausios reikšmių intervalą, išrenkant
duomenis iš lentelės, t.y. rezultate pateikia duomenis tam tikram
reikšmių intervalui:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> mashinos
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #928374;">-- </span><span style="color: #928374;">INSERT INTO mashinos (make, model, color, year, price) VALUES ("Dodge", "Petrona", "Pink", "1988", "50000")</span>
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> mashinos <span style="color: #fe8019;">(</span>make, model, color, <span style="color: #fb4934;">year</span>, price<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span>"Peugeot", "Mondeo", <span style="color: #fb4934;">NULL</span>, "1988", "50000"<span style="color: #fe8019;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> * <span style="color: #fb4934;">FROM</span> mashinos <span style="color: #fb4934;">WHERE</span> <span style="color: #fb4934;">year</span> <span style="color: #fb4934;">BETWEEN</span> 1980 <span style="color: #fb4934;">AND</span> 1990;
</pre>
</div>

<p>
BETWEEN &#x2026; AND operatorius apima ir kraštutines reikšmes.
</p>

<p>
IN
</p>

<p>
Isrenka rezultatus pagal pateikta sarasa
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> mashinos <span style="color: #fb4934;">where</span> <span style="color: #fb4934;">year</span> <span style="color: #fb4934;">in</span> <span style="color: #fe8019;">(</span>1993<span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
LIKE
</p>

<p>
Duomenu isrinkimui is lenteles naudoja sablona:
</p>
<ul class="org-ul">
<li><code>%</code> - reiskia nuli arba keleta simboliu</li>
<li><code>_</code> - reiskia viena simboli</li>
</ul>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> mashinos <span style="color: #fb4934;">where</span> make <span style="color: #fb4934;">LIKE</span> <span style="color: #b8bb26;">'V%'</span>
</pre>
</div>

<p>
Kitas pvz. - išrenka eilutes, kuriose modelis iš 2-jų simbolių:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> mashinos <span style="color: #fb4934;">where</span> model <span style="color: #fb4934;">LIKE</span> <span style="color: #b8bb26;">'__'</span>
</pre>
</div>

<p>
arba, tarkime:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> mashinos <span style="color: #fb4934;">where</span> make <span style="color: #fb4934;">LIKE</span> <span style="color: #b8bb26;">'__d%'</span>
</pre>
</div>

<p>
Išrinktos eilutės, kuriose gamintojo (make) pavadinime trečia raidė yra n:
</p>

<p>
IS NULL
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> mashinos <span style="color: #fb4934;">where</span> color <span style="color: #fb4934;">IS</span> <span style="color: #fb4934;">null</span>
</pre>
</div>

<p>
AND, OR, NOT
</p>

<p>
Naudojami salygu kombinavimui, pvz:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> mashinos <span style="color: #fb4934;">where</span> make = "Ford" <span style="color: #fb4934;">AND</span> price &gt; 40000
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> mashinos <span style="color: #fb4934;">where</span> make = "Ford" <span style="color: #fb4934;">OR</span> <span style="color: #fb4934;">year</span> &gt; 1992
</pre>
</div>

<p>
Prieš kiekvieną sąlygą galima naudoti NOT:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> mashinos <span style="color: #fb4934;">where</span> color <span style="color: #fb4934;">NOT</span> <span style="color: #fb4934;">in</span> <span style="color: #fe8019;">(</span>"Violet", "Orange", "Pink", "Red", "Aquamarine", "Green", "<span style="color: #fb4934;">null</span>"<span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
Sudėtingesnis pavyzdys:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> mashinos <span style="color: #fb4934;">where</span> <span style="color: #fe8019;">(</span>make = "Volvo" <span style="color: #fb4934;">OR</span> make = "Ford"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">and</span> price <span style="color: #fb4934;">NOT</span> <span style="color: #fb4934;">BETWEEN</span> 10000 <span style="color: #fb4934;">AND</span> 60000
</pre>
</div>

<p>
Pirmenybes atliekant lyginimo operacija:
</p>

<ol class="org-ol">
<li>visi lyginimo operatoriai</li>
<li>NOT</li>
<li>AND</li>
<li>OR</li>
</ol>

<p>
ORDER BY, DESC
Nustato, kaip turi būti išrūšiuoti duomenys užklausos rezultate. Pvz.:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> mashinos
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> mashinos <span style="color: #fb4934;">ORDER</span> <span style="color: #fb4934;">BY</span> price
</pre>
</div>

<p>
Jeigu norime atvirkštinio rūšiavimo, naudojame DESC:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> mashinos <span style="color: #fb4934;">ORDER</span> <span style="color: #fb4934;">BY</span> price <span style="color: #fb4934;">DESC</span>
</pre>
</div>

<p>
Analogiškai tekstiniai įrašai rūšiuojasi pagal abėcėlę:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> mashinos <span style="color: #fb4934;">ORDER</span> <span style="color: #fb4934;">BY</span> make
</pre>
</div>

<p>
Case insensitive paieška
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> mashinos <span style="color: #fb4934;">WHERE</span> make = "dodge" <span style="color: #fb4934;">collate</span> nocase
</pre>
</div>

<p>
II yra sujungimo operatorius (concatenate operator AKA pipe or
paipas), naudojamas string reikšmių apjungimui paieškos rezultate:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> "GAMINTOJAS: " || make, model <span style="color: #fb4934;">FROM</span> mashinos
</pre>
</div>


<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> make||" "|| model <span style="color: #fb4934;">AS</span> "Full_name", <span style="color: #fb4934;">year</span>, price <span style="color: #fb4934;">FROM</span> mashinos
</pre>
</div>

<p>
Šiuo atveju nurodėme, kaip vadinsime stulpelį t.y. full<sub>name</sub>. Kitose
DB, pvz Postgres, šiam veiksmui galime naudoti CONCAT paragrafą,
tačiau SQLITE jis neveikia.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Full<sub>name</sub></th>
<th scope="col" class="org-right">year</th>
<th scope="col" class="org-right">price</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Audi V8</td>
<td class="org-right">1992</td>
<td class="org-right">95940</td>
</tr>

<tr>
<td class="org-left">Subaru SVX</td>
<td class="org-right">1993</td>
<td class="org-right">14128</td>
</tr>

<tr>
<td class="org-left">Pontiac Bonneville</td>
<td class="org-right">1991</td>
<td class="org-right">94076</td>
</tr>

<tr>
<td class="org-left">Ford Probe</td>
<td class="org-right">1993</td>
<td class="org-right">95940</td>
</tr>

<tr>
<td class="org-left">Dodge Daytona</td>
<td class="org-right">1989</td>
<td class="org-right">23333</td>
</tr>

<tr>
<td class="org-left">Dodge Petrona</td>
<td class="org-right">1988</td>
<td class="org-right">50000</td>
</tr>

<tr>
<td class="org-left">Volkswagen Gofl</td>
<td class="org-right">1988</td>
<td class="org-right">50000</td>
</tr>

<tr>
<td class="org-left">Volvo S40</td>
<td class="org-right">1988</td>
<td class="org-right">50000</td>
</tr>

<tr>
<td class="org-left">Volvo S40</td>
<td class="org-right">1988</td>
<td class="org-right">50000</td>
</tr>

<tr>
<td class="org-left">Ford Fiesta</td>
<td class="org-right">1988</td>
<td class="org-right">50000</td>
</tr>

<tr>
<td class="org-left">Ford Fiesta</td>
<td class="org-right">1988</td>
<td class="org-right">50000</td>
</tr>

<tr>
<td class="org-left">Peugeot Mondeo</td>
<td class="org-right">1988</td>
<td class="org-right">50000</td>
</tr>
</tbody>
</table>

<p>
Skaičiavimai
</p>

<p>
Užklausose galime nurodyti, kokius aritmetinius veiksmus
norime atlikti su stulpeliu, prieš jį atvaizduojant rezultate:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> make, model, 2021 - <span style="color: #fb4934;">year</span> <span style="color: #fb4934;">AS</span> "age" <span style="color: #fb4934;">from</span> mashinos
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> make, model, price, ROUND<span style="color: #fe8019;">(</span>price / 121.0 * 100, 2<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">AS</span> "be PVM" <span style="color: #fb4934;">FROM</span> mashinos
</pre>
</div>

<p>
Šiuo atveju naudojome funkciją ROUND gauto rezultato suapvalinimui.
Nulis po kablelio (121.0) panaudotas tam, kad gautume float reikšmę
pirmoje dalyboje.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">make</th>
<th scope="col" class="org-left">model</th>
<th scope="col" class="org-right">price</th>
<th scope="col" class="org-right">be PVM</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Audi</td>
<td class="org-left">V8</td>
<td class="org-right">95940</td>
<td class="org-right">79289.26</td>
</tr>

<tr>
<td class="org-left">Subaru</td>
<td class="org-left">SVX</td>
<td class="org-right">14128</td>
<td class="org-right">11676.03</td>
</tr>

<tr>
<td class="org-left">Pontiac</td>
<td class="org-left">Bonneville</td>
<td class="org-right">94076</td>
<td class="org-right">77748.76</td>
</tr>

<tr>
<td class="org-left">Ford</td>
<td class="org-left">Probe</td>
<td class="org-right">95940</td>
<td class="org-right">79289.26</td>
</tr>

<tr>
<td class="org-left">Dodge</td>
<td class="org-left">Daytona</td>
<td class="org-right">23333</td>
<td class="org-right">19283.47</td>
</tr>

<tr>
<td class="org-left">Dodge</td>
<td class="org-left">Petrona</td>
<td class="org-right">50000</td>
<td class="org-right">41322.31</td>
</tr>

<tr>
<td class="org-left">Volkswagen</td>
<td class="org-left">Gofl</td>
<td class="org-right">50000</td>
<td class="org-right">41322.31</td>
</tr>

<tr>
<td class="org-left">Volvo</td>
<td class="org-left">S40</td>
<td class="org-right">50000</td>
<td class="org-right">41322.31</td>
</tr>

<tr>
<td class="org-left">Volvo</td>
<td class="org-left">S40</td>
<td class="org-right">50000</td>
<td class="org-right">41322.31</td>
</tr>

<tr>
<td class="org-left">Ford</td>
<td class="org-left">Fiesta</td>
<td class="org-right">50000</td>
<td class="org-right">41322.31</td>
</tr>

<tr>
<td class="org-left">Ford</td>
<td class="org-left">Fiesta</td>
<td class="org-right">50000</td>
<td class="org-right">41322.31</td>
</tr>

<tr>
<td class="org-left">Peugeot</td>
<td class="org-left">Mondeo</td>
<td class="org-right">50000</td>
<td class="org-right">41322.31</td>
</tr>
</tbody>
</table>

<p>
Grupavimas
Grupavimui dažniausiai naudojamos funkcijos:
</p>

<p>
<code>AVG()</code> - nustato vidurkį grupei
</p>

<p>
<code>COUNT()</code> - nustato eilučių, kurių išraiška yra apibrėžta, kiekį lentelėje
</p>

<p>
<code>MAX()</code> - nustato didžiausią reikšmę
</p>

<p>
<code>MIN()</code> - nustato mažiausią reikšmę
</p>

<p>
<code>SUM()</code> - nustato bendrą sumą, ignoruojant neapibrėžtas reikšmes
</p>

<p>
Funkcijų naudojimas be grupavimo:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> <span style="color: #fe8019;">MIN</span><span style="color: #fe8019;">(</span>price<span style="color: #fe8019;">)</span>, <span style="color: #fe8019;">MAX</span><span style="color: #fe8019;">(</span>price<span style="color: #fe8019;">)</span>, <span style="color: #fe8019;">AVG</span><span style="color: #fe8019;">(</span>price<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">from</span> mashinos
</pre>
</div>

<p>
Suraskime pigiausią fordą:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> make, model, <span style="color: #fe8019;">min</span><span style="color: #fe8019;">(</span>price<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">FROM</span> mashinos <span style="color: #fb4934;">WHERE</span> make="Ford"
</pre>
</div>

<p>
Pavyzdžiai su grupavimu:
</p>

<p>
Išrinkime kiek ir kokių automobilių yra lentelėje:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> make, <span style="color: #fe8019;">count</span><span style="color: #fe8019;">(</span>*<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">FROM</span> mashinos <span style="color: #fb4934;">GROUP</span> <span style="color: #fb4934;">BY</span> make <span style="color: #fb4934;">ORDER</span> <span style="color: #fb4934;">BY</span> <span style="color: #fe8019;">count</span><span style="color: #fe8019;">(</span>*<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">DESC</span>;
</pre>
</div>

<p>
Padarykime lentelę, kurioje matytųsi brangiausios spalvos:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> color, <span style="color: #fe8019;">max</span><span style="color: #fe8019;">(</span>price<span style="color: #fe8019;">)</span>, make, model <span style="color: #fb4934;">FROM</span> mashinos <span style="color: #fb4934;">GROUP</span> <span style="color: #fb4934;">BY</span> color <span style="color: #fb4934;">ORDER</span> <span style="color: #fb4934;">BY</span> price <span style="color: #fb4934;">DESC</span>
</pre>
</div>

<p>
Darant kompleksiškas užklausas, reikėtų laikytis tokio eiliškumo:
</p>

<ul class="org-ul">
<li>SELECT stulpelis, grupinė<sub>funkcija</sub></li>
<li>FROM lentelė</li>
<li>[WHERE sąlyga]</li>
<li>[GROUP BY sąrašas<sub>grupavimui</sub>]</li>
<li>[HAVING grupės sąlyga]</li>
<li>[ORDER BY rūšiavimo sąlyga]</li>
</ul>


<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> make, model, <span style="color: #fb4934;">year</span>, <span style="color: #fe8019;">max</span><span style="color: #fe8019;">(</span>price<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">FROM</span> mashinos <span style="color: #fb4934;">WHERE</span> make <span style="color: #fb4934;">NOT</span> <span style="color: #fb4934;">IN</span> <span style="color: #fe8019;">(</span>"Volvo"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">GROUP</span> <span style="color: #fb4934;">BY</span> price <span style="color: #fb4934;">HAVING</span> <span style="color: #fb4934;">year</span> &gt; 1990 <span style="color: #fb4934;">ORDER</span> <span style="color: #fb4934;">BY</span> make;
</pre>
</div>

<p>
Išrinktos brangiausios mašinos, kurių tarpe nėra toyotų, mercury ir
volvo. Išfiltruotos tos, kurios senesnės už 1990m. Išrūšiuotos pagal
gamintoją.
</p>

<p>
PRAKTIKA: SQL WHERE CLAUSE
</p>

<p>
Parsisiųskite darbuotojai2.db duomenų bazę, atsidarykite ją programoje
DB Browser for SQLite ir skiltyje "Execute SQL" atlikite šias SQL
užklausas:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> darbuotojas
</pre>
</div>

<p>
Išrinkite duomenis apie darbuotoją (asmens kodą, vardą ir pavardę) iš
lentelės DARBUOTOJAS, kuris gimęs 1988 m. liepos 20 d.
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> vardas, PAVARD&#278;, asmens_kodas <span style="color: #fb4934;">FROM</span> darbuotojas <span style="color: #fb4934;">where</span> asmens_kodas <span style="color: #fb4934;">LIKE</span> <span style="color: #b8bb26;">'_880720%'</span>
</pre>
</div>

<p>
Išrinkite duomenis apie darbuotojus (nuo kada dirba, asmens kodą) iš
lentelės DARBUOTOJAS, kurie būtų įsidarbinę nuo 2009 m. spalio 30 d.
iki 2012 m. lapkričio 11d.
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> dirba_nuo, asmens_kodas <span style="color: #fb4934;">FROM</span> darbuotojas <span style="color: #fb4934;">where</span> dirba_nuo <span style="color: #fb4934;">between</span> "2009-10-30" <span style="color: #fb4934;">and</span> "2017-11-11" <span style="color: #fb4934;">Order</span> <span style="color: #fb4934;">by</span> dirba_nuo
</pre>
</div>

<p>
Išrinkite duomenis apie darbuotojus (vardą, Skyriaus ID ir Projekto
ID) iš lentelės DARBUOTOJAS, kurie dirba 2-ame ir 3-ame skyriuose
(panaudojant IN operatorių).
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> vardas, SKYRIUS_ID, PROJEKTAS_ID <span style="color: #fb4934;">FROM</span> darbuotojas <span style="color: #fb4934;">WHERE</span> skyrius_id <span style="color: #fb4934;">in</span> <span style="color: #fe8019;">(</span>2,3<span style="color: #fe8019;">)</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">select * from darbuotojas</span>
</pre>
</div>

<p>
Išrinkite duomenis (vardą, pavarde ir asmens kodą) apie visas moteris
iš lentelės DARBUOTOJAS (panaudojant operatorių LIKE).
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> darbuotojas <span style="color: #fb4934;">where</span> asmens_kodas <span style="color: #fb4934;">like</span> "4%"
<span style="color: #928374;">-- </span><span style="color: #928374;">select * from darbuotojas</span>
</pre>
</div>

<p>
Išrinkite visus duomenis apie visus darbuotojus iš lentelės
DARBUOTOJAS, kurie yra gimę 12 dieną (panaudojant operatorių LIKE).
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> darbuotojas <span style="color: #fb4934;">where</span> asmens_kodas <span style="color: #fb4934;">like</span> "_____12____"
<span style="color: #928374;">-- </span><span style="color: #928374;">select * from darbuotojas</span>
</pre>
</div>

<p>
Išrinkite visus projektus iš lentelės PROJEKTAS, kurių pavadinime
antra raidė būtų “a”.
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> projektas <span style="color: #fb4934;">where</span> pavadinimas <span style="color: #fb4934;">like</span> "_a%"
<span style="color: #928374;">-- </span><span style="color: #928374;">select * from projektas</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">select * from darbuotojas</span>
</pre>
</div>

<p>
Išrinkite visus darbuotojus iš lentelės DARBUOTOJAS, kuriems
nepaskirtos jokios pareigos.
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #928374;">-- </span><span style="color: #928374;">select * from projektas where pavadinimas like "_a%"</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">select * from projektas</span>
<span style="color: #fb4934;">select</span> * <span style="color: #fb4934;">from</span> darbuotojas <span style="color: #fb4934;">where</span> pareigos <span style="color: #fb4934;">is</span> <span style="color: #fb4934;">null</span>
</pre>
</div>

<p>
Išrinkite duomenis apie darbuotojus (vardą, pavardę, nuo kada dirba ir
pareigas), kurie dirba nuo 2011-02-02 ir jų pareigos yra
Programuotojai.
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> vardas, PAVARD&#278;, dirba_nuo, pareigos <span style="color: #fb4934;">from</span> darbuotojas <span style="color: #fb4934;">where</span> pareigos="Programuotojas" <span style="color: #fb4934;">and</span> dirba_nuo="2011-02-02"
<span style="color: #928374;">-- </span><span style="color: #928374;">select * from projektas</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">select * from darbuotojas</span>
</pre>
</div>

<p>
Išrinkite duomenis apie darbuotojus (vardą, pavardę, Skyriaus ID ir
Projekto ID) iš lentelės DARBUOTOJAS, kurie yra iš Gamybos (2)
skyriaus arba 1 projekto.
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> vardas, PAVARD&#278;, skyrius_id, projektas_id <span style="color: #fb4934;">from</span> darbuotojas <span style="color: #fb4934;">where</span> skyrius_id = "2" <span style="color: #fb4934;">or</span> projektas_id="1"
<span style="color: #928374;">-- </span><span style="color: #928374;">select * from projektas</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">select * from darbuotojas</span>
</pre>
</div>

<p>
Išrinkite visus darbuotojų vardus, išskyrus tuos, kurių vardai
prasideda raide “A” .
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> vardas <span style="color: #fb4934;">from</span> darbuotojas <span style="color: #fb4934;">where</span> vardas <span style="color: #fb4934;">like</span> <span style="color: #b8bb26;">'A%'</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">select vardas, PAVARD&#278;, skyrius_id, projektas_id from darbuotojas where skyrius_id = "2" or projektas_id="1"</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">select * from projektas</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">select * from darbuotojas</span>
</pre>
</div>

<p>
Išrinkite duomenis apie darbuotojus (vardą, pavardę ir nuo kada dirba)
iš lentelės DARBUOTOJAS ir išrikiuokite visus duomenis nuo dirbančio
seniausiai iki naujausiai.
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> vardas, PAVARD&#278;, dirba_nuo <span style="color: #fb4934;">from</span> darbuotojas <span style="color: #fb4934;">order</span> <span style="color: #fb4934;">by</span> dirba_nuo
<span style="color: #928374;">-- </span><span style="color: #928374;">select vardas, PAVARD&#278;, skyrius_id, projektas_id from darbuotojas where skyrius_id = "2" or projektas_id="1"</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">select * from projektas</span>
<span style="color: #928374;">-- </span><span style="color: #928374;">select * from darbuotojas</span>
</pre>
</div>

<p>
Išrinkite duomenis apie darbuotojus (vardą, pavardę ir nuo kada dirba)
iš lentelės DARBUOTOJAS ir išrikiuokite visus duomenis nuo dirbančio
naujausiai iki seniausiai.
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> vardas, PAVARD&#278;, dirba_nuo <span style="color: #fb4934;">from</span> darbuotojas <span style="color: #fb4934;">order</span> <span style="color: #fb4934;">by</span> dirba_nuo <span style="color: #fb4934;">DESC</span>
</pre>
</div>

<p>
Išrinkite iš lentelės DARBUOTOJAS projektų ID, kurie būtų minimalus ir
maksimalus skaičius.
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> <span style="color: #fe8019;">min</span><span style="color: #fe8019;">(</span>PROJEKTAS_ID<span style="color: #fe8019;">)</span>, <span style="color: #fe8019;">max</span><span style="color: #fe8019;">(</span>PROJEKTAS_ID<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">from</span> DARBUOTOJAS
</pre>
</div>

<p>
Išrinkite duomenis apie tai, kiek kiekviename projekte yra priskirta
žmonių (projekto numeris ir skaičius, kiek jame dalyvauja žmonių).
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> projektas_id, <span style="color: #fe8019;">count</span><span style="color: #fe8019;">()</span> <span style="color: #fb4934;">from</span> darbuotojas <span style="color: #fb4934;">group</span> <span style="color: #fb4934;">by</span> projektas_id
</pre>
</div>

<p>
#14 punkto užklausą pakoreguokite taip, kad rodytų tik tuos projektus,
kuriems priskirti daugiau nei 3 darbuotojai.
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> projektas_id, <span style="color: #fe8019;">count</span><span style="color: #fe8019;">()</span> <span style="color: #fb4934;">from</span> darbuotojas <span style="color: #fb4934;">group</span> <span style="color: #fb4934;">by</span> projektas_id <span style="color: #fb4934;">having</span> <span style="color: #fe8019;">count</span><span style="color: #fe8019;">()</span> &gt;3
</pre>
</div>

<p>
Išrinkite duomenis (projekto numeris, pareigos, skaičius) iš lentelės
DARBUOTOJAS, kiek programuotojų dirba kiekviename projekte.
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> PROJEKTAS_ID, PAREIGOS, <span style="color: #fe8019;">count</span><span style="color: #fe8019;">()</span> <span style="color: #fb4934;">FROM</span> DARBUOTOJAS <span style="color: #fb4934;">WHERE</span> PAREIGOS = <span style="color: #b8bb26;">'Programuotojas'</span> <span style="color: #fb4934;">group</span> <span style="color: #fb4934;">by</span> PROJEKTAS_ID
</pre>
</div>
</div>
</div>
<div id="outline-container-orgde5323c" class="outline-2">
<h2 id="orgde5323c"><span class="section-number-2">3.</span> Lesson 3 - Darbas su SQL Python aplinkoje</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org62e3179" class="outline-3">
<h3 id="org62e3179"><span class="section-number-3">3.1.</span> intro</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Python aplinkoje darbas su duomenų bazėmis vyksta importavus atitinkamos duomenų bazės tvarkyklę, pvz:
</p>

<p>
Postrgres - psycopg2
</p>

<p>
MySQL - mysql-connector-python
</p>

<p>
SQLite - sqlite3
</p>

<p>
Pythone SQLite tvarkyklės papildomai diegti nereikia, ji yra integruota kartu su Python.
</p>

<p>
Darbas atrodo maždaug taip:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">import</span> sqlite3

<span style="color: #83a598;">conn</span> = sqlite3.connect<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'zmones.db'</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">c</span> = conn.cursor<span style="color: #fe8019;">()</span>

<span style="color: #83a598;">query</span> = <span style="color: #b8bb26;">'''</span>
<span style="color: #b8bb26;">CREATE TABLE draugai (</span>
<span style="color: #b8bb26;">f_name VARCHAR(50),</span>
<span style="color: #b8bb26;">l_name VARCHAR(50),</span>
<span style="color: #b8bb26;">email VARCHAR(100)</span>
<span style="color: #b8bb26;">);</span>
<span style="color: #b8bb26;">'''</span>

c.execute<span style="color: #fe8019;">(</span>query<span style="color: #fe8019;">)</span>
conn.commit<span style="color: #fe8019;">()</span>
conn.close<span style="color: #fe8019;">()</span>
</pre>
</div>

<p>
Panagrinėkime detaliau:
</p>

<p>
Importavome tvarkylę sqlite3;
</p>

<p>
Sukūrėme prisijungimo objektą conn. Jeigu prieš tai neturėjome failo zmones.db, jis sukuriamas automatiškai;
</p>

<p>
conn pagrindu sukūrėme kursoriaus objektą c. Su jo metodais vykdomos SQL užklausos;
</p>

<p>
query yra mūsų SQL užklausa;
</p>

<p>
Į kursoriaus metodo excecute parametrus dedame savo užklausą vykdymui;
</p>

<p>
conn.commit() - išsaugo pakeitimus duomenų bazėje;
</p>

<p>
conn.close() - uždarome atidarytą prisijungimą.
</p>

<p>
Jeigu dar kartą leistumėm tą pačią programą, gautumėm klaidą, kadangi
tokia lentelė jau sukurta. Todėl programose kuriant lenteles, pravartu
papildyti sąlyga:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">CREATE</span> <span style="color: #fb4934;">TABLE</span> IF <span style="color: #fb4934;">NOT</span> <span style="color: #fb4934;">EXISTS</span> <span style="color: #b8bb26;">lentel&#279;</span> <span style="color: #fe8019;">(</span>
    ....
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbf6a2fe" class="outline-3">
<h3 id="orgbf6a2fe"><span class="section-number-3">3.2.</span> Įrašymas</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Vykdomas taip pat, skiriasi tik užklausa:
</p>


<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">query</span> = <span style="color: #b8bb26;">'''</span>
<span style="color: #b8bb26;">INSERT INTO draugai (f_name, l_name, email)</span>
<span style="color: #b8bb26;">VALUES ("Jonas", "Vir&#353;aitis", "ponasjonas@gmail.com");</span>
<span style="color: #b8bb26;">'''</span>
</pre>
</div>

<p>
Tam, kad po kiekvienos užklausos nereikėtų uždarinėti prisijungimo,
galime naudoti context manager'į:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">import</span> sqlite3

<span style="color: #83a598;">conn</span> = sqlite3.connect<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"duomenu_baze.db"</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">c</span> = conn.cursor<span style="color: #fe8019;">()</span>

<span style="color: #fb4934;">with</span> conn:
    c.execute<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"INSERT INTO draugai VALUES ('Domantas', 'Rutkauskas', 'd.rutkauskas@imone.lt')"</span><span style="color: #fe8019;">)</span>
    c.execute<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"INSERT INTO draugai VALUES ('Rimas', 'Radzevi&#269;ius', 'RR@gmail.com')"</span><span style="color: #fe8019;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf02a7ea" class="outline-3">
<h3 id="orgf02a7ea"><span class="section-number-3">3.3.</span> Įrašų paieška</h3>
<div class="outline-text-3" id="text-3-3">
<p>
.fetchone():
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">with</span> conn:
    c.execute<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"SELECT * From darbuotojai WHERE pavarde='Rutkauskas'"</span><span style="color: #fe8019;">)</span>
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>c.fetchall<span style="color: #cc241d;">()</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
kitas pvz.:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">with</span> conn:
    c.execute<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"SELECT * From draugai WHERE l_name LIKE 'R%'"</span><span style="color: #fe8019;">)</span>
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>c.fetchone<span style="color: #cc241d;">()</span><span style="color: #fe8019;">)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">('Domantas', 'Rutkauskas', 'd.rutkauskas@imone.lt')</span>
</pre>
</div>

<p>
Jeigu rezultatų daugiau, negu vienas, .fetchone() mums spausdina PIRMĄ
rezultatą. Norint gauti juos visus, turėtumem naudoti .fetchall():
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">with</span> conn:
    c.execute<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"SELECT * From draugai WHERE l_name LIKE 'R%'"</span><span style="color: #fe8019;">)</span>
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>c.fetchall<span style="color: #cc241d;">()</span><span style="color: #fe8019;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org0ce895a" class="outline-3">
<h3 id="org0ce895a"><span class="section-number-3">3.4.</span> Įrašų keitimas ir trynimas</h3>
<div class="outline-text-3" id="text-3-4">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">with</span> conn:
    c.execute<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"UPDATE draugai SET email='naujas.email@aol.com' WHERE l_name='Radzevi&#269;ius'"</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">with</span> conn:
    c.execute<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"DELETE from draugai WHERE l_name='Rutkauskas'"</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
Įrašų atnaujinimui ir trynimui nereikia naudoti jokių specifinių metodų.
</p>
</div>
</div>

<div id="outline-container-org1b95c6a" class="outline-3">
<h3 id="org1b95c6a"><span class="section-number-3">3.5.</span> Dinaminės užklausos</h3>
<div class="outline-text-3" id="text-3-5">
<p>
Jeigu norėtume užklausoje panaudoti kintamuosius iš kodo, vienas iš galimų variantų būtų:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">import</span> sqlite3

<span style="color: #83a598;">conn</span> = sqlite3.connect<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"zmones.db"</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">c</span> = conn.cursor<span style="color: #fe8019;">()</span>

<span style="color: #83a598;">vardas</span> = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'&#302;veskite vard&#261;: '</span><span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">with</span> conn:
    c.execute<span style="color: #fe8019;">(</span>f<span style="color: #b8bb26;">"SELECT * From draugai WHERE f_name = '</span>{vardas}<span style="color: #b8bb26;">'"</span><span style="color: #fe8019;">)</span>
    res = c.fetchall<span style="color: #fe8019;">()</span>
<span style="color: #fb4934;">if</span> res:
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>res<span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">else</span>:
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'n&#279;ra tokio vardo!'</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python">&#302;veskite vard&#261;: Domantas
<span style="color: #fe8019;">[</span><span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'Domantas'</span>, <span style="color: #b8bb26;">'Rutkauskas'</span>, <span style="color: #b8bb26;">'d.rutkauskas@imone.lt'</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">]</span>
</pre>
</div>

<p>
Tarkime, vardas suveikia kaip slaptažodis ir vartotojas gali matyti
savo duomenis (labai primityvus pavyzdys :) ).
</p>

<p>
pamėginkime dar kartą:
</p>

<div class="org-src-container">
<pre class="src src-python">&#302;veskite <span style="color: #83a598;">vard&#261;</span>: <span style="color: #b8bb26;">'OR 1=1--</span>
<span style="color: #b8bb26;">[('</span>Jonas<span style="color: #b8bb26;">', '</span>Vir&#353;aitis<span style="color: #b8bb26;">', '</span>ponasjonas@gmail.com<span style="color: #b8bb26;">'), ('</span>Jurgis<span style="color: #b8bb26;">', '</span>Vagelis<span style="color: #b8bb26;">', '</span>ponasjurgis@gmail.com<span style="color: #b8bb26;">'), ('</span>Domantas<span style="color: #b8bb26;">', '</span>Rutkauskas<span style="color: #b8bb26;">', '</span>d.rutkauskas@imone.lt<span style="color: #b8bb26;">'), ('</span>Rimas<span style="color: #b8bb26;">', '</span>Radzevi&#269;ius<span style="color: #b8bb26;">', '</span>RR@gmail.com<span style="color: #b8bb26;">')]</span>
</pre>
</div>

<p>
Atsitiko taip, kad mes pratęsėme SQL užklausą ir ji tapo tokia:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> * <span style="color: #fb4934;">From</span> draugai <span style="color: #fb4934;">WHERE</span> f_name = <span style="color: #b8bb26;">''</span> <span style="color: #fb4934;">OR</span> 1=1<span style="color: #928374;">--</span><span style="color: #928374;">'</span>
</pre>
</div>

<p>
Tai yra vadinama SQL Injection ataka, kuri veikia, kuomet vartotojui
yra palikta galimybė pratęsti SQL užklausą.
</p>

<p>
Niekada nekelkite savo kintamųjų tiesiai į užklausas! :)
</p>
</div>
</div>

<div id="outline-container-orge51eda6" class="outline-3">
<h3 id="orge51eda6"><span class="section-number-3">3.6.</span> Saugus būdas</h3>
<div class="outline-text-3" id="text-3-6">
<p>
sqlite3 (kaip ir kitos DB tvarkyklės) turi integruotą sistemą, saugiam
kintamųjų naudojimui užklausose:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">with</span> conn:
    c.execute<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"SELECT * From draugai WHERE f_name =?"</span>, <span style="color: #cc241d;">(</span>vardas,<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    res = c.fetchall<span style="color: #fe8019;">()</span>
</pre>
</div>

<p>
Šiuo atveju klaustukas užklausoje yra pakeičiamas antrame parametre
nurodytomis vertėmis. Jis turi būti pateiktas tuple formatu. Dabar
viskas veikia, kaip priklauso:
</p>


<div class="org-src-container">
<pre class="src src-python">&#302;veskite vard&#261;: Domantas
<span style="color: #fe8019;">[</span><span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'Domantas'</span>, <span style="color: #b8bb26;">'Rutkauskas'</span>, <span style="color: #b8bb26;">'d.rutkauskas@imone.lt'</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">]</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python">&#302;veskite <span style="color: #83a598;">vard&#261;</span>: OR 1=1--
n&#279;ra tokio vardo!
</pre>
</div>

<p>
Užklausoje galime naudoti ir daugiau klaustukų:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">vardas</span> = <span style="color: #b8bb26;">'Algimantas'</span>
<span style="color: #83a598;">pavarde</span> = <span style="color: #b8bb26;">'Guobys'</span>
<span style="color: #83a598;">email</span> = <span style="color: #b8bb26;">'AGuobys@gmail.com'</span>

<span style="color: #fb4934;">with</span> conn:
    c.execute<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"INSERT INTO draugai VALUES(?,?,?)"</span>, <span style="color: #cc241d;">(</span>vardas, pavarde, email<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfe391c5" class="outline-3">
<h3 id="orgfe391c5"><span class="section-number-3">3.7.</span> excecutemany()</h3>
<div class="outline-text-3" id="text-3-7">
<p>
Galime įterpti daug įrašų į lentelę vienu kartu, svarbu
jas paduoti tinkamu formatu (list of tuples):
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">draugai</span> = <span style="color: #fe8019;">[</span>
    <span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'Jonas'</span>, <span style="color: #b8bb26;">'Jonaitis'</span>, <span style="color: #b8bb26;">'jjonaitis@mail.lt'</span><span style="color: #cc241d;">)</span>,
    <span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'Petras'</span>, <span style="color: #b8bb26;">'Miltelis'</span>, <span style="color: #b8bb26;">'petras@pastas.lt'</span><span style="color: #cc241d;">)</span>,
    <span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'Inga'</span>, <span style="color: #b8bb26;">'Guobyt&#279;'</span>, <span style="color: #b8bb26;">'ingag@koksskirtumas.lt'</span><span style="color: #cc241d;">)</span>
<span style="color: #fe8019;">]</span>

<span style="color: #fb4934;">with</span> conn:
    c.executemany<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"INSERT INTO draugai VALUES(?,?,?)"</span>, draugai<span style="color: #fe8019;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga3e5200" class="outline-3">
<h3 id="orga3e5200"><span class="section-number-3">3.8.</span> Rowid</h3>
<div class="outline-text-3" id="text-3-8">
<p>
SQLite turi ypatumą - ID stulpelį sukuria automatiškai, todėl kuriant
lentelę nebūtina tuo rūpintis. Stulpelis vadinasi rowid:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">ids</span> = <span style="color: #fe8019;">(</span>1, 3, 5<span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">with</span> conn:
    c.execute<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"SELECT * FROM draugai WHERE rowid IN (?,?,?)"</span>, ids<span style="color: #fe8019;">)</span>
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>c.fetchall<span style="color: #cc241d;">()</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
Kitose duomenų bazėse reikėtų kurti atskirą ID, PostgreSQL pvz:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">CREATE</span> <span style="color: #fb4934;">TABLE</span> <span style="color: #b8bb26;">lentele</span><span style="color: #fe8019;">(</span>
    id SERIAL <span style="color: #fb4934;">NOT</span> <span style="color: #fb4934;">NULL</span> <span style="color: #fb4934;">PRIMARY</span> <span style="color: #fb4934;">KEY</span>
....
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org3e549c7" class="outline-2">
<h2 id="org3e549c7"><span class="section-number-2">4.</span> Lesson 4 - Duomenu jungimas(joins)</h2>
<div class="outline-text-2" id="text-4">
<p>
<a href="https://www.youtube.com/watch?v=9yeOJ0ZMUYw&amp;ab_channel=Socratica">SQL Joins Explained |¦| Joins in SQL |¦| SQL Tutorial</a>
</p>
</div>
<div id="outline-container-orgc7db7e7" class="outline-3">
<h3 id="orgc7db7e7"><span class="section-number-3">4.1.</span> intro</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Yra du pagrindiniai būdai jungti duomenis iš skirtingų lentelių,
vienas iš jų yra naudojant WHERE:
</p>


<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> &lt;stulpeliai&gt; <span style="color: #fb4934;">FROM</span> &lt;lentel&#279;1&gt;, &lt;lentel&#279;2&gt; <span style="color: #fb4934;">WHERE</span> &lt;jungimo
s&#261;lyga&gt; <span style="color: #fe8019;">[</span><span style="color: #fb4934;">AND</span> &lt;paie&#353;kos s&#261;lyga&gt;<span style="color: #fe8019;">]</span>;
</pre>
</div>

<p>
Kitas būdas naudojant JOIN:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> &lt;stulpeliai&gt; <span style="color: #fb4934;">FROM</span> &lt;lentel&#279;1&gt; <span style="color: #fb4934;">JOIN</span> &lt;lentel&#279; 2&gt; <span style="color: #fb4934;">ON</span>
&lt;jungimo s&#261;lyga&gt; <span style="color: #fe8019;">[</span><span style="color: #fb4934;">WHERE</span> &lt;paie&#353;kos s&#261;lyga&gt;<span style="color: #fe8019;">]</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-org5c955a7" class="outline-3">
<h3 id="org5c955a7"><span class="section-number-3">4.2.</span> Where</h3>
<div class="outline-text-3" id="text-4-2">
<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> person.first_name, person.last_name, car.plate
<span style="color: #fb4934;">FROM</span> person, car
<span style="color: #fb4934;">WHERE</span> person.car_id = car.id
</pre>
</div>

<p>
Užklausa iš 3-jų lentelių:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> last_name, make, <span style="color: #fb4934;">name</span>
<span style="color: #fb4934;">from</span> person, car, company
<span style="color: #fb4934;">WHERE</span> person.car_id = car.id <span style="color: #fb4934;">AND</span> person.company_id = company.id
<span style="color: #fb4934;">ORDER</span> <span style="color: #fb4934;">BY</span> <span style="color: #fb4934;">name</span>
</pre>
</div>

<p>
Pavyzdys su papildomomis sąlygomis:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> last_name, make, <span style="color: #fb4934;">name</span>
<span style="color: #fb4934;">from</span> person, car, company
<span style="color: #fb4934;">WHERE</span> person.car_id = car.id
<span style="color: #fb4934;">AND</span> person.company_id = company.id
<span style="color: #fb4934;">AND</span> make = "Ford"
<span style="color: #fb4934;">ORDER</span> <span style="color: #fb4934;">BY</span> <span style="color: #fb4934;">name</span> <span style="color: #fb4934;">DESC</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf980289" class="outline-3">
<h3 id="orgf980289"><span class="section-number-3">4.3.</span> Join</h3>
<div class="outline-text-3" id="text-4-3">
<p>
Atlikime tuos pačius veiksmus su JOIN:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> person.first_name, person.last_name, car.plate
<span style="color: #fb4934;">FROM</span> person
<span style="color: #fb4934;">JOIN</span> car
<span style="color: #fb4934;">ON</span> person.car_id = car.id
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> last_name, make, <span style="color: #fb4934;">name</span>
<span style="color: #fb4934;">FROM</span> person
<span style="color: #fb4934;">JOIN</span> car <span style="color: #fb4934;">ON</span> person.car_id = car.id
<span style="color: #fb4934;">JOIN</span> company <span style="color: #fb4934;">ON</span> person.company_id = company.id
<span style="color: #fb4934;">ORDER</span> <span style="color: #fb4934;">BY</span> <span style="color: #fb4934;">name</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> last_name, make, <span style="color: #fb4934;">name</span>
<span style="color: #fb4934;">FROM</span> person
<span style="color: #fb4934;">JOIN</span> car <span style="color: #fb4934;">ON</span> person.car_id = car.id
<span style="color: #fb4934;">JOIN</span> company <span style="color: #fb4934;">ON</span> person.company_id = company.id
<span style="color: #fb4934;">WHERE</span> make = "Ford"
<span style="color: #fb4934;">ORDER</span> <span style="color: #fb4934;">BY</span> <span style="color: #fb4934;">name</span> <span style="color: #fb4934;">DESC</span>
</pre>
</div>

<p>
Kiek sudėtingesnis - suskaičiuokime, kiek kokioje kompanijoje dirba
žmonių:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> company.<span style="color: #fb4934;">name</span>, <span style="color: #fe8019;">count</span><span style="color: #fe8019;">(</span>*<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">as</span> <span style="color: #fe8019;">count</span>
<span style="color: #fb4934;">FROM</span> person
<span style="color: #fb4934;">JOIN</span> company
<span style="color: #fb4934;">ON</span> person.company_id = company.id
<span style="color: #fb4934;">GROUP</span> <span style="color: #fb4934;">BY</span> company.<span style="color: #fb4934;">name</span>
</pre>
</div>

<p>
Atrinkime tik tas kompanijas, kuriose dirba daugiau, negu 3
automobilių savininkai:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> company.<span style="color: #fb4934;">name</span>, <span style="color: #fe8019;">count</span><span style="color: #fe8019;">()</span>
<span style="color: #fb4934;">FROM</span> person
<span style="color: #fb4934;">JOIN</span> company <span style="color: #fb4934;">ON</span> person.company_id = company.id
<span style="color: #fb4934;">GROUP</span> <span style="color: #fb4934;">BY</span> company.<span style="color: #fb4934;">name</span>
<span style="color: #fb4934;">HAVING</span> <span style="color: #fe8019;">count</span><span style="color: #fe8019;">()</span> &gt; 3
</pre>
</div>

<p>
Kokie yra Apple automobilių numeriai?
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> plate, <span style="color: #fb4934;">name</span>
<span style="color: #fb4934;">FROM</span> person
<span style="color: #fb4934;">LEFT</span> <span style="color: #fb4934;">JOIN</span> car <span style="color: #fb4934;">ON</span> person.car_id = car.id
<span style="color: #fb4934;">JOIN</span> company <span style="color: #fb4934;">ON</span> person.company_id = company.id
<span style="color: #fb4934;">WHERE</span> company.<span style="color: #fb4934;">name</span> = "Apple"
</pre>
</div>

<p>
Išrinkime žmones, mašinų markes ir kontorų pavadinimus tik iš tų
kontorų, kuriose dirba ne daugiau kaip 3 žmonės iš sąrašo:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> first_name, last_name, make, company.<span style="color: #fb4934;">name</span>
<span style="color: #fb4934;">FROM</span> person
<span style="color: #fb4934;">JOIN</span> company <span style="color: #fb4934;">on</span> person.company_id = company.id
<span style="color: #fb4934;">JOIN</span> car <span style="color: #fb4934;">on</span> person.car_id = car.id
<span style="color: #fb4934;">WHERE</span> person.company_id <span style="color: #fb4934;">IN</span>

<span style="color: #fe8019;">(</span><span style="color: #fb4934;">SELECT</span> company_id
<span style="color: #fb4934;">FROM</span> person
<span style="color: #fb4934;">GROUP</span> <span style="color: #fb4934;">BY</span> company_id
<span style="color: #fb4934;">HAVING</span> <span style="color: #fe8019;">count</span><span style="color: #cc241d;">()</span> &lt;= 3<span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">ORDER</span> <span style="color: #fb4934;">BY</span> company.<span style="color: #fb4934;">name</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org0b6c51f" class="outline-3">
<h3 id="org0b6c51f"><span class="section-number-3">4.4.</span> Join rusys</h3>
<div class="outline-text-3" id="text-4-4">
<ul class="org-ul">
<li>INNER JOIN yra standartinis JOIN, kurį naudojome iki šiol. Returns
connected, maching rows</li>

<li>LEFT JOIN - jungimo rezultatas yra papildomas kairiosios (pirmosios)
lentelės nesujungiamomis eilutėmis</li>

<li>RIGHT JOIN - jungimo rezultatas yra papildomas dešiniosios
(antrosios) lentelės nesujungiamomis eilutėmis</li>

<li>FULL OUTER JOIN - papildoma abiejų lentelių eilutėmis
nesujungiamomis eilutėmis</li>
</ul>

<p>
Populiariausias apart standartinio JOIN yra LEFT JOIN, jį ir
panagrinėsime:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> last_name, make, model
<span style="color: #fb4934;">FROM</span> person
<span style="color: #fb4934;">LEFT</span> <span style="color: #fb4934;">JOIN</span> car
<span style="color: #fb4934;">ON</span> person.car_id = car.id
</pre>
</div>

<p>
Rezultate matome, kad sujungtos buvo ir tos eilutės, kur person neturi
car<sub>id</sub>.
</p>
</div>
</div>
<div id="outline-container-orga31b7ba" class="outline-3">
<h3 id="orga31b7ba"><span class="section-number-3">4.5.</span> Praktika</h3>
<div class="outline-text-3" id="text-4-5">
<p>
Parsisiųskite <a href="https://github.com/robotautas/kursas/blob/master/DB/db3/darbuotojai3.db">darbuotojai3.db</a> duomenų bazę, atsidarykite ją programoje
DB Browser for SQLite ir skiltyje "Execute SQL" atlikite šias SQL
užklausas:
</p>

<p>
Išrinkite darbuotojų vardus ir pavardes kartu su projekto pavadinimu,
kuriame jie dirba.
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #928374;">-- </span><span style="color: #928374;">SELECT *</span>
<span style="color: #fb4934;">SELECT</span> VARDAS, PAVARD&#278;, PAVADINIMAS
<span style="color: #fb4934;">FROM</span> DARBUOTOJAS
<span style="color: #fb4934;">INNER</span> <span style="color: #fb4934;">JOIN</span> PROJEKTAS
<span style="color: #fb4934;">ON</span> DARBUOTOJAS.PROJEKTAS_ID = PROJEKTAS.ID
</pre>
</div>

<p>
Išsirinkite darbuotojų dirbančių projekte Galerija vardus, pavardes ir
projekto pavadinimą.
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> VARDAS, PAVARD&#278;, PAVADINIMAS
<span style="color: #fb4934;">from</span> DARBUOTOJAS
<span style="color: #fb4934;">JOIN</span> PROJEKTAS
<span style="color: #fb4934;">on</span> PROJEKTAS.ID = DARBUOTOJAS.PROJEKTAS_ID <span style="color: #fb4934;">where</span> projektas.pavadinimas = "Galerija"
</pre>
</div>


<p>
Išrinkite visus projekto Projektų valdymas vykdytojus dirbančius
Pardavimų skyriuje.
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> * <span style="color: #fb4934;">from</span> DARBUOTOJAS
<span style="color: #fb4934;">JOIN</span> SKYRIUS
<span style="color: #fb4934;">on</span> SKYRIUS.id = DARBUOTOJAS.SKYRIUS_ID
<span style="color: #fb4934;">JOIN</span> PROJEKTAS <span style="color: #fb4934;">ON</span> PROJEKTAS.ID = DARBUOTOJAS.PROJEKTAS_ID <span style="color: #fb4934;">WHERE</span> SKYRIUS.PAVADINIMAS = "Gamybos" <span style="color: #fb4934;">AND</span> PROJEKTAS.PAVADINIMAS = "Projekt&#371; valdymas"
</pre>
</div>


<p>
Išrinkite visas moteris, dirbančias projekte Projektų valdymas ir
išveskite į ekraną jų vardus, pavardes ir projekto pavadinimą.
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> VARDAS, PAVARD&#278;, PAVADINIMAS
<span style="color: #fb4934;">FROM</span> DARBUOTOJAS
<span style="color: #fb4934;">JOIN</span> PROJEKTAS
<span style="color: #fb4934;">ON</span> PROJEKTAS.ID = DARBUOTOJAS.PROJEKTAS_ID <span style="color: #fb4934;">WHERE</span> <span style="color: #fe8019;">(</span>ASMENS_KODAS <span style="color: #fb4934;">LIKE</span> "4%" <span style="color: #fb4934;">OR</span> ASMENS_KODAS <span style="color: #fb4934;">like</span> "6%"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">AND</span> PROJEKTAS.PAVADINIMAS = "Projekt&#371; valdymas"
</pre>
</div>

<p>
Išrinkite skyrių pavadinimus su juose dirbančių darbuotojų skaičiumi.
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> SKYRIUS.PAVADINIMAS, <span style="color: #fe8019;">count</span><span style="color: #fe8019;">()</span>
<span style="color: #fb4934;">FROM</span> DARBUOTOJAS
<span style="color: #fb4934;">JOIN</span> SKYRIUS
<span style="color: #fb4934;">on</span> SKYRIUS.ID = DARBUOTOJAS.SKYRIUS_ID <span style="color: #fb4934;">GROUP</span> <span style="color: #fb4934;">by</span> SKYRIUS.PAVADINIMAS
</pre>
</div>

<p>
Apribokite #5 užklausos rezultatą taip, kad rodytų tik tuos skyrius
kur dirba bent 5 darbuotojai.
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> SKYRIUS.PAVADINIMAS, <span style="color: #fe8019;">count</span><span style="color: #fe8019;">()</span>
<span style="color: #fb4934;">FROM</span> DARBUOTOJAS
<span style="color: #fb4934;">JOIN</span> SKYRIUS
<span style="color: #fb4934;">on</span> SKYRIUS.ID = DARBUOTOJAS.SKYRIUS_ID <span style="color: #fb4934;">GROUP</span> <span style="color: #fb4934;">by</span> SKYRIUS.PAVADINIMAS <span style="color: #fb4934;">HAVING</span> <span style="color: #fe8019;">count</span><span style="color: #fe8019;">(</span>*<span style="color: #fe8019;">)</span> &gt; 5
</pre>
</div>

<p>
Išrinkite darbuotojus (vardus, pavardes, pareigas) kartu su skyrių,
kuriuose jie dirba pavadinimais, tačiau nesančius tų skyrių vadovais.
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> VARDAS, PAVARD&#278;, PAREIGOS, SKYRIUS.PAVADINIMAS
<span style="color: #fb4934;">FROM</span> DARBUOTOJAS
<span style="color: #fb4934;">JOIN</span> SKYRIUS
<span style="color: #fb4934;">on</span> SKYRIUS.ID = DARBUOTOJAS.SKYRIUS_ID <span style="color: #fb4934;">WHERE</span> <span style="color: #fb4934;">NOT</span> PAREIGOS="Vadovas"
</pre>
</div>


<p>
Sukurkite naują įrašą lentelėje “DARBUOTOJAS” (asmens kodas:
38807117896, vardas: Pranas, pavardė: Logis, Dirba nuo: 2009-11-12,
visa kita - Null).
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> DARBUOTOJAS
<span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #fb4934;">NULL</span>, "Pranas", "Logis", 38807117896, <span style="color: #fb4934;">NULL</span>, "2009-11-12", <span style="color: #fb4934;">NULL</span>, <span style="color: #fb4934;">NULL</span>, <span style="color: #fb4934;">NULL</span>, <span style="color: #fb4934;">NULL</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
Išrinkite darbuotojų vardus, pavardes ir skyriaus pavadinimą.
Rodykite, net ir tuos darbuotojus, kurie nedirba jokiame skyriuje
(skyriaus pavadinimą pasiimkite iš lentelės SKYRIUS).
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> VARDAS, PAVARD&#278;, PAVADINIMAS
<span style="color: #fb4934;">FROM</span> DARBUOTOJAS
<span style="color: #fb4934;">LEFT</span> <span style="color: #fb4934;">JOIN</span> SKYRIUS <span style="color: #fb4934;">on</span> DARBUOTOJAS.SKYRIUS_ID = SKYRIUS.ID
</pre>
</div>


<p>
1# punkto užklausą pataisykite taip, kad rodytų tik tuos vardus ir
projektų pavadinimus kuriuose dirba daugiau nei 4 darbuotojai.
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> VARDAS, PAVARD&#278;, PROJEKTAS.PAVADINIMAS
<span style="color: #fb4934;">FROM</span> DARBUOTOJAS
<span style="color: #fb4934;">JOIN</span> PROJEKTAS
<span style="color: #fb4934;">on</span> PROJEKTAS.ID = DARBUOTOJAS.PROJEKTAS_ID <span style="color: #fb4934;">where</span> PROJEKTAS_ID <span style="color: #fb4934;">in</span> <span style="color: #fe8019;">(</span><span style="color: #fb4934;">SELECT</span> PROJEKTAS_ID <span style="color: #fb4934;">FROM</span> DARBUOTOJAS <span style="color: #fb4934;">GROUP</span> <span style="color: #fb4934;">by</span> PROJEKTAS_ID <span style="color: #fb4934;">HAVING</span> <span style="color: #fe8019;">count</span><span style="color: #cc241d;">()</span> &gt; 4<span style="color: #fe8019;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org523e144" class="outline-2">
<h2 id="org523e144"><span class="section-number-2">5.</span> Lesson 5 - Lenteliu kurimas, constraints</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-orgfeaca2c" class="outline-3">
<h3 id="orgfeaca2c"><span class="section-number-3">5.1.</span> create table</h3>
<div class="outline-text-3" id="text-5-1">
<p>
Sukurkime paprastą lentelę:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">CREATE</span> <span style="color: #fb4934;">TABLE</span> <span style="color: #b8bb26;">coder</span> <span style="color: #fe8019;">(</span>
    f_name <span style="color: #fabd2f;">VARCHAR</span><span style="color: #cc241d;">(</span>50<span style="color: #cc241d;">)</span>,
    l_name <span style="color: #fabd2f;">VARCHAR</span><span style="color: #cc241d;">(</span>50<span style="color: #cc241d;">)</span>,
    email <span style="color: #fabd2f;">VARCHAR</span><span style="color: #cc241d;">(</span>100<span style="color: #cc241d;">)</span>,
    age <span style="color: #fabd2f;">INT</span>,
    xp_years <span style="color: #fabd2f;">INT</span>
<span style="color: #fe8019;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbd0c6ee" class="outline-3">
<h3 id="orgbd0c6ee"><span class="section-number-3">5.2.</span> Constraints</h3>
<div class="outline-text-3" id="text-5-2">
<p>
Dabar sukurkime lentelę su apribojimais (angl. constraints):
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">CREATE</span> <span style="color: #fb4934;">TABLE</span> <span style="color: #b8bb26;">coder</span> <span style="color: #fe8019;">(</span>
    id <span style="color: #fb4934;">PRIMARY</span> <span style="color: #fb4934;">KEY</span> <span style="color: #fb4934;">NOT</span> <span style="color: #fb4934;">NULL</span>,
    f_name <span style="color: #fabd2f;">VARCHAR</span><span style="color: #cc241d;">(</span>50<span style="color: #cc241d;">)</span> <span style="color: #fb4934;">NOT</span> <span style="color: #fb4934;">NULL</span>,
    l_name <span style="color: #fabd2f;">VARCHAR</span><span style="color: #cc241d;">(</span>50<span style="color: #cc241d;">)</span> <span style="color: #fb4934;">NOT</span> <span style="color: #fb4934;">NULL</span>,
    email <span style="color: #fabd2f;">VARCHAR</span><span style="color: #cc241d;">(</span>100<span style="color: #cc241d;">)</span> <span style="color: #fb4934;">UNIQUE</span>,
    age <span style="color: #fabd2f;">INT</span> <span style="color: #fb4934;">CHECK</span> <span style="color: #cc241d;">(</span>age &gt; 17 <span style="color: #fb4934;">AND</span> age &lt; 75<span style="color: #cc241d;">)</span>,
    xp_years <span style="color: #fabd2f;">INT</span> <span style="color: #fb4934;">CHECK</span> <span style="color: #cc241d;">(</span>xp_years &lt; 40<span style="color: #cc241d;">)</span>
<span style="color: #fe8019;">)</span>
</pre>
</div>

<p>
po nurodyto stulpelio duomenų tipo galime (pagal poreikį) surašyti
apribojimus:
</p>

<p>
<code>NOT NULL</code> - nurodo, kad įrašas negali būti tuščias;
</p>

<p>
<code>PRIMARY KEY</code> - stulpelį nustato kaip pirminį raktą;
</p>

<p>
<code>UNIQUE</code> - nurodo, kad įrašai stulpelyje negali kartotis;
</p>

<p>
<code>CHECK</code> (Sąlyga) - tikrina, ar įrašomi duomenys atitinka sąlygą;
</p>

<p>
<code>DEFAULT</code> - nurodo numatytąją reikšmę, jeigu duomenys nesuvedami.
</p>
</div>
</div>

<div id="outline-container-orge18fa8d" class="outline-3">
<h3 id="orge18fa8d"><span class="section-number-3">5.3.</span> Alter table</h3>
<div class="outline-text-3" id="text-5-3">
<p>
Pridėkime stulpelį:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">ALTER</span> <span style="color: #fb4934;">TABLE</span> <span style="color: #b8bb26;">coder</span> <span style="color: #fb4934;">ADD</span> <span style="color: #fb4934;">COLUMN</span> project_id <span style="color: #fabd2f;">INTEGER</span>;
</pre>
</div>

<p>
Pervadinkime jį į team<sub>id</sub>:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">ALTER</span> <span style="color: #fb4934;">TABLE</span> <span style="color: #b8bb26;">coder</span> RENAME <span style="color: #fb4934;">COLUMN</span> project_id <span style="color: #fb4934;">TO</span> team_id;
</pre>
</div>

<p>
Galima pervadinti ir lentelės pavadinimą:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">ALTER</span> <span style="color: #fb4934;">TABLE</span> <span style="color: #b8bb26;">coder</span> RENAME <span style="color: #fb4934;">TO</span> coderiai
</pre>
</div>

<p>
SQLite nepalaiko daugiau ALTER TABLE komandos variacijų, pavyzdžiui
ALTER TABLE lentelę, ADD CONSTRAINT ir kt. Todėl reikia skirti daugiau
dėmesio planavimui.
</p>
</div>
</div>

<div id="outline-container-orgc0296e2" class="outline-3">
<h3 id="orgc0296e2"><span class="section-number-3">5.4.</span> Loginiai rysiai</h3>
<div class="outline-text-3" id="text-5-4">
</div>
<div id="outline-container-org36430f1" class="outline-4">
<h4 id="org36430f1"><span class="section-number-4">5.4.1.</span> One to many</h4>
<div class="outline-text-4" id="text-5-4-1">
<p>
Sukurkime sistemą, kur vienoje lentelėje bus programuotojai, o kitoje
komandos. Vienai komandai gali priklausyti keletas programuotojų
(one-to-many):
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">CREATE</span> <span style="color: #fb4934;">TABLE</span> <span style="color: #b8bb26;">teams</span> <span style="color: #fe8019;">(</span>
  id <span style="color: #fabd2f;">integer</span> <span style="color: #fb4934;">PRIMARY</span> <span style="color: #fb4934;">KEY</span>,
  <span style="color: #fb4934;">name</span> string
<span style="color: #fe8019;">)</span>;
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">CREATE</span> <span style="color: #fb4934;">TABLE</span> <span style="color: #b8bb26;">coders</span> <span style="color: #fe8019;">(</span>
  id <span style="color: #fabd2f;">integer</span> <span style="color: #fb4934;">PRIMARY</span> <span style="color: #fb4934;">KEY</span>,
  f_name string <span style="color: #fb4934;">NOT</span> <span style="color: #fb4934;">NULL</span>,
  l_name string <span style="color: #fb4934;">NOT</span> <span style="color: #fb4934;">NULL</span>,
  email string <span style="color: #fb4934;">UNIQUE</span>,
  age <span style="color: #fabd2f;">integer</span>,
  team_id <span style="color: #fabd2f;">integer</span>,
  <span style="color: #fb4934;">FOREIGN</span> <span style="color: #fb4934;">KEY</span> <span style="color: #cc241d;">(</span>team_id<span style="color: #cc241d;">)</span> <span style="color: #fb4934;">REFERENCES</span> teams <span style="color: #cc241d;">(</span>id<span style="color: #cc241d;">)</span>
<span style="color: #fe8019;">)</span>;
</pre>
</div>

<p>
Ryšys sukuriamas išorinio rakto - FOREIGN KEY pagalba. Paskutinėje
eilutėje nurodoma, kad team<sub>id</sub> stulpelis bus išorinis raktas ir
referuos į person lentelės id, kuris turėtų būti pirminis raktas
(unikalus indentifikatorius).
</p>

<p>
Pridėkime lentelę tasks, kurioje vienas programuotojas galės turėti
daug užduočių:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">CREATE</span> <span style="color: #fb4934;">TABLE</span> <span style="color: #b8bb26;">tasks</span> <span style="color: #fe8019;">(</span>
id <span style="color: #fabd2f;">integer</span> <span style="color: #fb4934;">PRIMARY</span> <span style="color: #fb4934;">KEY</span>,
<span style="color: #fb4934;">name</span> string,
coder_id <span style="color: #fabd2f;">integer</span>,
<span style="color: #fb4934;">FOREIGN</span> <span style="color: #fb4934;">KEY</span> <span style="color: #cc241d;">(</span>coder_id<span style="color: #cc241d;">)</span> <span style="color: #fb4934;">REFERENCES</span> coders <span style="color: #cc241d;">(</span>id<span style="color: #cc241d;">)</span>
<span style="color: #fe8019;">)</span>;
</pre>
</div>

<p>
Užpildykime pseudo duomenimis:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "teams" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Back End'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "teams" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'DevOps'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "teams" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Front End'</span><span style="color: #fe8019;">)</span>;

<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "coders" <span style="color: #fe8019;">(</span>"f_name", "l_name", "email", "age", "team_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Jonas'</span>, <span style="color: #b8bb26;">'Jonaitis'</span>, <span style="color: #b8bb26;">'jj@gmail.com'</span>, <span style="color: #b8bb26;">'20'</span>, <span style="color: #b8bb26;">'1'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "coders" <span style="color: #fe8019;">(</span>"f_name", "l_name", "email", "age", "team_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Antanas'</span>, <span style="color: #b8bb26;">'Antanaitis'</span>, <span style="color: #b8bb26;">'aa@gmail.com'</span>, <span style="color: #b8bb26;">'25'</span>, <span style="color: #b8bb26;">'1'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "coders" <span style="color: #fe8019;">(</span>"f_name", "l_name", "email", "age", "team_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Juozas'</span>, <span style="color: #b8bb26;">'Juozaitis'</span>, <span style="color: #b8bb26;">'jj@hotmail.com'</span>, <span style="color: #b8bb26;">'30'</span>, <span style="color: #b8bb26;">'2'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "coders" <span style="color: #fe8019;">(</span>"f_name", "l_name", "email", "age", "team_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Petras'</span>, <span style="color: #b8bb26;">'Petraitis'</span>, <span style="color: #b8bb26;">'pp@mail.lt'</span>, <span style="color: #b8bb26;">'29'</span>, <span style="color: #b8bb26;">'2'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "coders" <span style="color: #fe8019;">(</span>"f_name", "l_name", "email", "age", "team_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Virgis'</span>, <span style="color: #b8bb26;">'Virgutis'</span>, <span style="color: #b8bb26;">'vv@gmail.com'</span>, <span style="color: #b8bb26;">'21'</span>, <span style="color: #b8bb26;">'3'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "coders" <span style="color: #fe8019;">(</span>"f_name", "l_name", "email", "age", "team_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Tomas'</span>, <span style="color: #b8bb26;">'Aidietis'</span>, <span style="color: #b8bb26;">'ta@imone.lt'</span>, <span style="color: #b8bb26;">'35'</span>, <span style="color: #b8bb26;">'3'</span><span style="color: #fe8019;">)</span>;

<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "tasks" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>", "coder_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Sutvarkyti DB'</span>, <span style="color: #b8bb26;">'5'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "tasks" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>", "coder_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Perdaryti dizain&#261;'</span>, <span style="color: #b8bb26;">'1'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "tasks" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>", "coder_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Perdaryti formas'</span>, <span style="color: #b8bb26;">'2'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "tasks" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>", "coder_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Atnaujinti tvarkykles'</span>, <span style="color: #b8bb26;">'6'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "tasks" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>", "coder_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Perkrauti serverius'</span>, <span style="color: #b8bb26;">'5'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "tasks" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>", "coder_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Atnaujinti bibliotekas'</span>, <span style="color: #b8bb26;">'6'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "tasks" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>", "coder_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Pakeisti logotipus'</span>, <span style="color: #b8bb26;">'2'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "tasks" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>", "coder_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Atnaujinti dokumentacij&#261;'</span>, <span style="color: #b8bb26;">'3'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "tasks" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>", "coder_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'I&#353;oneToManyuoti program&#261;'</span>, <span style="color: #b8bb26;">'4'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "tasks" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>", "coder_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Perdaryti API'</span>, <span style="color: #b8bb26;">'4'</span><span style="color: #fe8019;">)</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgeb81670" class="outline-4">
<h4 id="orgeb81670"><span class="section-number-4">5.4.2.</span> Many to many</h4>
<div class="outline-text-4" id="text-5-4-2">
<p>
Sakykime, kad reikia darbuotojus kažkaip susieti su turimomis
kompetencijomis. Pirmiausia sukurkime lentelę skills:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">CREATE</span> <span style="color: #fb4934;">TABLE</span> <span style="color: #b8bb26;">skills</span> <span style="color: #fe8019;">(</span>
  id <span style="color: #fabd2f;">integer</span> <span style="color: #fb4934;">PRIMARY</span> <span style="color: #fb4934;">KEY</span>,
  <span style="color: #fb4934;">name</span> <span style="color: #fabd2f;">integer</span>
<span style="color: #fe8019;">)</span>;
</pre>
</div>

<p>
Užpildykime duomenimis:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "skills" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Python'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "skills" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'JS'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "skills" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'CSS'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "skills" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Go'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "skills" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'AWS'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "skills" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Linux'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "skills" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'o365'</span><span style="color: #fe8019;">)</span>;
</pre>
</div>

<p>
Turime situaciją, kai daug žmonių gali turėti daug kompetencijų ir
atvirkščiai (pritempta). Gaunasi many-to-many ryšys. Tam, kad
susikurtų toks ryšys, turime turėti tarpinę lentelę:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">CREATE</span> <span style="color: #fb4934;">TABLE</span> <span style="color: #b8bb26;">coders_skills</span> <span style="color: #fe8019;">(</span>
        coder_id <span style="color: #fabd2f;">integer</span>,
        skill_id <span style="color: #fabd2f;">integer</span>,
        <span style="color: #fb4934;">FOREIGN</span> <span style="color: #fb4934;">KEY</span> <span style="color: #cc241d;">(</span>coder_id<span style="color: #cc241d;">)</span> <span style="color: #fb4934;">REFERENCES</span> coders <span style="color: #cc241d;">(</span>id<span style="color: #cc241d;">)</span>,
        <span style="color: #fb4934;">FOREIGN</span> <span style="color: #fb4934;">KEY</span> <span style="color: #cc241d;">(</span>skill_id<span style="color: #cc241d;">)</span> <span style="color: #fb4934;">REFERENCES</span> skills <span style="color: #cc241d;">(</span>id<span style="color: #cc241d;">)</span>
  <span style="color: #fe8019;">)</span>;
</pre>
</div>

<p>
Lentelėje yra tik du išoriniai raktai, ji yra techninė, saugo tik
ryšius. Užpildykime:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "coders_skills" <span style="color: #fe8019;">(</span>"coder_id", "skill_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'1'</span>, <span style="color: #b8bb26;">'2'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "coders_skills" <span style="color: #fe8019;">(</span>"coder_id", "skill_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'1'</span>, <span style="color: #b8bb26;">'3'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "coders_skills" <span style="color: #fe8019;">(</span>"coder_id", "skill_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'2'</span>, <span style="color: #b8bb26;">'2'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "coders_skills" <span style="color: #fe8019;">(</span>"coder_id", "skill_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'2'</span>, <span style="color: #b8bb26;">'3'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "coders_skills" <span style="color: #fe8019;">(</span>"coder_id", "skill_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'3'</span>, <span style="color: #b8bb26;">'1'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "coders_skills" <span style="color: #fe8019;">(</span>"coder_id", "skill_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'3'</span>, <span style="color: #b8bb26;">'4'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "coders_skills" <span style="color: #fe8019;">(</span>"coder_id", "skill_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'4'</span>, <span style="color: #b8bb26;">'1'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "coders_skills" <span style="color: #fe8019;">(</span>"coder_id", "skill_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'4'</span>, <span style="color: #b8bb26;">'6'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "coders_skills" <span style="color: #fe8019;">(</span>"coder_id", "skill_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'5'</span>, <span style="color: #b8bb26;">'4'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "coders_skills" <span style="color: #fe8019;">(</span>"coder_id", "skill_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'5'</span>, <span style="color: #b8bb26;">'5'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "coders_skills" <span style="color: #fe8019;">(</span>"coder_id", "skill_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'6'</span>, <span style="color: #b8bb26;">'5'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "coders_skills" <span style="color: #fe8019;">(</span>"coder_id", "skill_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'6'</span>, <span style="color: #b8bb26;">'6'</span><span style="color: #fe8019;">)</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-org17dd8ec" class="outline-4">
<h4 id="org17dd8ec"><span class="section-number-4">5.4.3.</span> One to One</h4>
<div class="outline-text-4" id="text-5-4-3">
<p>
Retai naudojamas ryšys, nes galima paprasčiausiai sudėti duomenis į tą
pačią lentelę. Tarkime, kad norime paslėpti dalį informacijos, kad
nesimatytų pagrindinėje lentelėje:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">CREATE</span> <span style="color: #fb4934;">TABLE</span> <span style="color: #b8bb26;">passwords</span> <span style="color: #fe8019;">(</span>
        id <span style="color: #fabd2f;">integer</span> <span style="color: #fb4934;">PRIMARY</span> <span style="color: #fb4934;">KEY</span>,
        coder_id <span style="color: #fabd2f;">integer</span> <span style="color: #fb4934;">UNIQUE</span>,
        pwd string,
        <span style="color: #fb4934;">FOREIGN</span> <span style="color: #fb4934;">KEY</span> <span style="color: #cc241d;">(</span>coder_id<span style="color: #cc241d;">)</span> <span style="color: #fb4934;">REFERENCES</span> coders <span style="color: #cc241d;">(</span>id<span style="color: #cc241d;">)</span>
<span style="color: #fe8019;">)</span>;
</pre>
</div>

<p>
Ryšys kuriamas taip pat, kaip ir one-to-many, tik išoriniam raktui
pritaikomas UNIQUE apribojimas. Užpildykime:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "passwords" <span style="color: #fe8019;">(</span>"coder_id", "pwd"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'1'</span>, <span style="color: #b8bb26;">'12345'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "passwords" <span style="color: #fe8019;">(</span>"coder_id", "pwd"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'2'</span>, <span style="color: #b8bb26;">'verisykret'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "passwords" <span style="color: #fe8019;">(</span>"coder_id", "pwd"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'3'</span>, <span style="color: #b8bb26;">'qwerty'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "passwords" <span style="color: #fe8019;">(</span>"coder_id", "pwd"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'4'</span>, <span style="color: #b8bb26;">'uauauai'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "passwords" <span style="color: #fe8019;">(</span>"coder_id", "pwd"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'5'</span>, <span style="color: #b8bb26;">'slaptazodis'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "passwords" <span style="color: #fe8019;">(</span>"coder_id", "pwd"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'6'</span>, <span style="color: #b8bb26;">'barzda'</span><span style="color: #fe8019;">)</span>;
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org326cbf9" class="outline-3">
<h3 id="org326cbf9"><span class="section-number-3">5.5.</span> Praktika</h3>
<div class="outline-text-3" id="text-5-5">
<ol class="org-ol">
<li>sukurti duomenu baze pagal diagrama</li>
</ol>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">CREATE</span> <span style="color: #fb4934;">TABLE</span> <span style="color: #b8bb26;">status</span> <span style="color: #fe8019;">(</span>
  id <span style="color: #fabd2f;">integer</span> <span style="color: #fb4934;">PRIMARY</span> <span style="color: #fb4934;">KEY</span> <span style="color: #fb4934;">NOT</span> <span style="color: #fb4934;">NULL</span>,
  <span style="color: #fb4934;">name</span> string
<span style="color: #fe8019;">)</span>;
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">CREATE</span> <span style="color: #fb4934;">TABLE</span> <span style="color: #b8bb26;">customer</span> <span style="color: #fe8019;">(</span>
  id <span style="color: #fabd2f;">integer</span> <span style="color: #fb4934;">PRIMARY</span> <span style="color: #fb4934;">KEY</span> <span style="color: #fb4934;">NOT</span> <span style="color: #fb4934;">NULL</span>,
  f_name string,
  l_name string,
  email <span style="color: #fabd2f;">VARCHAR</span><span style="color: #cc241d;">(</span>100<span style="color: #cc241d;">)</span> <span style="color: #fb4934;">UNIQUE</span>
<span style="color: #fe8019;">)</span>;
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">CREATE</span> <span style="color: #fb4934;">TABLE</span> <span style="color: #b8bb26;">product</span> <span style="color: #fe8019;">(</span>
id <span style="color: #fabd2f;">integer</span> <span style="color: #fb4934;">PRIMARY</span> <span style="color: #fb4934;">KEY</span> <span style="color: #fb4934;">NOT</span> <span style="color: #fb4934;">NULL</span>,
<span style="color: #fb4934;">name</span> string,
price <span style="color: #fabd2f;">float</span>
<span style="color: #fe8019;">)</span>;
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">CREATE</span> <span style="color: #fb4934;">TABLE</span> <span style="color: #b8bb26;">order_</span> <span style="color: #fe8019;">(</span>
id <span style="color: #fabd2f;">integer</span> <span style="color: #fb4934;">PRIMARY</span> <span style="color: #fb4934;">KEY</span> <span style="color: #fb4934;">NOT</span> <span style="color: #fb4934;">NULL</span>,
customer_id <span style="color: #fabd2f;">integer</span> <span style="color: #fb4934;">UNIQUE</span>,
date_ string,
status_id <span style="color: #fabd2f;">integer</span> <span style="color: #fb4934;">UNIQUE</span>,
<span style="color: #fb4934;">FOREIGN</span> <span style="color: #fb4934;">KEY</span> <span style="color: #cc241d;">(</span>customer_id<span style="color: #cc241d;">)</span> <span style="color: #fb4934;">REFERENCES</span> customer <span style="color: #cc241d;">(</span>id<span style="color: #cc241d;">)</span>,
<span style="color: #fb4934;">FOREIGN</span> <span style="color: #fb4934;">KEY</span> <span style="color: #cc241d;">(</span>status_id<span style="color: #cc241d;">)</span> <span style="color: #fb4934;">REFERENCES</span> status <span style="color: #cc241d;">(</span>id<span style="color: #cc241d;">)</span>
<span style="color: #fe8019;">)</span>;
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">CREATE</span> <span style="color: #fb4934;">TABLE</span> <span style="color: #b8bb26;">product_order</span><span style="color: #fe8019;">(</span>
        quantity <span style="color: #fabd2f;">integer</span>,
        order_id <span style="color: #fabd2f;">integer</span>,
        product_id <span style="color: #fabd2f;">integer</span>,
        <span style="color: #fb4934;">FOREIGN</span> <span style="color: #fb4934;">KEY</span> <span style="color: #cc241d;">(</span>order_id<span style="color: #cc241d;">)</span> <span style="color: #fb4934;">REFERENCES</span> order_ <span style="color: #cc241d;">(</span>id<span style="color: #cc241d;">)</span>,
        <span style="color: #fb4934;">FOREIGN</span> <span style="color: #fb4934;">KEY</span> <span style="color: #cc241d;">(</span>product_id<span style="color: #cc241d;">)</span> <span style="color: #fb4934;">REFERENCES</span> product <span style="color: #cc241d;">(</span>id<span style="color: #cc241d;">)</span>
<span style="color: #fe8019;">)</span>;
</pre>
</div>



<ol class="org-ol">
<li>Uzpildyti duomenimis
<ul class="org-ul">
<li>bent 3 klientai, bent 5 užsakymai, kiekviename jų po 1-3
pozicijas, keletas produktų, keletas užsakymo statusų (pvz,
patvirtintas, vykdomas, įvykdytas, atmestas).</li>
</ul></li>
</ol>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "customer" <span style="color: #fe8019;">(</span>"f_name", "l_name", "email"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Jonas'</span>, <span style="color: #b8bb26;">'Jonaitis'</span>, <span style="color: #b8bb26;">'jj@gmail.com'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "customer" <span style="color: #fe8019;">(</span>"f_name", "l_name", "email"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Antanas'</span>, <span style="color: #b8bb26;">'Antanaitis'</span>, <span style="color: #b8bb26;">'aa@gmail.com'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "customer" <span style="color: #fe8019;">(</span>"f_name", "l_name", "email"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Juozas'</span>, <span style="color: #b8bb26;">'Juozaitis'</span>, <span style="color: #b8bb26;">'jj@hotmail.com'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "customer" <span style="color: #fe8019;">(</span>"f_name", "l_name", "email"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Petras'</span>, <span style="color: #b8bb26;">'Petraitis'</span>, <span style="color: #b8bb26;">'pp@mail.lt'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "customer" <span style="color: #fe8019;">(</span>"f_name", "l_name", "email"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Virgis'</span>, <span style="color: #b8bb26;">'Virgutis'</span>, <span style="color: #b8bb26;">'vv@gmail.com'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "customer" <span style="color: #fe8019;">(</span>"f_name", "l_name", "email"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Tomas'</span>, <span style="color: #b8bb26;">'Aidietis'</span>, <span style="color: #b8bb26;">'ta@imone.lt'</span><span style="color: #fe8019;">)</span>;
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "status" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Atmestas'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "status" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Vykdomas'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "status" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Patvirtintas'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "status" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Ivykdytas'</span><span style="color: #fe8019;">)</span>;
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "product" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>", "price"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Agurkai'</span>, <span style="color: #b8bb26;">'20,99'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "product" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>", "price"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Kisielius'</span>, <span style="color: #b8bb26;">'3,59'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "product" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>", "price"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Prozektorius'</span>, <span style="color: #b8bb26;">'8,99'</span><span style="color: #fe8019;">)</span>;
<span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "product" <span style="color: #fe8019;">(</span>"<span style="color: #fb4934;">name</span>", "price"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Grikiai'</span>, <span style="color: #b8bb26;">'2,99'</span><span style="color: #fe8019;">)</span>;
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "order_" <span style="color: #fe8019;">(</span>"customer_id", "date_", "status_id"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span>7, <span style="color: #b8bb26;">'2022-01-01'</span>, 3<span style="color: #fe8019;">)</span>;
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">INSERT</span> <span style="color: #fb4934;">INTO</span> "product_order" <span style="color: #fe8019;">(</span>"order_id", "product_id", "quantity"<span style="color: #fe8019;">)</span> <span style="color: #fb4934;">VALUES</span> <span style="color: #fe8019;">(</span>1, 3, 10<span style="color: #fe8019;">)</span>;
</pre>
</div>

<p>
I lentele duomenys susidejo, bet belenkaip painu ka as cia realiai turiu
</p>

<ol class="org-ol">
<li>Suformuoti pora uzklausu
<ul class="org-ul">
<li><p>
Kad rezultate matytųsi užsakymo id, užsakovo pavardė, data,
bendra užsakymo suma:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> order_id, date_, l_name, quantity*price <span style="color: #fb4934;">AS</span> Bendra_suma
<span style="color: #fb4934;">from</span> order_
<span style="color: #fb4934;">INNER</span> <span style="color: #fb4934;">JOIN</span> customer
<span style="color: #fb4934;">ON</span> order_.customer_id = customer.id
<span style="color: #fb4934;">Inner</span> <span style="color: #fb4934;">join</span> product_order
<span style="color: #fb4934;">on</span> order_.id = product_order.order_id
<span style="color: #fb4934;">inner</span> <span style="color: #fb4934;">join</span> product
<span style="color: #fb4934;">on</span> product.id = product_order.product_id
</pre>
</div></li>
</ul></li>
</ol>


<ul class="org-ul">
<li><p>
Kad rezultate matytųsi užsakymo id, pozicijos su kiekiais,
kainomis ir bendra pozicijos suma:
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">select</span> order_id, <span style="color: #fb4934;">name</span>, quantity, price, quantity*price <span style="color: #fb4934;">AS</span> Bendra_suma
<span style="color: #fb4934;">from</span> order_
<span style="color: #fb4934;">INNER</span> <span style="color: #fb4934;">JOIN</span> customer
<span style="color: #fb4934;">ON</span> order_.customer_id = customer.id
<span style="color: #fb4934;">Inner</span> <span style="color: #fb4934;">join</span> product_order
<span style="color: #fb4934;">on</span> order_.id = product_order.order_id
<span style="color: #fb4934;">inner</span> <span style="color: #fb4934;">join</span> product
<span style="color: #fb4934;">on</span> product.id = product_order.product_id
</pre>
</div>

<p>
Arba toks Monikos valaites sprendimas
</p>
<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">SELECT</span> <span style="color: #fb4934;">name</span>, <span style="color: #fe8019;">sum</span><span style="color: #fe8019;">(</span>quantity<span style="color: #fe8019;">)</span>, price, <span style="color: #fe8019;">sum</span><span style="color: #fe8019;">(</span>quantity<span style="color: #fe8019;">)</span>*price <span style="color: #fb4934;">as</span> total
<span style="color: #fb4934;">from</span> product_order
<span style="color: #fb4934;">JOIN</span> order_ <span style="color: #fb4934;">on</span> order_.id = product_order.order_id
<span style="color: #fb4934;">JOIN</span> product <span style="color: #fb4934;">on</span> product.id = product_order.product_id
<span style="color: #fb4934;">GROUP</span> <span style="color: #fb4934;">BY</span> <span style="color: #fb4934;">name</span>
</pre>
</div></li>

<li>Prieš tai buvusios užklausos pagrindu sukurkite užklausą, kurioje
matytųsi, kiek ir kokio produkto buvo užsakyta:</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org255d9a7" class="outline-2">
<h2 id="org255d9a7"><span class="section-number-2">6.</span> Lesson 6 - SQLAlchemy</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-orgdca8693" class="outline-3">
<h3 id="orgdca8693"><span class="section-number-3">6.1.</span> Intro</h3>
<div class="outline-text-3" id="text-6-1">
<p>
Modulis SQLAlchemy susideda iš dviejų dalių:
</p>

<ul class="org-ul">
<li>SQL Alchemy Core – įrankis, skirtas manipuliuoti, modifikuoti ir
paleisti įvairias SQL užklausas. Labai panašiai, kaip ir SQLite3, tik
dirba SU VISOMIS duomenų bazėmis:
<a href="https://docs.sqlalchemy.org/en/13/core/engines.html">https://docs.sqlalchemy.org/en/13/core/engines.html</a></li>

<li>SQL Alchemy ORM (ORM – Object Related Mapping) – įrankis, skirtas
automatiškai susieti Python objektus su lentelėmis duomenų bazėje ir
vykdyti įvairius veiksmus (CRUD), nenaudojant SQL užklausų</li>
</ul>

<p>
SQLAlchemy nėra vienintelis ORM funkcionalumą siūlantis modulis. Net
ir Python pagrindu yra sukurta daugiau įrankių. Panašius modulius turi
JAVA (Hibernate), kitos programavimo kalbos.
</p>
</div>
</div>

<div id="outline-container-org658285e" class="outline-3">
<h3 id="org658285e"><span class="section-number-3">6.2.</span> SQL Alchemy ORM</h3>
<div class="outline-text-3" id="text-6-2">
<p>
Kaip susikurti objekto klasę, iš kurios bus sukurta lentelė:
</p>

<p>
Tam, kad sukurtume reikiamos struktūros duomenų bazę ir ja naudotumės,
užtenka sukurti SQLAlchemy klasę ir ją paleisti.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">import</span> datetime
<span style="color: #fb4934;">from</span> sqlalchemy <span style="color: #fb4934;">import</span> Column, Integer, String, Float, DateTime, create_engine
<span style="color: #fb4934;">from</span> sqlalchemy.ext.declarative <span style="color: #fb4934;">import</span> declarative_base

<span style="color: #83a598;">engine</span> = create_engine<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'sqlite:///projektai.db'</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">engine</span> = create_engine<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'sqlite:///:memory:'</span>, echo=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>  <span style="color: #928374;"># </span><span style="color: #928374;">kompo atmintyje galim susikurti db, nebus fizinio failo</span>
Base = declarative_base<span style="color: #fe8019;">()</span>

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Projektas</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__ = <span style="color: #b8bb26;">'Projektas'</span>
    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    name = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Pavadinimas"</span>, String<span style="color: #fe8019;">)</span>
    price = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Kaina"</span>, Float<span style="color: #fe8019;">)</span>
    created_date = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Suk&#363;rimo data"</span>, DateTime, default=datetime.datetime.utcnow<span style="color: #fe8019;">)</span>

    <span style="color: #928374;"># </span><span style="color: #928374;">aprasom taip pat kaip paprasta klase. Asocijuojam su klase. Kad zinotu i kuri collumn deti kintamaji</span>
    <span style="color: #928374;"># </span><span style="color: #928374;">created_date matai neidetas apacioje, nes nereikia jo mum patiem irasyti, jis turi default reiksme</span>
    <span style="color: #928374;"># </span><span style="color: #928374;">jeigu noretum irasyti ir keisti - tuomet prie init turetum prirasyti</span>
    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__init__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, name, price<span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">self</span>.name = name
        <span style="color: #fb4934;">self</span>.price = price

    <span style="color: #928374;"># </span><span style="color: #928374;">Kada kvieciam klase su query, kad ja israsytu ir KAIP israsytu apibudinam cia</span>
    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">"</span>{<span style="color: #fb4934;">self</span>.<span style="color: #fe8019;">id</span>}<span style="color: #b8bb26;"> </span>{<span style="color: #fb4934;">self</span>.name}<span style="color: #b8bb26;"> - </span>{<span style="color: #fb4934;">self</span>.price}<span style="color: #b8bb26;">: </span>{<span style="color: #fb4934;">self</span>.created_date}<span style="color: #b8bb26;">"</span>

<span style="color: #928374;"># </span><span style="color: #928374;">kviecia connectiona ir sukuria visas lenteles jeigu jos neegzistuoja. Jos neupdeitins.</span>
Base.metadata.create_all<span style="color: #fe8019;">(</span>engine<span style="color: #fe8019;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org06dae08" class="outline-3">
<h3 id="org06dae08"><span class="section-number-3">6.3.</span> Kaip įrašyti, nuskaityti, atnaujinti, ištrinti duomenys SQLAlchemy lentelėje (CRUD)</h3>
<div class="outline-text-3" id="text-6-3">
<p>
Kaip sukurti ryšį su sukurta DB kitame faile:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> sqlalchemy <span style="color: #fb4934;">import</span> create_engine
<span style="color: #fb4934;">from</span> sqlalchemy.orm <span style="color: #fb4934;">import</span> sessionmaker
<span style="color: #fb4934;">from</span> projektas <span style="color: #fb4934;">import</span> Projektas

<span style="color: #83a598;">engine</span> = create_engine<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'sqlite:///projektai.db'</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">Session</span> = sessionmaker<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
session = Session<span style="color: #fe8019;">()</span>
</pre>
</div>

<p>
Kaip įrašyti duomenis į lentelę(<code>C</code> R U D):
</p>

<p>
C - create.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">projektas1</span> = Projektas<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Naujas pr."</span>, 20000<span style="color: #fe8019;">)</span>
session.add<span style="color: #fe8019;">(</span>projektas1<span style="color: #fe8019;">)</span>
session.commit<span style="color: #fe8019;">()</span>

<span style="color: #83a598;">projektas2</span> = Projektas<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"2 projektas"</span>, 55000<span style="color: #fe8019;">)</span>
session.add<span style="color: #fe8019;">(</span>projektas2<span style="color: #fe8019;">)</span>
session.commit<span style="color: #fe8019;">()</span>
</pre>
</div>

<p>
Kaip gauti duomenis iš lentelės (C <code>R</code> U D):
</p>

<p>
R - read.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">projektas1</span> = session.query<span style="color: #fe8019;">(</span>Projektas<span style="color: #fe8019;">)</span>.get<span style="color: #fe8019;">(</span>1<span style="color: #fe8019;">)</span>

<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>projektas1.name<span style="color: #fe8019;">)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">Naujas pr.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">projektas2</span> = session.query<span style="color: #fe8019;">(</span>Projektas<span style="color: #fe8019;">)</span>.filter_by<span style="color: #fe8019;">(</span>name=<span style="color: #b8bb26;">"2 projektas"</span><span style="color: #fe8019;">)</span>.one<span style="color: #fe8019;">()</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">projektai</span> = session.query<span style="color: #fe8019;">(</span>Projektas<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>

<span style="color: #fb4934;">for</span> projektas <span style="color: #fb4934;">in</span> projektai:
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>projektas.name, projektas.price<span style="color: #fe8019;">)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">Naujas pr. 20000.0</span>
<span style="color: #928374;"># </span><span style="color: #928374;">2 projektas 55000.0</span>
</pre>
</div>

<p>
Kaip ieškoti duomenų pagal sąlygą ar šabloną:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">search</span> = session.query<span style="color: #fe8019;">(</span>Projektas<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">filter</span><span style="color: #fe8019;">(</span>Projektas.name.ilike<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">"2%"</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">search2</span> = session.query<span style="color: #fe8019;">(</span>Projektas<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">filter</span><span style="color: #fe8019;">(</span>Projektas.price &gt; 1000<span style="color: #fe8019;">)</span>
<span style="color: #83a598;">search3</span> = session.query<span style="color: #fe8019;">(</span>Projektas<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">filter</span><span style="color: #fe8019;">(</span>
    Projektas.price &gt; 1000,
    Projektas.name.ilike<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">"2%"</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>

<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #cc241d;">[</span>i <span style="color: #fb4934;">for</span> i <span style="color: #fb4934;">in</span> search<span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #cc241d;">[</span>i <span style="color: #fb4934;">for</span> i <span style="color: #fb4934;">in</span> search2<span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #cc241d;">[</span>i <span style="color: #fb4934;">for</span> i <span style="color: #fb4934;">in</span> search3<span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">[2 2 projektas - 55000.0: 2021-02-03 14:29:33.477232]</span>
<span style="color: #928374;"># </span><span style="color: #928374;">[1 Naujas pr. - 20000.0: 2021-02-03 14:29:33.437231, 2 2 projektas - 55000.0: 2021-02-03 14:29:33.477232]</span>
<span style="color: #928374;"># </span><span style="color: #928374;">[2 2 projektas - 55000.0: 2021-02-03 14:29:33.477232]</span>
</pre>
</div>

<p>
Kaip pakeisti duomenis lentelėje (C R <code>U</code> D):
</p>

<p>
U - update.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">projektas1</span> = session.query<span style="color: #fe8019;">(</span>Projektas<span style="color: #fe8019;">)</span>.get<span style="color: #fe8019;">(</span>1<span style="color: #fe8019;">)</span>
projektas1.<span style="color: #83a598;">price</span> = 22000
session.commit<span style="color: #fe8019;">()</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">projektas2</span> = session.query<span style="color: #fe8019;">(</span>Projektas<span style="color: #fe8019;">)</span>.filter_by<span style="color: #fe8019;">(</span>name=<span style="color: #b8bb26;">"2 projektas"</span><span style="color: #fe8019;">)</span>.one<span style="color: #fe8019;">()</span>
projektas2.name = <span style="color: #b8bb26;">"2 projektas tikrai"</span>
session.commit<span style="color: #fe8019;">()</span>
</pre>
</div>

<p>
Kaip ištrinti duomenis lentelėje (C R U <code>D</code>):
</p>

<p>
D - delete.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #83a598;">projektas1</span> = session.query<span style="color: #fe8019;">(</span>Projektas<span style="color: #fe8019;">)</span>.filter_by<span style="color: #fe8019;">(</span>name=<span style="color: #b8bb26;">"Naujas pr."</span><span style="color: #fe8019;">)</span>.one<span style="color: #fe8019;">()</span>

session.delete<span style="color: #fe8019;">(</span>projektas1<span style="color: #fe8019;">)</span>
session.commit<span style="color: #fe8019;">()</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org2fb0010" class="outline-3">
<h3 id="org2fb0010"><span class="section-number-3">6.4.</span> Programos su duomenų baze (konsolėje) pavyzdys:</h3>
<div class="outline-text-3" id="text-6-4">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> models <span style="color: #fb4934;">import</span> engine, Projektas
<span style="color: #fb4934;">from</span> sqlalchemy.orm <span style="color: #fb4934;">import</span> sessionmaker

<span style="color: #83a598;">engine</span> = create_engine<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'sqlite:///projektai.db'</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">Session</span> = sessionmaker<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
session = Session<span style="color: #fe8019;">()</span>

<span style="color: #fb4934;">while</span> <span style="color: #d3869b;">True</span>:
    pasirinkimas = <span style="color: #fe8019;">int</span><span style="color: #fe8019;">(</span><span style="color: #fe8019;">input</span><span style="color: #cc241d;">(</span><span style="color: #b8bb26;">"Pasirinkite veiksm&#261;: \n1 - atvaizduoti projektus \n2 - sukurti projekt&#261; \n3 - pakeisti projekt&#261; \n4 - i&#353;trinti projekt&#261;\n"</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>

    <span style="color: #fb4934;">if</span> pasirinkimas == 1:
        projektai = session.query<span style="color: #fe8019;">(</span>Projektas<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>
        <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"-------------------"</span><span style="color: #fe8019;">)</span>
        <span style="color: #fb4934;">for</span> projektas <span style="color: #fb4934;">in</span> projektai:
            <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>projektas<span style="color: #fe8019;">)</span>
        <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"-------------------"</span><span style="color: #fe8019;">)</span>

    <span style="color: #fb4934;">if</span> pasirinkimas == 2:
        name = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"&#302;veskite projekto pavadinim&#261;"</span><span style="color: #fe8019;">)</span>
        price = <span style="color: #fe8019;">float</span><span style="color: #fe8019;">(</span><span style="color: #fe8019;">input</span><span style="color: #cc241d;">(</span><span style="color: #b8bb26;">"&#302;veskite projekto kain&#261;"</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
        projektas = Projektas<span style="color: #fe8019;">(</span>name, price<span style="color: #fe8019;">)</span>
        session.add<span style="color: #fe8019;">(</span>projektas<span style="color: #fe8019;">)</span>
        session.commit<span style="color: #fe8019;">()</span>

    <span style="color: #fb4934;">if</span> pasirinkimas == 3:
        projektai = session.query<span style="color: #fe8019;">(</span>Projektas<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>
        <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"-------------------"</span><span style="color: #fe8019;">)</span>
        <span style="color: #fb4934;">for</span> projektas <span style="color: #fb4934;">in</span> projektai:
            <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>projektas<span style="color: #fe8019;">)</span>
        <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"-------------------"</span><span style="color: #fe8019;">)</span>
        keiciamo_id = <span style="color: #fe8019;">int</span><span style="color: #fe8019;">(</span><span style="color: #fe8019;">input</span><span style="color: #cc241d;">(</span><span style="color: #b8bb26;">"Pasirinkite norimo pakeisti projekto ID"</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
        keiciamas_projektas = session.query<span style="color: #fe8019;">(</span>Projektas<span style="color: #fe8019;">)</span>.get<span style="color: #fe8019;">(</span>keiciamo_id<span style="color: #fe8019;">)</span>
        pakeitimas = <span style="color: #fe8019;">int</span><span style="color: #fe8019;">(</span><span style="color: #fe8019;">input</span><span style="color: #cc241d;">(</span><span style="color: #b8bb26;">"K&#261; norite pakeisti: 1 - pavadinim&#261;, 2 - kain&#261;"</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
        <span style="color: #fb4934;">if</span> pakeitimas == 1:
            keiciamas_projektas.name = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"&#302;veskite projekto pavadinim&#261;"</span><span style="color: #fe8019;">)</span>
        <span style="color: #fb4934;">if</span> pakeitimas == 2:
            keiciamas_projektas.price = <span style="color: #fe8019;">float</span><span style="color: #fe8019;">(</span><span style="color: #fe8019;">input</span><span style="color: #cc241d;">(</span><span style="color: #b8bb26;">"&#302;veskite projekto kain&#261;"</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
        session.commit<span style="color: #fe8019;">()</span>

    <span style="color: #fb4934;">if</span> pasirinkimas == 4:
        projektai = session.query<span style="color: #fe8019;">(</span>Projektas<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>
        <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"-------------------"</span><span style="color: #fe8019;">)</span>
        <span style="color: #fb4934;">for</span> projektas <span style="color: #fb4934;">in</span> projektai:
            <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>projektas<span style="color: #fe8019;">)</span>
        <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"-------------------"</span><span style="color: #fe8019;">)</span>
        keiciamo_id = <span style="color: #fe8019;">int</span><span style="color: #fe8019;">(</span><span style="color: #fe8019;">input</span><span style="color: #cc241d;">(</span><span style="color: #b8bb26;">"Pasirinkite norimo i&#353;trinti projekto ID"</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
        trinamas_projektas = session.query<span style="color: #fe8019;">(</span>Projektas<span style="color: #fe8019;">)</span>.get<span style="color: #fe8019;">(</span>keiciamo_id<span style="color: #fe8019;">)</span>
        session.delete<span style="color: #fe8019;">(</span>trinamas_projektas<span style="color: #fe8019;">)</span>
        session.commit<span style="color: #fe8019;">()</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org6e814ce" class="outline-3">
<h3 id="org6e814ce"><span class="section-number-3">6.5.</span> Uzduotys</h3>
<div class="outline-text-3" id="text-6-5">
</div>
<div id="outline-container-orgbad8c91" class="outline-4">
<h4 id="orgbad8c91"><span class="section-number-4">6.5.1.</span> 1 užduotis</h4>
<div class="outline-text-4" id="text-6-5-1">
<p>
Sukurti programą, kuri:
</p>

<p>
Leistų įvesti darbuotojus: vardą, pavardę, gimimo datą, pareigas,
atlyginimą, nuo kada dirba (data būtų nustatoma automatiškai, pagal
dabartinę datą)
</p>

<p>
Duomenys būtų saugomi duomenų bazėję, panaudojant SQLAlchemy ORM (be
SQL užklausų)
</p>

<p>
Vartotojas galėtų įrašyti, peržiūrėti, ištrinti ir atnaujinti
darbuotojus
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #928374;"># </span><span style="color: #928374;">cia yra db.py</span>

<span style="color: #fb4934;">import</span> datetime
<span style="color: #fb4934;">from</span> sqlalchemy <span style="color: #fb4934;">import</span> Column, String, Float, Integer, DateTime, create_engine
<span style="color: #fb4934;">from</span> sqlalchemy.ext.declarative <span style="color: #fb4934;">import</span> declarative_base

<span style="color: #83a598;">engine</span> = create_engine<span style="color: #fe8019;">(</span>
    <span style="color: #b8bb26;">"sqlite:////home/arvydas/Dropbox/src/db/sqlAlchemy_1_1/db.db"</span>, echo=<span style="color: #d3869b;">True</span>
<span style="color: #fe8019;">)</span>

base = declarative_base<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">darbuotojai</span><span style="color: #fe8019;">(</span>base<span style="color: #fe8019;">)</span>:

    __tablename__ = <span style="color: #b8bb26;">"darbuotojai"</span>

    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    name = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Vardas"</span>, String<span style="color: #fe8019;">)</span>
    lastname = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Pavarde"</span>, String<span style="color: #fe8019;">)</span>
    birthdate = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Gimimo Data"</span>, String<span style="color: #fe8019;">)</span>
    occupation = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Pareigos"</span>, String<span style="color: #fe8019;">)</span>
    salary = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Alga"</span>, Integer<span style="color: #fe8019;">)</span>
    works_from = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Nuo kada dirba"</span>, DateTime, default=datetime.datetime.utcnow<span style="color: #fe8019;">)</span>

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__init__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, name, lastname, birthdate, occupation, salary<span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">self</span>.name = name
        <span style="color: #fb4934;">self</span>.lastname = lastname
        <span style="color: #fb4934;">self</span>.birthdate = birthdate
        <span style="color: #fb4934;">self</span>.occupation = occupation
        <span style="color: #fb4934;">self</span>.salary = salary

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">"Jo ID yra - </span>{<span style="color: #fb4934;">self</span>.<span style="color: #fe8019;">id</span>}<span style="color: #b8bb26;">. Kvie&#269;iamas yra - </span>{<span style="color: #fb4934;">self</span>.name}<span style="color: #b8bb26;"> vardu bei </span>{<span style="color: #fb4934;">self</span>.lastname}<span style="color: #b8bb26;"> pavarde. Gim&#281;s jis - </span>{<span style="color: #fb4934;">self</span>.birthdate}<span style="color: #b8bb26;">, dirba - </span>{<span style="color: #fb4934;">self</span>.occupation}<span style="color: #b8bb26;"> ir u&#382;dirba: </span>{<span style="color: #fb4934;">self</span>.salary}<span style="color: #b8bb26;">"</span>


base.metadata.create_all<span style="color: #fe8019;">(</span>engine<span style="color: #fe8019;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #928374;"># </span><span style="color: #928374;">create.py</span>
<span style="color: #fb4934;">import</span> db
<span style="color: #fb4934;">from</span> sqlalchemy <span style="color: #fb4934;">import</span> create_engine
<span style="color: #fb4934;">from</span> sqlalchemy.orm <span style="color: #fb4934;">import</span> sessionmaker


<span style="color: #83a598;">engine</span> = create_engine<span style="color: #fe8019;">(</span>
    <span style="color: #b8bb26;">"sqlite:////home/arvydas/Dropbox/src/db/sqlAlchemy_1_1/db.db"</span>, echo=<span style="color: #d3869b;">True</span>
<span style="color: #fe8019;">)</span>

Session = sessionmaker<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
session = Session<span style="color: #fe8019;">()</span>

user1 = darbuotojai<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Arvydas"</span>, <span style="color: #b8bb26;">"Gaspariunas"</span>, 1994, <span style="color: #b8bb26;">"Kalvis"</span>, 50<span style="color: #fe8019;">)</span>
user = darbuotojai<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Petras"</span>, <span style="color: #b8bb26;">"Petraitis"</span>, 1992, <span style="color: #b8bb26;">"Programuotojas"</span>, 100<span style="color: #fe8019;">)</span>
session.add<span style="color: #fe8019;">(</span>user<span style="color: #fe8019;">)</span>
session.commit<span style="color: #fe8019;">()</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #928374;"># </span><span style="color: #928374;">read.py</span>

<span style="color: #fb4934;">import</span> db
<span style="color: #fb4934;">from</span> sqlalchemy <span style="color: #fb4934;">import</span> create_engine
<span style="color: #fb4934;">from</span> sqlalchemy.orm <span style="color: #fb4934;">import</span> sessionmaker

<span style="color: #83a598;">engine</span> = create_engine<span style="color: #fe8019;">(</span>
    <span style="color: #b8bb26;">"sqlite:////home/arvydas/Dropbox/src/db/sqlAlchemy_1_1/db.db"</span>, echo=<span style="color: #d3869b;">True</span>
<span style="color: #fe8019;">)</span>

Session = sessionmaker<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
session = Session<span style="color: #fe8019;">()</span>

<span style="color: #928374;"># </span><span style="color: #928374;">imam pagal ID</span>
x = session.query<span style="color: #fe8019;">(</span>darbuotojai<span style="color: #fe8019;">)</span>.get<span style="color: #fe8019;">(</span>1<span style="color: #fe8019;">)</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>x.name<span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">get viena, PIRMA useri kuris machina criteria</span>
x2 = session.query<span style="color: #fe8019;">(</span>darbuotojai<span style="color: #fe8019;">)</span>.filter_by<span style="color: #fe8019;">(</span>name=<span style="color: #b8bb26;">"Arvydas"</span><span style="color: #fe8019;">)</span>.one<span style="color: #fe8019;">()</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>x2<span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">get all users IN A LIST</span>
pimpiai = session.query<span style="color: #fe8019;">(</span>darbuotojai<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>pimpiai<span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">for loopas oo taip</span>
<span style="color: #fb4934;">for</span> darbuotojas <span style="color: #fb4934;">in</span> pimpiai:
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>darbuotojas<span style="color: #fe8019;">)</span>

search = session.query<span style="color: #fe8019;">(</span>darbuotojai<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">filter</span><span style="color: #fe8019;">(</span>darbuotojai.name.ilike<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">"S%"</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
search2 = session.query<span style="color: #fe8019;">(</span>darbuotojai<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">filter</span><span style="color: #fe8019;">(</span>darbuotojai.salary &gt; 60<span style="color: #fe8019;">)</span>
search3 = session.query<span style="color: #fe8019;">(</span>darbuotojai<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">filter</span><span style="color: #fe8019;">(</span>
    darbuotojai.salary &lt; 60
    darbuotojai.name.ilike<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">"S%"</span><span style="color: #cc241d;">)</span>
<span style="color: #fe8019;">)</span>

<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #cc241d;">[</span>i <span style="color: #fb4934;">for</span> i <span style="color: #fb4934;">in</span> search<span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #cc241d;">[</span>i <span style="color: #fb4934;">for</span> i <span style="color: #fb4934;">in</span> search2<span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #cc241d;">[</span>i <span style="color: #fb4934;">for</span> i <span style="color: #fb4934;">in</span> search3<span style="color: #cc241d;">]</span><span style="color: #fe8019;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #928374;"># </span><span style="color: #928374;">update.py</span>

<span style="color: #fb4934;">import</span> db
<span style="color: #fb4934;">from</span> sqlalchemy <span style="color: #fb4934;">import</span> create_engine
<span style="color: #fb4934;">from</span> sqlalchemy.orm <span style="color: #fb4934;">import</span> sessionmaker

<span style="color: #83a598;">engine</span> = create_engine<span style="color: #fe8019;">(</span>
    <span style="color: #b8bb26;">"sqlite:////home/arvydas/Dropbox/src/db/sqlAlchemy_1_1/db.db"</span>, echo=<span style="color: #d3869b;">True</span>
<span style="color: #fe8019;">)</span>

Session = sessionmaker<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
session = Session<span style="color: #fe8019;">()</span>

x2 = session.query<span style="color: #fe8019;">(</span>darbuotojai<span style="color: #fe8019;">)</span>.filter_by<span style="color: #fe8019;">(</span>name=<span style="color: #b8bb26;">"Arvydas"</span><span style="color: #fe8019;">)</span>.one<span style="color: #fe8019;">()</span>
x2.salary = 2000
session.commit<span style="color: #fe8019;">()</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #928374;"># </span><span style="color: #928374;">delete.py</span>

<span style="color: #fb4934;">import</span> db
<span style="color: #fb4934;">from</span> sqlalchemy <span style="color: #fb4934;">import</span> create_engine
<span style="color: #fb4934;">from</span> sqlalchemy.orm <span style="color: #fb4934;">import</span> sessionmaker

<span style="color: #83a598;">engine</span> = create_engine<span style="color: #fe8019;">(</span>
    <span style="color: #b8bb26;">"sqlite:////home/arvydas/Dropbox/src/db/sqlAlchemy_1_1/db.db"</span>, echo=<span style="color: #d3869b;">True</span>
<span style="color: #fe8019;">)</span>

Session = sessionmaker<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
session = Session<span style="color: #fe8019;">()</span>

x2 = session.query<span style="color: #fe8019;">(</span>darbuotojai<span style="color: #fe8019;">)</span>.filter_by<span style="color: #fe8019;">(</span>name=<span style="color: #b8bb26;">"Nabagas"</span><span style="color: #fe8019;">)</span>.one<span style="color: #fe8019;">()</span>

session.delete<span style="color: #fe8019;">(</span>x2<span style="color: #fe8019;">)</span>
session.commit<span style="color: #fe8019;">()</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org5901060" class="outline-4">
<h4 id="org5901060"><span class="section-number-4">6.5.2.</span> 1.5</h4>
<div class="outline-text-4" id="text-6-5-2">
<p>
Can't remember what is this exactly, go ahead and test.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">import</span> datetime
<span style="color: #fb4934;">from</span> sqlalchemy <span style="color: #fb4934;">import</span> Column, Integer, String, Float, DateTime, create_engine
<span style="color: #fb4934;">from</span> sqlalchemy.ext.declarative <span style="color: #fb4934;">import</span> declarative_base
<span style="color: #fb4934;">from</span> sqlalchemy.orm <span style="color: #fb4934;">import</span> sessionmaker

<span style="color: #83a598;">engine</span> = create_engine<span style="color: #fe8019;">(</span>
    <span style="color: #b8bb26;">"sqlite:////home/arvydas/Dropbox/src/db/sqlAlchemy_1_1.5/employee.db"</span>, echo=<span style="color: #d3869b;">True</span>
<span style="color: #fe8019;">)</span>

Base = declarative_base<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Employee</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    <span style="color: #dfd2b8;">"""</span>
<span style="color: #dfd2b8;">    Tokia ir tokia klase cia.</span>

<span style="color: #dfd2b8;">    Ir dar keli dalykai.</span>
<span style="color: #dfd2b8;">    """</span>

    __tablename__ = <span style="color: #b8bb26;">"employee"</span>

    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    name = Column<span style="color: #fe8019;">(</span>String<span style="color: #fe8019;">)</span>
    salary = Column<span style="color: #fe8019;">(</span>Float<span style="color: #fe8019;">)</span>
    created_date = Column<span style="color: #fe8019;">(</span>DateTime, default=datetime.datetime.utcnow<span style="color: #fe8019;">)</span>

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__init__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, name, salary<span style="color: #fe8019;">)</span>:
        <span style="color: #dfd2b8;">"""Cia parasom tiesiog kaip uzvadinam dalykus, nzn."""</span>
        <span style="color: #fb4934;">self</span>.name = name
        <span style="color: #fb4934;">self</span>.salary = salary

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #dfd2b8;">"""Cia parasom kaip norim kad outputtintu mum klase kai iskviesim."""</span>
        <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">"</span>{<span style="color: #fb4934;">self</span>.<span style="color: #fe8019;">id</span>}<span style="color: #b8bb26;"> </span>{<span style="color: #fb4934;">self</span>.name}<span style="color: #b8bb26;"> - $</span>{<span style="color: #fb4934;">self</span>.salary}<span style="color: #b8bb26;">: Hired on </span>{<span style="color: #fb4934;">self</span>.created_date}<span style="color: #b8bb26;">"</span>

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">add_employee</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #dfd2b8;">"""Add employee."""</span>
        Base.metadata.create_all<span style="color: #fe8019;">(</span>engine<span style="color: #fe8019;">)</span>
        Session = sessionmaker<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
        session = Session<span style="color: #fe8019;">()</span>
        session.add<span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>
        session.commit<span style="color: #fe8019;">()</span>
        session.close<span style="color: #fe8019;">()</span>

    @<span style="color: #fe8019;">classmethod</span>
    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">get_all_employees</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #dfd2b8;">"""</span>
<span style="color: #dfd2b8;">        Cia yra kazkas negi tipo documentation???. Cia yra summary line.</span>

<span style="color: #dfd2b8;">        PZZZ, tikrai cia yra documentation. Cia yra description.</span>
<span style="color: #dfd2b8;">        """</span>
        Session = sessionmaker<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
        session = Session<span style="color: #fe8019;">()</span>
        employees = session.query<span style="color: #fe8019;">(</span>Employee<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>
        session.close<span style="color: #fe8019;">()</span>
        <span style="color: #fb4934;">return</span> employees

    @<span style="color: #fe8019;">classmethod</span>
    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">get_employee_by_id</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, <span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>:
        <span style="color: #dfd2b8;">"""</span>
<span style="color: #dfd2b8;">        Cia yra kazkas negi tipo documentation???. Cia yra summary line.</span>

<span style="color: #dfd2b8;">        PZZZ, tikrai cia yra documentation. Cia yra description.</span>
<span style="color: #dfd2b8;">        """</span>
        Session = sessionmaker<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
        session = Session<span style="color: #fe8019;">()</span>
        <span style="color: #928374;"># </span><span style="color: #928374;">Select * from Users Where id = 1 2 3</span>
        employee = session.query<span style="color: #fe8019;">(</span>Employee<span style="color: #fe8019;">)</span>.filter_by<span style="color: #fe8019;">(</span><span style="color: #fe8019;">id</span>=<span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>.first<span style="color: #fe8019;">()</span>
        session.close<span style="color: #fe8019;">()</span>
        <span style="color: #fb4934;">return</span> employee

    @<span style="color: #fe8019;">classmethod</span>
    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">update_employee</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, name, salary<span style="color: #fe8019;">)</span>:
        <span style="color: #dfd2b8;">"""Cia yra kazkas."""</span>
        Session = sessionmaker<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
        session = Session<span style="color: #fe8019;">()</span>

        employee = session.query<span style="color: #fe8019;">(</span>Employee<span style="color: #fe8019;">)</span>.filter_by<span style="color: #fe8019;">(</span><span style="color: #fe8019;">id</span>=<span style="color: #fb4934;">self</span>.<span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>.first<span style="color: #fe8019;">()</span>
        employee.name = name
        employee.salary = salary

        session.commit<span style="color: #fe8019;">()</span>
        session.close<span style="color: #fe8019;">()</span>

    @<span style="color: #fe8019;">classmethod</span>
    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">delete_employee</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #dfd2b8;">"""Cia yra kazkas."""</span>
        Session = sessionmaker<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
        session = Session<span style="color: #fe8019;">()</span>

        session.delete<span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>
        session.commit<span style="color: #fe8019;">()</span>
        session.close<span style="color: #fe8019;">()</span>


<span style="color: #928374;"># </span><span style="color: #928374;">ADD Employee</span>
employee1 = Employee<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Piotr"</span>, 500<span style="color: #fe8019;">)</span>
employee1.add_employee<span style="color: #fe8019;">()</span>


<span style="color: #928374;"># </span><span style="color: #928374;">GET ALL ID</span>
employees = Employee.get_all_employees<span style="color: #fe8019;">()</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>employees<span style="color: #fe8019;">)</span>

zaltis = Employee.get_employee_by_id<span style="color: #fe8019;">(</span>1<span style="color: #fe8019;">)</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>zaltis<span style="color: #fe8019;">)</span>

zaltis.update_employee<span style="color: #fe8019;">(</span>name=<span style="color: #b8bb26;">"Oplia"</span>, salary=5<span style="color: #fe8019;">)</span>
<span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>zaltis<span style="color: #fe8019;">)</span>

zaltis.delete_employee<span style="color: #fe8019;">()</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbdaaf62" class="outline-4">
<h4 id="orgbdaaf62"><span class="section-number-4">6.5.3.</span> 1.6</h4>
<div class="outline-text-4" id="text-6-5-3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #928374;"># </span><span style="color: #928374;">Sukurti program&#261;, kuri:</span>

<span style="color: #928374;"># </span><span style="color: #928374;">Leist&#371; &#303;vesti darbuotojus: vard&#261;, pavard&#281;, gimimo dat&#261;, pareigas,</span>
<span style="color: #928374;"># </span><span style="color: #928374;">atlyginim&#261;, nuo kada dirba (data b&#363;t&#371; nustatoma automati&#353;kai, pagal</span>
<span style="color: #928374;"># </span><span style="color: #928374;">dabartin&#281; dat&#261;)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">Duomenys b&#363;t&#371; saugomi duomen&#371; baz&#279;j&#281;, panaudojant SQLAlchemy ORM (be</span>
<span style="color: #928374;"># </span><span style="color: #928374;">SQL u&#382;klaus&#371;)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">Vartotojas gal&#279;t&#371; &#303;ra&#353;yti, per&#382;i&#363;r&#279;ti, i&#353;trinti ir atnaujinti darbuotojus</span>


<span style="color: #fb4934;">import</span> datetime
<span style="color: #fb4934;">from</span> sqlalchemy <span style="color: #fb4934;">import</span> create_engine
<span style="color: #fb4934;">from</span> sqlalchemy.ext.declarative <span style="color: #fb4934;">import</span> declarative_base
<span style="color: #fb4934;">from</span> sqlalchemy <span style="color: #fb4934;">import</span> Column, Integer, String, DateTime
<span style="color: #fb4934;">from</span> sqlalchemy.orm <span style="color: #fb4934;">import</span> sessionmaker


engine = create_engine<span style="color: #fe8019;">(</span>
    <span style="color: #b8bb26;">"sqlite:////home/arvydas/Dropbox/src/db/sqlAlchemy_1_1.6/employee.db"</span>, echo=<span style="color: #d3869b;">True</span>
<span style="color: #fe8019;">)</span>
Base = declarative_base<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Darbuotojas</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__ = <span style="color: #b8bb26;">"darbuotojas"</span>
    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    vardas = Column<span style="color: #fe8019;">(</span>String<span style="color: #fe8019;">)</span>
    pavarde = Column<span style="color: #fe8019;">(</span>String<span style="color: #fe8019;">)</span>
    gimimo_data = Column<span style="color: #fe8019;">(</span>String<span style="color: #fe8019;">)</span>
    pareigas = Column<span style="color: #fe8019;">(</span>String<span style="color: #fe8019;">)</span>
    atlyginimas = Column<span style="color: #fe8019;">(</span>Integer<span style="color: #fe8019;">)</span>
    dirba_nuo = Column<span style="color: #fe8019;">(</span>DateTime, default=datetime.datetime.utcnow<span style="color: #fe8019;">)</span>

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__init__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, vardas, pavarde, gimimo_data, pareigas, atlyginimas<span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">self</span>.vardas = vardas
        <span style="color: #fb4934;">self</span>.pavarde = pavarde
        <span style="color: #fb4934;">self</span>.gimimo_data = gimimo_data
        <span style="color: #fb4934;">self</span>.pareigas = pareigas
        <span style="color: #fb4934;">self</span>.atlyginimas = atlyginimas

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">"&lt;</span>{<span style="color: #fb4934;">self</span>.vardas}<span style="color: #b8bb26;"> </span>{<span style="color: #fb4934;">self</span>.pavarde}<span style="color: #b8bb26;"> </span>{<span style="color: #fb4934;">self</span>.gimimo_data}<span style="color: #b8bb26;"> </span>{<span style="color: #fb4934;">self</span>.pareigas}<span style="color: #b8bb26;"> </span>{<span style="color: #fb4934;">self</span>.atlyginimas}<span style="color: #b8bb26;"> </span>{<span style="color: #fb4934;">self</span>.dirba_nuo}<span style="color: #b8bb26;">&gt;"</span>


<span style="color: #928374;"># </span><span style="color: #928374;">&#303;ra&#353;yti, per&#382;i&#363;r&#279;ti, i&#353;trinti</span>
Base.metadata.create_all<span style="color: #fe8019;">(</span>engine<span style="color: #fe8019;">)</span>

Session = sessionmaker<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
session = Session<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">prideti_darbuotoja</span><span style="color: #fe8019;">()</span>:
    <span style="color: #dfd2b8;">"""Kuriam funkcija isoreje, nebutina deti i vidu."""</span>
    vardas = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Irasyti vardas: "</span><span style="color: #fe8019;">)</span>
    pavarde = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Irasyti pavarde: "</span><span style="color: #fe8019;">)</span>
    gimimo_data = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Irasyti data gimimo (YYYY-MM-DD): "</span><span style="color: #fe8019;">)</span>
    pareigas = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Irasyti pareigas: "</span><span style="color: #fe8019;">)</span>
    atlyginimas = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Irasyti atlyginima: "</span><span style="color: #fe8019;">)</span>

    <span style="color: #928374;"># </span><span style="color: #928374;">jeigu nenaudojat __init__ KLASEJE</span>
    <span style="color: #928374;"># </span><span style="color: #928374;">naujas_darbuotojas = Darbuotojas(vardas=vardas,pavarde=pavarde, gimimo_data=gimimo_data)</span>

    naujas_darbuotojas = Darbuotojas<span style="color: #fe8019;">(</span>
        vardas, pavarde, gimimo_data, pareigas, atlyginimas
    <span style="color: #fe8019;">)</span>

    <span style="color: #928374;"># </span><span style="color: #928374;">Pridam ir i&#353;saugojam</span>
    session.add<span style="color: #fe8019;">(</span>naujas_darbuotojas<span style="color: #fe8019;">)</span>
    session.commit<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">perziureti_darbuotojus</span><span style="color: #fe8019;">()</span>:
    darbuotojai = session.query<span style="color: #fe8019;">(</span>Darbuotojas<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">for</span> darbuotojas <span style="color: #fb4934;">in</span> darbuotojai:
        <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>darbuotojas<span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">darbuotojas_atnaujinti</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fe8019;">id</span> = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"&#302;ra&#353;yti darbutojo ID: "</span><span style="color: #fe8019;">)</span>

    <span style="color: #928374;">#</span>
    darbuotojas = session.query<span style="color: #fe8019;">(</span>Darbuotojas<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">filter</span><span style="color: #fe8019;">(</span>Darbuotojas.<span style="color: #fe8019;">id</span> == <span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>.first<span style="color: #fe8019;">()</span>

    <span style="color: #928374;"># </span><span style="color: #928374;">Default</span>
    vardas = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Irasyti vardas: "</span><span style="color: #fe8019;">)</span>
    pavarde = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Irasyti pavarde: "</span><span style="color: #fe8019;">)</span>
    gimimo_data = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Irasyti data gimimo (YYYY-MM-DD): "</span><span style="color: #fe8019;">)</span>
    pareigas = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Irasyti pareigas: "</span><span style="color: #fe8019;">)</span>
    atlyginimas = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Irasyti atlyginima: "</span><span style="color: #fe8019;">)</span>

    darbuotojas.vardas = vardas
    darbuotojas.pavarde = pavarde
    darbuotojas.gimimo_data = gimimo_data
    darbuotojas.pareigas = pareigas
    darbuotojas.atlyginimas = atlyginimas

    session.commit<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">darbuotojas_istrinti</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fe8019;">id</span> = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"&#302;ra&#353;yti darbutojo ID: "</span><span style="color: #fe8019;">)</span>
    darbuotojas = session.query<span style="color: #fe8019;">(</span>Darbuotojas<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">filter</span><span style="color: #fe8019;">(</span>Darbuotojas.<span style="color: #fe8019;">id</span> == <span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>.first<span style="color: #fe8019;">()</span>
    session.delete<span style="color: #fe8019;">(</span>darbuotojas<span style="color: #fe8019;">)</span>
    session.commit<span style="color: #fe8019;">()</span>


prideti_darbuotoja<span style="color: #fe8019;">()</span>
perziureti_darbuotojus<span style="color: #fe8019;">()</span>
darbuotojas_atnaujinti<span style="color: #fe8019;">()</span>
darbuotojas_istrinti<span style="color: #fe8019;">()</span>

session.close<span style="color: #fe8019;">()</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org3f15407" class="outline-4">
<h4 id="org3f15407"><span class="section-number-4">6.5.4.</span> 2 užduotis</h4>
<div class="outline-text-4" id="text-6-5-4">
<p>
Perdaryti programą 1 užduotyje, kad ji:
</p>

<p>
Turėtų grafinę sąsają (su ikona ir pavadinimu). Sukurti per Tkinter
</p>

<p>
Leistų įvesti asmenis į duomenų bazę (jų vardą, pavardę, amžių, &#x2026;)
</p>

<p>
Parodytų visų į duomenų bazę įvestų asmenų sąrašą
</p>

<p>
Leistų ištrinti pasirinktą asmenį iš duomenų bazės
</p>

<p>
Leistų paredaguoti įvesto asmens duomenis ir įrašyti atnaujinimus į
duomenų bazę Sukurti paleidžiamąjį programos failą (exe, su ikona)
</p>


<div class="org-src-container">
<pre class="src src-python">
<span style="color: #928374;"># </span><span style="color: #928374;">asmenys.py</span>

<span style="color: #fb4934;">from</span> dbcon <span style="color: #fb4934;">import</span> *
<span style="color: #fb4934;">from</span> tkinter <span style="color: #fb4934;">import</span> Tk, Frame, Label, Entry, Button, Listbox, SINGLE, END

<span style="color: #83a598;">asmuo_edit</span> = <span style="color: #d3869b;">False</span>
get_all_records_list<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">update_fields</span><span style="color: #fe8019;">()</span>:
    boksas.delete<span style="color: #fe8019;">(</span>0, END<span style="color: #fe8019;">)</span>
    boksas.insert<span style="color: #fe8019;">(</span>END, *get_all_records_list<span style="color: #cc241d;">()</span><span style="color: #fe8019;">)</span>
    laukas1.delete<span style="color: #fe8019;">(</span>0, <span style="color: #b8bb26;">"end"</span><span style="color: #fe8019;">)</span>
    laukas2.delete<span style="color: #fe8019;">(</span>0, <span style="color: #b8bb26;">"end"</span><span style="color: #fe8019;">)</span>
    laukas3.delete<span style="color: #fe8019;">(</span>0, <span style="color: #b8bb26;">"end"</span><span style="color: #fe8019;">)</span>
    laukas1.focus<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">ui_add</span><span style="color: #fe8019;">(</span>event<span style="color: #fe8019;">)</span>:
    <span style="color: #fb4934;">global</span> asmuo_edit
    <span style="color: #fb4934;">if</span> <span style="color: #83a598;">asmuo_edit</span>:
        update_record<span style="color: #fe8019;">(</span>asmuo_edit.<span style="color: #fe8019;">id</span>, laukas1.get<span style="color: #cc241d;">()</span>, laukas2.get<span style="color: #cc241d;">()</span>, laukas3.get<span style="color: #cc241d;">()</span><span style="color: #fe8019;">)</span>
        asmuo_edit = <span style="color: #d3869b;">False</span>
    <span style="color: #fb4934;">else</span>:
        add_record<span style="color: #fe8019;">(</span>laukas1.get<span style="color: #cc241d;">()</span>, laukas2.get<span style="color: #cc241d;">()</span>, laukas3.get<span style="color: #cc241d;">()</span><span style="color: #fe8019;">)</span>
    update_fields<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">ui_delete</span><span style="color: #fe8019;">()</span>:
    aktyvus = get_all_records_list<span style="color: #fe8019;">()[</span>boksas.curselection<span style="color: #cc241d;">()[</span>0<span style="color: #cc241d;">]</span><span style="color: #fe8019;">]</span>
    delete_record<span style="color: #fe8019;">(</span>aktyvus.<span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>
    update_fields<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">ui_edit</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">global</span> asmuo_edit
    <span style="color: #83a598;">asmuo_edit</span> = get_all_records_list<span style="color: #fe8019;">()[</span>boksas.curselection<span style="color: #cc241d;">()[</span>0<span style="color: #cc241d;">]</span><span style="color: #fe8019;">]</span>
    update_fields<span style="color: #fe8019;">()</span>
    laukas1.insert<span style="color: #fe8019;">(</span>0, asmuo_edit.name<span style="color: #fe8019;">)</span>
    laukas2.insert<span style="color: #fe8019;">(</span>0, asmuo_edit.surname<span style="color: #fe8019;">)</span>
    laukas3.insert<span style="color: #fe8019;">(</span>0, asmuo_edit.age<span style="color: #fe8019;">)</span>


<span style="color: #928374;"># </span><span style="color: #928374;">Graphic Objects initialization</span>
<span style="color: #83a598;">main_window</span> = Tk<span style="color: #fe8019;">()</span>
main_window.title<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Asmen&#371; katalogas"</span><span style="color: #fe8019;">)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">main_window.iconbitmap(r'asmenys.ico')</span>
<span style="color: #83a598;">top_frame</span> = Frame<span style="color: #fe8019;">(</span>main_window<span style="color: #fe8019;">)</span>
<span style="color: #83a598;">button_frame</span> = Frame<span style="color: #fe8019;">(</span>main_window<span style="color: #fe8019;">)</span>
<span style="color: #83a598;">boksas</span> = Listbox<span style="color: #fe8019;">(</span>button_frame, selectmode=SINGLE<span style="color: #fe8019;">)</span>
boksas.insert<span style="color: #fe8019;">(</span>END, *get_all_records_list<span style="color: #cc241d;">()</span><span style="color: #fe8019;">)</span>
uzrasas1 = Label<span style="color: #fe8019;">(</span>top_frame, text=<span style="color: #b8bb26;">"&#302;veskite asmen&#303;"</span>, width=40<span style="color: #fe8019;">)</span>
laukas1 = Entry<span style="color: #fe8019;">(</span>top_frame<span style="color: #fe8019;">)</span>
laukas1_uzr = Label<span style="color: #fe8019;">(</span>top_frame, text=<span style="color: #b8bb26;">"Vardas"</span><span style="color: #fe8019;">)</span>
laukas2 = Entry<span style="color: #fe8019;">(</span>top_frame<span style="color: #fe8019;">)</span>
laukas2_uzr = Label<span style="color: #fe8019;">(</span>top_frame, text=<span style="color: #b8bb26;">"Pavard&#279;"</span><span style="color: #fe8019;">)</span>
laukas3 = Entry<span style="color: #fe8019;">(</span>top_frame<span style="color: #fe8019;">)</span>
laukas3_uzr = Label<span style="color: #fe8019;">(</span>top_frame, text=<span style="color: #b8bb26;">"Am&#382;ius"</span><span style="color: #fe8019;">)</span>
mygtukas1 = Button<span style="color: #fe8019;">(</span>top_frame, text=<span style="color: #b8bb26;">"&#302;vesti"</span><span style="color: #fe8019;">)</span>
mygtukas1.bind<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"&lt;Button-1&gt;"</span>, ui_add<span style="color: #fe8019;">)</span>
laukas1.bind<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"&lt;Return&gt;"</span>, ui_add<span style="color: #fe8019;">)</span>
laukas2.bind<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"&lt;Return&gt;"</span>, ui_add<span style="color: #fe8019;">)</span>
laukas3.bind<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"&lt;Return&gt;"</span>, ui_add<span style="color: #fe8019;">)</span>
mygtukas2 = Button<span style="color: #fe8019;">(</span>top_frame, text=<span style="color: #b8bb26;">"Redaguoti"</span>, command=ui_edit<span style="color: #fe8019;">)</span>
mygtukas3 = Button<span style="color: #fe8019;">(</span>top_frame, text=<span style="color: #b8bb26;">"I&#353;trinti"</span>, command=ui_delete<span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">Graphic Objects visualization</span>
uzrasas1.grid<span style="color: #fe8019;">(</span>row=0, columnspan=2<span style="color: #fe8019;">)</span>
laukas1_uzr.grid<span style="color: #fe8019;">(</span>row=1, column=0<span style="color: #fe8019;">)</span>
laukas1.grid<span style="color: #fe8019;">(</span>row=1, column=1<span style="color: #fe8019;">)</span>
laukas2_uzr.grid<span style="color: #fe8019;">(</span>row=2, column=0<span style="color: #fe8019;">)</span>
laukas2.grid<span style="color: #fe8019;">(</span>row=2, column=1<span style="color: #fe8019;">)</span>
laukas3_uzr.grid<span style="color: #fe8019;">(</span>row=3, column=0<span style="color: #fe8019;">)</span>
laukas3.grid<span style="color: #fe8019;">(</span>row=3, column=1<span style="color: #fe8019;">)</span>
mygtukas1.grid<span style="color: #fe8019;">(</span>row=4, columnspan=2, sticky=<span style="color: #b8bb26;">"E"</span><span style="color: #fe8019;">)</span>
mygtukas2.grid<span style="color: #fe8019;">(</span>row=4, columnspan=2<span style="color: #fe8019;">)</span>
mygtukas3.grid<span style="color: #fe8019;">(</span>row=4, columnspan=2, sticky=<span style="color: #b8bb26;">"W"</span><span style="color: #fe8019;">)</span>
boksas.pack<span style="color: #fe8019;">()</span>
top_frame.pack<span style="color: #fe8019;">()</span>
button_frame.pack<span style="color: #fe8019;">()</span>
main_window.mainloop<span style="color: #fe8019;">()</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #928374;"># </span><span style="color: #928374;">dbcon.py</span>

<span style="color: #fb4934;">from</span> models.asmuo <span style="color: #fb4934;">import</span> Asmuo

<span style="color: #fb4934;">from</span> sqlalchemy <span style="color: #fb4934;">import</span> create_engine
<span style="color: #fb4934;">from</span> sqlalchemy.orm <span style="color: #fb4934;">import</span> sessionmaker

<span style="color: #83a598;">engine</span> = create_engine<span style="color: #fe8019;">(</span>
    <span style="color: #b8bb26;">"sqlite:////home/arvydas/Dropbox/src/db/sqlAlchemy_2_2/asmenys.db"</span>, echo=<span style="color: #d3869b;">True</span>
<span style="color: #fe8019;">)</span>
Session = sessionmaker<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
session = Session<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">add_record</span><span style="color: #fe8019;">(</span>name, surname, age<span style="color: #fe8019;">)</span>:
    asmuo = Asmuo<span style="color: #fe8019;">(</span>name, surname, age<span style="color: #fe8019;">)</span>
    session.add<span style="color: #fe8019;">(</span>asmuo<span style="color: #fe8019;">)</span>
    session.commit<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">update_record</span><span style="color: #fe8019;">(</span>record_id, newname, newsurname, newage<span style="color: #fe8019;">)</span>:
    asmuo = session.query<span style="color: #fe8019;">(</span>Asmuo<span style="color: #fe8019;">)</span>.get<span style="color: #fe8019;">(</span>record_id<span style="color: #fe8019;">)</span>
    asmuo.name = newname
    asmuo.surname = newsurname
    asmuo.age = newage
    session.commit<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">delete_record</span><span style="color: #fe8019;">(</span>record_id<span style="color: #fe8019;">)</span>:
    asmuo = session.query<span style="color: #fe8019;">(</span>Asmuo<span style="color: #fe8019;">)</span>.get<span style="color: #fe8019;">(</span>record_id<span style="color: #fe8019;">)</span>
    session.delete<span style="color: #fe8019;">(</span>asmuo<span style="color: #fe8019;">)</span>
    session.commit<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">get_all_records_list</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fb4934;">return</span> session.query<span style="color: #fe8019;">(</span>Asmuo<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #928374;"># </span><span style="color: #928374;">inside models folder - asmuo.py</span>

<span style="color: #fb4934;">from</span> sqlalchemy <span style="color: #fb4934;">import</span> *
<span style="color: #fb4934;">from</span> sqlalchemy.ext.declarative <span style="color: #fb4934;">import</span> declarative_base

<span style="color: #83a598;">engine</span> = create_engine<span style="color: #fe8019;">(</span>
    <span style="color: #b8bb26;">"sqlite:////home/arvydas/Dropbox/src/db/sqlAlchemy_2_2/asmenys.db"</span>, echo=<span style="color: #d3869b;">True</span>
<span style="color: #fe8019;">)</span>
Base = declarative_base<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Asmuo</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__ = <span style="color: #b8bb26;">"Asmuo"</span>

    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    name = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Vardas"</span>, String<span style="color: #fe8019;">)</span>
    surname = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Pavard&#279;"</span>, String<span style="color: #fe8019;">)</span>
    age = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Am&#382;ius"</span>, Integer<span style="color: #fe8019;">)</span>

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__init__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span>, name, surname, age<span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">self</span>.name = name
        <span style="color: #fb4934;">self</span>.surname = surname
        <span style="color: #fb4934;">self</span>.age = age

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__str__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">"</span>{<span style="color: #fb4934;">self</span>.name}<span style="color: #b8bb26;">, </span>{<span style="color: #fb4934;">self</span>.surname}<span style="color: #b8bb26;">, </span>{<span style="color: #fb4934;">self</span>.age}<span style="color: #b8bb26;">"</span>


Base.metadata.create_all<span style="color: #fe8019;">(</span>engine<span style="color: #fe8019;">)</span>

</pre>
</div>
</div>
</div>



<div id="outline-container-orgd8c0798" class="outline-4">
<h4 id="orgd8c0798"><span class="section-number-4">6.5.5.</span> 3 užduotis</h4>
<div class="outline-text-4" id="text-6-5-5">
<p>
<a href="https://github.com/robotautas/kursas/tree/master/DB/cars_SQLAlchemy">Atsakymas for reference</a>
</p>

<p>
DB užduotis su mašinom, SQLAlchemy
</p>

<p>
Perdarykite <a href="https://github.com/robotautas/kursas/wiki/DB-Python-u%C5%BEduotys">šioje</a> padarytą programą, naudodami SQLAlchemy. Duomenimis
kol kas neužpildykite, suveskite keletą įrašų ir patikrinkite, ar
veikia. Pirmiausiai reikės susikurti modelį, o jau tuomet pasigaminti
programą, kuri galės vykdyti paiešką.
</p>

<p>
Parašykite programą, kuri užpildys jūsų duomenų bazę eilutėmis iš
duoto csv failo.
</p>

<p>
Parašykite Flask + SQLAlchemy aplikaciją, kuri pagal tą pačią logiką,
kaip ir pirma programėlė, ieškos duomenų bazėje automobilių, pagal
užpildytą html formą.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf605965" class="outline-2">
<h2 id="orgf605965"><span class="section-number-2">7.</span> Lesson 7 - SQLAlchemy 2</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org835b4f6" class="outline-3">
<h3 id="org835b4f6"><span class="section-number-3">7.1.</span> Many To One</h3>
<div class="outline-text-3" id="text-7-1">
<p>
(daug tėvų turi po vieną vaiką. Atvirkščiai - kiekvienas vaikas gali
turėti daug tėvų)
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">from</span> sqlalchemy import <span style="color: #fb4934;">Column</span>, <span style="color: #fabd2f;">Integer</span>, String, ForeignKey, create_engine
<span style="color: #fb4934;">from</span> sqlalchemy.ext.declarative import declarative_base
<span style="color: #fb4934;">from</span> sqlalchemy.orm import relationship, sessionmaker

engine = create_engine<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'sqlite:///many2one_test.db'</span><span style="color: #fe8019;">)</span>
Base = declarative_base<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">class</span> Tevas<span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__ = "tevas"
    id = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span><span style="color: #fabd2f;">Integer</span>, primary_key=<span style="color: #fb4934;">True</span><span style="color: #fe8019;">)</span>
    vardas = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span>"Vardas", String<span style="color: #fe8019;">)</span>
    pavarde = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span>"Pavard&#279;", String<span style="color: #fe8019;">)</span>
    vaikas_id = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span><span style="color: #fabd2f;">Integer</span>, ForeignKey<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'vaikas.id'</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    vaikas = relationship<span style="color: #fe8019;">(</span>"Vaikas"<span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">class</span> Vaikas<span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__ = "vaikas"
    id = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span><span style="color: #fabd2f;">Integer</span>, primary_key=<span style="color: #fb4934;">True</span><span style="color: #fe8019;">)</span>
    vardas = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span>"Vardas", String<span style="color: #fe8019;">)</span>
    pavarde = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span>"Pavard&#279;", String<span style="color: #fe8019;">)</span>
    mokymo_istaiga = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span>"Mokymo &#303;skaita", String<span style="color: #fe8019;">)</span>

Base.metadata.create_all<span style="color: #fe8019;">(</span>engine<span style="color: #fe8019;">)</span>
</pre>
</div>

<ul class="org-ul">
<li><p>
Kaip sukurti sesiją su sukurta DB
</p>

<p>
(engine importuoti iš sqlalchemy ORM klasės, jei ji kitame faile)
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">Session</span> = sessionmaker<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">session</span> = <span style="color: #fb4934;">Session</span><span style="color: #fe8019;">()</span>
</pre>
</div></li>

<li><p>
Kaip įrašyti tėvą ir jo vaiką (<code>C</code> R U D)
</p>

<div class="org-src-container">
<pre class="src src-sqlite">vaikas = Vaikas<span style="color: #fe8019;">(</span>vardas="Vaikas", pavarde="Tevaika", mokymo_istaiga = "&#268;iurlionio gimnazija"<span style="color: #fe8019;">)</span>
tevas = Tevas<span style="color: #fe8019;">(</span>vardas="Tevas", pavarde="Tevaika", vaikas=vaikas<span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">session</span>.<span style="color: #fb4934;">add</span><span style="color: #fe8019;">(</span>tevas<span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">session</span>.<span style="color: #fb4934;">commit</span><span style="color: #fe8019;">()</span>
</pre>
</div></li>

<li>Kaip pakeisti tėvo ar vaiko duomenis (C <code>R U</code> D)</li>
</ul>

<p>
Priskirti naują vaiką:
</p>

<div class="org-src-container">
<pre class="src src-sqlite">vaikas = Vaikas<span style="color: #fe8019;">(</span>vardas="Naujas vaikas", pavarde="Tevaika"<span style="color: #fe8019;">)</span>
tevas = <span style="color: #fb4934;">session</span>.query<span style="color: #fe8019;">(</span>Tevas<span style="color: #fe8019;">)</span>.<span style="color: #fb4934;">get</span><span style="color: #fe8019;">(</span>1<span style="color: #fe8019;">)</span>
tevas.vaikas = vaikas
<span style="color: #fb4934;">session</span>.<span style="color: #fb4934;">commit</span><span style="color: #fe8019;">()</span>
</pre>
</div>

<ul class="org-ul">
<li><p>
Pakeisti tėvo vaiko duomenis:
</p>

<div class="org-src-container">
<pre class="src src-sqlite">tevas = <span style="color: #fb4934;">session</span>.query<span style="color: #fe8019;">(</span>Tevas<span style="color: #fe8019;">)</span>.<span style="color: #fb4934;">get</span><span style="color: #fe8019;">(</span>1<span style="color: #fe8019;">)</span>
tevas.vaikas.pavarde = "Naujapavardaitis"
<span style="color: #fb4934;">session</span>.<span style="color: #fb4934;">commit</span><span style="color: #fe8019;">()</span>
</pre>
</div></li>

<li>Kaip ištrinti tėvą (C R U <code>D</code>)</li>
</ul>

<p>
(vaikas lieka, nes nenustatytas "cascade" trynimas)
</p>

<div class="org-src-container">
<pre class="src src-sqlite">tevas = <span style="color: #fb4934;">session</span>.query<span style="color: #fe8019;">(</span>Tevas<span style="color: #fe8019;">)</span>.<span style="color: #fb4934;">get</span><span style="color: #fe8019;">(</span>1<span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">session</span>.<span style="color: #fb4934;">delete</span><span style="color: #fe8019;">(</span>tevas<span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">session</span>.<span style="color: #fb4934;">commit</span><span style="color: #fe8019;">()</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb99b617" class="outline-3">
<h3 id="orgb99b617"><span class="section-number-3">7.2.</span> One To Many</h3>
<div class="outline-text-3" id="text-7-2">
<p>
(kiekvienas tėvas gali turėti po daug vaikų. Atvirkščiai - kiekvienas
vaikas gali turėti tik vieną tėvą)
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">from</span> sqlalchemy import <span style="color: #fb4934;">Column</span>, <span style="color: #fabd2f;">Integer</span>, String, <span style="color: #fabd2f;">Float</span>, ForeignKey, create_engine
<span style="color: #fb4934;">from</span> sqlalchemy.ext.declarative import declarative_base
<span style="color: #fb4934;">from</span> sqlalchemy.orm import relationship, sessionmaker

engine = create_engine<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'sqlite:///one2many_test.db'</span><span style="color: #fe8019;">)</span>
Base = declarative_base<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">class</span> Tevas<span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__ = "tevas"
    id = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span><span style="color: #fabd2f;">Integer</span>, primary_key=<span style="color: #fb4934;">True</span><span style="color: #fe8019;">)</span>
    vardas = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span>"Vardas", String<span style="color: #fe8019;">)</span>
    pavarde = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span>"Pavard&#279;", String<span style="color: #fe8019;">)</span>
    vaikai = relationship<span style="color: #fe8019;">(</span>"Vaikas"<span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">class</span> Vaikas<span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__ = "vaikas"
    id = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span><span style="color: #fabd2f;">Integer</span>, primary_key=<span style="color: #fb4934;">True</span><span style="color: #fe8019;">)</span>
    vardas = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span>"Vardas", String<span style="color: #fe8019;">)</span>
    pavarde = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span>"Pavard&#279;", String<span style="color: #fe8019;">)</span>
    mokymo_istaiga = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span>"Mokymo &#303;skaita", String<span style="color: #fe8019;">)</span>
    tevas_id = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span><span style="color: #fabd2f;">Integer</span>, ForeignKey<span style="color: #cc241d;">(</span>"tevas.id"<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    tevas = relationship<span style="color: #fe8019;">(</span>"Tevas"<span style="color: #fe8019;">)</span>


Base.metadata.create_all<span style="color: #fe8019;">(</span>engine<span style="color: #fe8019;">)</span>
</pre>
</div>

<ul class="org-ul">
<li>Kaip sukurti sesiją su sukurta DB</li>
</ul>

<p>
(engine importuoti iš sqlalchemy ORM klasės, jei ji kitame faile)
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">Session</span> = sessionmaker<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">session</span> = <span style="color: #fb4934;">Session</span><span style="color: #fe8019;">()</span>
</pre>
</div>

<ul class="org-ul">
<li><p>
Kaip įrašyti tėvą ir jo vaikus (<code>C</code> R U D)
</p>

<div class="org-src-container">
<pre class="src src-sqlite">vaikas = Vaikas<span style="color: #fe8019;">(</span>vardas="Vaikas", pavarde="Vaikaitis"<span style="color: #fe8019;">)</span>
vaikas2 = Vaikas<span style="color: #fe8019;">(</span>vardas="Vaikas 2", pavarde="Vaikaitis 2"<span style="color: #fe8019;">)</span>
tevas = Tevas<span style="color: #fe8019;">(</span>vardas="Tevas", pavarde="Vaikaitis"<span style="color: #fe8019;">)</span>
tevas.vaikai.append<span style="color: #fe8019;">(</span>vaikas<span style="color: #fe8019;">)</span>
tevas.vaikai.append<span style="color: #fe8019;">(</span>vaikas2<span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">session</span>.<span style="color: #fb4934;">add</span><span style="color: #fe8019;">(</span>tevas<span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">session</span>.<span style="color: #fb4934;">commit</span><span style="color: #fe8019;">()</span>
</pre>
</div></li>

<li><p>
Kaip nuskaityti tėvo vaikus (C <code>R</code> U D)
</p>

<div class="org-src-container">
<pre class="src src-sqlite">tevas = <span style="color: #fb4934;">session</span>.query<span style="color: #fe8019;">(</span>Tevas<span style="color: #fe8019;">)</span>.<span style="color: #fb4934;">get</span><span style="color: #fe8019;">(</span>1<span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">for</span> vaikas <span style="color: #fb4934;">in</span> tevas.vaikai:
    print<span style="color: #fe8019;">(</span>vaikas.vardas, vaikas.pavarde<span style="color: #fe8019;">)</span>
</pre>
</div></li>

<li>Kaip redaguoti tėvo vaikus (C R <code>U</code> D)</li>
</ul>

<p>
Redaguojamas pirmo (0) vaiko vardas:
</p>

<div class="org-src-container">
<pre class="src src-sqlite">tevas = <span style="color: #fb4934;">session</span>.query<span style="color: #fe8019;">(</span>Tevas<span style="color: #fe8019;">)</span>.<span style="color: #fb4934;">get</span><span style="color: #fe8019;">(</span>1<span style="color: #fe8019;">)</span>
tevas.vaikai<span style="color: #fe8019;">[</span>0<span style="color: #fe8019;">]</span>.vardas = "Vaikas 1"
<span style="color: #fb4934;">session</span>.<span style="color: #fb4934;">commit</span><span style="color: #fe8019;">()</span>
</pre>
</div>

<ul class="org-ul">
<li>Kaip gauti vaiko tėvą</li>
</ul>

<div class="org-src-container">
<pre class="src src-sqlite">vaikas = <span style="color: #fb4934;">session</span>.query<span style="color: #fe8019;">(</span>Vaikas<span style="color: #fe8019;">)</span>.<span style="color: #fb4934;">get</span><span style="color: #fe8019;">(</span>1<span style="color: #fe8019;">)</span>
print<span style="color: #fe8019;">(</span>vaikas.tevas.vardas<span style="color: #fe8019;">)</span>
</pre>
</div>

<ul class="org-ul">
<li>Kaip ištrinti tėvo vaiką</li>
</ul>

<p>
(vaikas lieka, nes nenustatytas "cascade" trynimas, tik be tėvo ID)
</p>

<div class="org-src-container">
<pre class="src src-sqlite">tevas = <span style="color: #fb4934;">session</span>.query<span style="color: #fe8019;">(</span>Tevas<span style="color: #fe8019;">)</span>.<span style="color: #fb4934;">get</span><span style="color: #fe8019;">(</span>1<span style="color: #fe8019;">)</span>
vaikas1 = tevas.vaikai<span style="color: #fe8019;">[</span>0<span style="color: #fe8019;">]</span>
tevas.vaikai.remove<span style="color: #fe8019;">(</span>vaikas1<span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">session</span>.<span style="color: #fb4934;">commit</span><span style="color: #fe8019;">()</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgeff0d62" class="outline-3">
<h3 id="orgeff0d62"><span class="section-number-3">7.3.</span> Many To Many</h3>
<div class="outline-text-3" id="text-7-3">
<p>
(kiekvienas tėvas gali turėti po daug vaikų. Kiekvienas vaikas gali
turėti po daug tėvų)
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">from</span> sqlalchemy import <span style="color: #fb4934;">Column</span>, <span style="color: #fabd2f;">Integer</span>, String, <span style="color: #fabd2f;">Float</span>, ForeignKey, create_engine, <span style="color: #fb4934;">Table</span>
<span style="color: #fb4934;">from</span> sqlalchemy.ext.declarative import declarative_base
<span style="color: #fb4934;">from</span> sqlalchemy.orm import relationship, sessionmaker

engine = create_engine<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'sqlite:///many2many_test.db'</span><span style="color: #fe8019;">)</span>
Base = declarative_base<span style="color: #fe8019;">()</span>

association_table = <span style="color: #fb4934;">Table</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'association'</span>, Base.metadata,
    <span style="color: #fb4934;">Column</span><span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'tevas_id'</span>, <span style="color: #fabd2f;">Integer</span>, ForeignKey<span style="color: #b8bb26;">(</span><span style="color: #b8bb26;">'tevas.id'</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">)</span>,
    <span style="color: #fb4934;">Column</span><span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'vaikas_id'</span>, <span style="color: #fabd2f;">Integer</span>, ForeignKey<span style="color: #b8bb26;">(</span><span style="color: #b8bb26;">'vaikas.id'</span><span style="color: #b8bb26;">)</span><span style="color: #cc241d;">)</span>
<span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">class</span> Tevas<span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__ = <span style="color: #b8bb26;">'tevas'</span>
    id = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span><span style="color: #fabd2f;">Integer</span>, primary_key=<span style="color: #fb4934;">True</span><span style="color: #fe8019;">)</span>
    vardas = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span>"Vardas", String<span style="color: #fe8019;">)</span>
    pavarde = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span>"Pavard&#279;", String<span style="color: #fe8019;">)</span>
    vaikai = relationship<span style="color: #fe8019;">(</span>"Vaikas", secondary=association_table, back_populates="tevai"<span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">class</span> Vaikas<span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__ = <span style="color: #b8bb26;">'vaikas'</span>
    id = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span><span style="color: #fabd2f;">Integer</span>, primary_key=<span style="color: #fb4934;">True</span><span style="color: #fe8019;">)</span>
    vardas = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span>"Vardas", String<span style="color: #fe8019;">)</span>
    pavarde = <span style="color: #fb4934;">Column</span><span style="color: #fe8019;">(</span>"Pavard&#279;", String<span style="color: #fe8019;">)</span>
    tevai = relationship<span style="color: #fe8019;">(</span>"Tevas", secondary=association_table, back_populates="vaikai"<span style="color: #fe8019;">)</span>

Base.metadata.create_all<span style="color: #fe8019;">(</span>engine<span style="color: #fe8019;">)</span>
</pre>
</div>

<ul class="org-ul">
<li>Kaip sukurti sesiją su sukurta DB</li>
</ul>

<p>
(engine importuoti iš sqlalchemy ORM klasės, jei ji kitame faile)
</p>

<div class="org-src-container">
<pre class="src src-sqlite"><span style="color: #fb4934;">Session</span> = sessionmaker<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">session</span> = <span style="color: #fb4934;">Session</span><span style="color: #fe8019;">()</span>
</pre>
</div>

<ul class="org-ul">
<li>Kaip pridėti daug tėvų su daug vaikų</li>
</ul>

<div class="org-src-container">
<pre class="src src-sqlite">tevas1 = Tevas<span style="color: #fe8019;">(</span>vardas="T&#279;vas", pavarde="T&#279;vaika"<span style="color: #fe8019;">)</span>
tevas2 = Tevas<span style="color: #fe8019;">(</span>vardas="Motina", pavarde="Tevien&#279;"<span style="color: #fe8019;">)</span>
vaikas1 = Vaikas<span style="color: #fe8019;">(</span>vardas="Vaikas", pavarde="T&#279;vaika"<span style="color: #fe8019;">)</span>
vaikas2 = Vaikas<span style="color: #fe8019;">(</span>vardas="Vaik&#279;", pavarde="T&#279;vaikyt&#279;"<span style="color: #fe8019;">)</span>

tevas1.vaikai.append<span style="color: #fe8019;">(</span>vaikas1<span style="color: #fe8019;">)</span>
tevas2.vaikai.append<span style="color: #fe8019;">(</span>vaikas1<span style="color: #fe8019;">)</span>
tevas2.vaikai.append<span style="color: #fe8019;">(</span>vaikas2<span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">session</span>.<span style="color: #fb4934;">add</span><span style="color: #fe8019;">(</span>tevas1<span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">session</span>.<span style="color: #fb4934;">add</span><span style="color: #fe8019;">(</span>tevas2<span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">session</span>.<span style="color: #fb4934;">commit</span><span style="color: #fe8019;">()</span>
</pre>
</div>

<ul class="org-ul">
<li>Kaip peržiūrėti susijusius įrašus</li>
</ul>

<p>
Kaip gauti visus tėvo vaikus:
</p>

<div class="org-src-container">
<pre class="src src-sqlite">tevas = <span style="color: #fb4934;">session</span>.query<span style="color: #fe8019;">(</span>Tevas<span style="color: #fe8019;">)</span>.<span style="color: #fb4934;">get</span><span style="color: #fe8019;">(</span>2<span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">for</span> vaikas <span style="color: #fb4934;">in</span> tevas.vaikai:
    print<span style="color: #fe8019;">(</span>vaikas.vardas, vaikas.pavarde<span style="color: #fe8019;">)</span>n
</pre>
</div>

<ul class="org-ul">
<li>Kaip gauti visus vaiko tėvus:</li>
</ul>

<div class="org-src-container">
<pre class="src src-sqlite">vaikas = <span style="color: #fb4934;">session</span>.query<span style="color: #fe8019;">(</span>Vaikas<span style="color: #fe8019;">)</span>.<span style="color: #fb4934;">get</span><span style="color: #fe8019;">(</span>1<span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">for</span> tevas <span style="color: #fb4934;">in</span> vaikas.tevai:
    print<span style="color: #fe8019;">(</span>tevas.vardas, tevas.pavarde<span style="color: #fe8019;">)</span>n
</pre>
</div>

<ul class="org-ul">
<li>Kaip pakeisti tėvo vaiko įrašą:</li>
</ul>

<div class="org-src-container">
<pre class="src src-sqlite">tevas = <span style="color: #fb4934;">session</span>.query<span style="color: #fe8019;">(</span>Tevas<span style="color: #fe8019;">)</span>.<span style="color: #fb4934;">get</span><span style="color: #fe8019;">(</span>2<span style="color: #fe8019;">)</span>
tevas.vaikai<span style="color: #fe8019;">[</span>0<span style="color: #fe8019;">]</span>.vardas = "Vaikas 1"
<span style="color: #fb4934;">session</span>.<span style="color: #fb4934;">commit</span><span style="color: #fe8019;">()</span>
</pre>
</div>

<ul class="org-ul">
<li>Kaip ištrinti tėvo vaiko įrašą:</li>
</ul>

<div class="org-src-container">
<pre class="src src-sqlite">tevas = <span style="color: #fb4934;">session</span>.query<span style="color: #fe8019;">(</span>Tevas<span style="color: #fe8019;">)</span>.<span style="color: #fb4934;">get</span><span style="color: #fe8019;">(</span>2<span style="color: #fe8019;">)</span>
vaikas1 = tevas.vaikai<span style="color: #fe8019;">[</span>0<span style="color: #fe8019;">]</span>
tevas.vaikai.remove<span style="color: #fe8019;">(</span>vaikas1<span style="color: #fe8019;">)</span>
<span style="color: #fb4934;">session</span>.<span style="color: #fb4934;">commit</span><span style="color: #fe8019;">()</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orga7635da" class="outline-3">
<h3 id="orga7635da"><span class="section-number-3">7.4.</span> Žygimantas examples</h3>
<div class="outline-text-3" id="text-7-4">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #928374;"># </span><span style="color: #928374;">Many To One</span>

<span style="color: #928374;"># </span><span style="color: #928374;">"BlogPost" model has a one-to-many relationship with the "BlogComment" model, while the "BlogComment" model has a many-to-one relationship with the "BlogPost" model.</span>

<span style="color: #928374;"># </span><span style="color: #928374;">from sqlalchemy import Column, Integer, String, Float, ForeignKey, create_engine</span>
<span style="color: #928374;"># </span><span style="color: #928374;">from sqlalchemy.ext.declarative import declarative_base</span>
<span style="color: #928374;"># </span><span style="color: #928374;">from sqlalchemy.orm import relationship, sessionmaker</span>

<span style="color: #928374;"># </span><span style="color: #928374;">engine = create_engine('sqlite:///SQL_Alchemy_2/many2one_test.db')</span>
<span style="color: #928374;"># </span><span style="color: #928374;">Base = declarative_base()</span>

<span style="color: #928374;"># </span><span style="color: #928374;">class BlogPost(Base):</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">__tablename__ = "blog_post"</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">id = Column(Integer, primary_key=True)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">title = Column(String)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">content = Column(String)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">comments = relationship("BlogComment")</span>

<span style="color: #928374;"># </span><span style="color: #928374;">class BlogComment(Base):</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">__tablename__ = "blog_comment"</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">id = Column(Integer, primary_key=True)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">content = Column(String)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">post_id = Column(Integer, ForeignKey("blog_post.id"))</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">post = relationship("BlogPost")</span>

<span style="color: #928374;"># </span><span style="color: #928374;">Base.metadata.create_all(engine)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">Session = sessionmaker(bind=engine)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">session = Session()</span>

<span style="color: #928374;"># </span><span style="color: #928374;">post1 = BlogPost(title='Hello World 3', content='This is my second blog post')</span>
<span style="color: #928374;"># </span><span style="color: #928374;">post2 = BlogPost(title='Hello World 4', content='This is my second blog post')</span>


<span style="color: #928374;"># </span><span style="color: #928374;">comment1 = BlogComment(content="Great Post! 3", post=post1)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">comment2 = BlogComment(content="Sure ! 4", post=post2)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">session.add_all([post1,post2,comment1,comment2])</span>
<span style="color: #928374;"># </span><span style="color: #928374;">session.commit()</span>


<span style="color: #928374;"># </span><span style="color: #928374;">One to Many</span>

<span style="color: #928374;"># </span><span style="color: #928374;">"Employee" model has a many-to-one relationship with the "Department" model, while the "Department" model has a one-to-many relationship with the "Employee" model.</span>

<span style="color: #928374;"># </span><span style="color: #928374;">from sqlalchemy import Column, Integer, String, ForeignKey, create_engine</span>
<span style="color: #928374;"># </span><span style="color: #928374;">from sqlalchemy.ext.declarative import declarative_base</span>
<span style="color: #928374;"># </span><span style="color: #928374;">from sqlalchemy.orm import relationship, sessionmaker</span>

<span style="color: #928374;"># </span><span style="color: #928374;">engine = create_engine('sqlite:///SQL_Alchemy_2/one2many.db')</span>
<span style="color: #928374;"># </span><span style="color: #928374;">Base = declarative_base()</span>

<span style="color: #928374;"># </span><span style="color: #928374;">class Department(Base):</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">__tablename__ = "department"</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">id = Column(Integer, primary_key=True)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">name = Column(String, unique=True)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">employess = relationship("Employee")</span>

<span style="color: #928374;"># </span><span style="color: #928374;">class Employee(Base):</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">__tablename__ = "employee"</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">id = Column(Integer, primary_key=True)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">name = Column(String)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">salary = Column(Integer)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">department_id = Column(Integer, ForeignKey("department.id"))</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">department = relationship("Department")</span>

<span style="color: #928374;"># </span><span style="color: #928374;">Base.metadata.create_all(engine)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">Session = sessionmaker(bind=engine)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">session = Session()</span>

<span style="color: #928374;"># </span><span style="color: #928374;">department1 = Department(name='IT')</span>
<span style="color: #928374;"># </span><span style="color: #928374;">employee = Employee(name="John2", salary=50000, department=department1)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">session.add(department1)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">session.add(employee)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">session.commit()</span>

<span style="color: #928374;"># </span><span style="color: #928374;">Many to Many</span>

<span style="color: #928374;"># </span><span style="color: #928374;">from sqlalchemy import Column, Integer, String, create_engine, Table, ForeignKey</span>
<span style="color: #928374;"># </span><span style="color: #928374;">from sqlalchemy.ext.declarative import declarative_base</span>
<span style="color: #928374;"># </span><span style="color: #928374;">from sqlalchemy.orm import relationship, sessionmaker</span>

<span style="color: #928374;"># </span><span style="color: #928374;">engine = create_engine('sqlite:///SQL_Alchemy_2/many2many_test.db')</span>
<span style="color: #928374;"># </span><span style="color: #928374;">Base = declarative_base()</span>

<span style="color: #928374;"># </span><span style="color: #928374;">#association_table</span>

<span style="color: #928374;"># </span><span style="color: #928374;">#groups_id = Column(Integer, ForeignKey("group.id"))</span>

<span style="color: #928374;"># </span><span style="color: #928374;">user_group_table = Table('user_group', Base.metadata,</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">Column('user_id', Integer, ForeignKey('user.id')),</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">Column('group_id', Integer, ForeignKey('group.id'))</span>
<span style="color: #928374;"># </span><span style="color: #928374;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">class User(Base):</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">__tablename__="user"</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">id = Column(Integer, primary_key=True)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">name = Column(String)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">groups = relationship("Group", secondary=user_group_table)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">class Group(Base):</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">__tablename__="group"</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">id = Column(Integer, primary_key=True)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">name = Column(String)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">users = relationship("User", secondary=user_group_table)</span>



<span style="color: #928374;"># </span><span style="color: #928374;">Base.metadata.create_all(engine)</span>


<span style="color: #928374;"># </span><span style="color: #928374;">Session = sessionmaker(bind=engine)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">session = Session()</span>

<span style="color: #928374;"># </span><span style="color: #928374;">user = User(name="John")</span>

<span style="color: #928374;"># </span><span style="color: #928374;">group1 = Group(name="IT")</span>
<span style="color: #928374;"># </span><span style="color: #928374;">group2 = Group(name="HR")</span>

<span style="color: #928374;"># </span><span style="color: #928374;">user.groups = [group1, group2]</span>

<span style="color: #928374;"># </span><span style="color: #928374;">#group1.users = [user1, user2, user3, .....]</span>

<span style="color: #928374;"># </span><span style="color: #928374;">session.add(user)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">session.add(group1)</span>
<span style="color: #928374;"># </span><span style="color: #928374;">session.add(group2)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">session.commit()</span>


<span style="color: #928374;"># </span><span style="color: #928374;">Many to Many without association</span>


<span style="color: #fb4934;">from</span> sqlalchemy <span style="color: #fb4934;">import</span> Column, Integer, String, create_engine, Table, ForeignKey
<span style="color: #fb4934;">from</span> sqlalchemy.ext.declarative <span style="color: #fb4934;">import</span> declarative_base
<span style="color: #fb4934;">from</span> sqlalchemy.orm <span style="color: #fb4934;">import</span> relationship, sessionmaker

<span style="color: #83a598;">engine</span> = create_engine<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'sqlite:///SQL_Alchemy_2/many2many_without_association.db'</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">Base</span> = declarative_base<span style="color: #fe8019;">()</span>

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">User</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    <span style="color: #83a598;">__tablename__</span>=<span style="color: #b8bb26;">"user"</span>
    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    name = Column<span style="color: #fe8019;">(</span>String<span style="color: #fe8019;">)</span>
    groups = relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Group"</span>, secondary=<span style="color: #b8bb26;">"user_group"</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Group</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__=<span style="color: #b8bb26;">"group"</span>
    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    name = Column<span style="color: #fe8019;">(</span>String<span style="color: #fe8019;">)</span>
    users = relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"User"</span>, secondary=<span style="color: #b8bb26;">"user_group"</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">User_Group</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__=<span style="color: #b8bb26;">"user_group"</span>
    user_id = Column<span style="color: #fe8019;">(</span>Integer, ForeignKey<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'user.id'</span><span style="color: #cc241d;">)</span>, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    group_id = Column<span style="color: #fe8019;">(</span>Integer, ForeignKey<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'group.id'</span><span style="color: #cc241d;">)</span>, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>


Base.metadata.create_all<span style="color: #fe8019;">(</span>engine<span style="color: #fe8019;">)</span>


Session = sessionmaker<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
session = Session<span style="color: #fe8019;">()</span>

new_user = User<span style="color: #fe8019;">(</span>name=<span style="color: #b8bb26;">"John"</span><span style="color: #fe8019;">)</span>
session.add<span style="color: #fe8019;">(</span>new_user<span style="color: #fe8019;">)</span>
session.commit<span style="color: #fe8019;">()</span>

new_group = Group<span style="color: #fe8019;">(</span>name=<span style="color: #b8bb26;">"IT"</span><span style="color: #fe8019;">)</span>
session.add<span style="color: #fe8019;">(</span>new_group<span style="color: #fe8019;">)</span>
session.commit<span style="color: #fe8019;">()</span>

new_User_Group = User_Group<span style="color: #fe8019;">(</span>user_id=new_user.<span style="color: #fe8019;">id</span>, group_id=new_group.<span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>
session.add<span style="color: #fe8019;">(</span>new_User_Group<span style="color: #fe8019;">)</span>
session.commit<span style="color: #fe8019;">()</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #928374;"># </span><span style="color: #928374;">from sqlalchemy import create_engine, Column, Integer, String, ForeignKey, Float, PrimaryKeyConstraint</span>
<span style="color: #928374;"># </span><span style="color: #928374;">from sqlalchemy.ext.declarative import declarative_base</span>
<span style="color: #928374;"># </span><span style="color: #928374;">from sqlalchemy.orm import relationship</span>

<span style="color: #928374;"># </span><span style="color: #928374;">engine = create_engine('sqlite:///SQL_Alchemy_2/order_without_association.db')</span>
<span style="color: #928374;"># </span><span style="color: #928374;">Base = declarative_base()</span>


<span style="color: #928374;"># </span><span style="color: #928374;">class Customer(Base):</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">__tablename__='customer'</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">id = Column(Integer, primary_key=True)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">f_name = Column(String)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">l_name = Column(String)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">email = Column(String, unique=True)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">class Status(Base):</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">__tablename__='status'</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">id = Column(Integer, primary_key=True)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">name = Column(String)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">order = relationship("Order")</span>

<span style="color: #928374;"># </span><span style="color: #928374;">class Order(Base):</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">__tablename__="order"</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">id = Column(Integer, primary_key=True)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">date = Column(String)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">customer_id = Column(Integer, ForeignKey('customer.id'))</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">status_id = Column(Integer, ForeignKey('status.id'))</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">product = relationship("Product", secondary='product_order')</span>

<span style="color: #928374;"># </span><span style="color: #928374;">class Product(Base):</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">__tablename__="product"</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">id = Column(Integer, primary_key=True)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">name = Column(String)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">price = Column(Float)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">order = relationship("Order", secondary='product_order')</span>

<span style="color: #928374;"># </span><span style="color: #928374;">class ProductOrder(Base):</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">__tablename__="product_order"</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">order_id = Column(Integer, ForeignKey('order.id'), primary_key=True)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">product_id = Column(Integer, ForeignKey('product.id'), primary_key=True)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">quantity = Column(Integer)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">Base.metadata.create_all(engine)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">------------------------------------------------</span>

<span style="color: #fb4934;">from</span> sqlalchemy <span style="color: #fb4934;">import</span> create_engine, Column, Integer, String, ForeignKey, Float, PrimaryKeyConstraint, Table
<span style="color: #fb4934;">from</span> sqlalchemy.ext.declarative <span style="color: #fb4934;">import</span> declarative_base
<span style="color: #fb4934;">from</span> sqlalchemy.orm <span style="color: #fb4934;">import</span> relationship

<span style="color: #83a598;">engine</span> = create_engine<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'sqlite:///SQL_Alchemy_2/order_with_association.db'</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">Base</span> = declarative_base<span style="color: #fe8019;">()</span>

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Customer</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    <span style="color: #83a598;">__tablename__</span>=<span style="color: #b8bb26;">'customer'</span>
    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    f_name = Column<span style="color: #fe8019;">(</span>String<span style="color: #fe8019;">)</span>
    l_name = Column<span style="color: #fe8019;">(</span>String<span style="color: #fe8019;">)</span>
    email = Column<span style="color: #fe8019;">(</span>String, unique=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    order = relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Order"</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Status</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__=<span style="color: #b8bb26;">'status'</span>
    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    name = Column<span style="color: #fe8019;">(</span>String<span style="color: #fe8019;">)</span>
    order = relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Order"</span><span style="color: #fe8019;">)</span>

ProductOrder = Table<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'product_order'</span>, Base.metadata,
        Column<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'order_id'</span>, Integer, ForeignKey<span style="color: #b8bb26;">(</span><span style="color: #b8bb26;">'order.id'</span><span style="color: #b8bb26;">)</span>, primary_key=<span style="color: #d3869b;">True</span><span style="color: #cc241d;">)</span>,
        Column<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'product_id'</span>, Integer, ForeignKey<span style="color: #b8bb26;">(</span><span style="color: #b8bb26;">'product.id'</span><span style="color: #b8bb26;">)</span>, primary_key=<span style="color: #d3869b;">True</span><span style="color: #cc241d;">)</span>,
        Column<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'quantity'</span>, Integer<span style="color: #cc241d;">)</span>
<span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Product</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__=<span style="color: #b8bb26;">"product"</span>
    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    name = Column<span style="color: #fe8019;">(</span>String<span style="color: #fe8019;">)</span>
    price = Column<span style="color: #fe8019;">(</span>Float<span style="color: #fe8019;">)</span>
    order = relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Order"</span>, secondary=<span style="color: #b8bb26;">'product_order'</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Order</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__=<span style="color: #b8bb26;">"order"</span>
    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    date = Column<span style="color: #fe8019;">(</span>String<span style="color: #fe8019;">)</span>
    customer_id = Column<span style="color: #fe8019;">(</span>Integer, ForeignKey<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'customer.id'</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    status_id = Column<span style="color: #fe8019;">(</span>Integer, ForeignKey<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'status.id'</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    product = relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Product"</span>, secondary=ProductOrder<span style="color: #fe8019;">)</span>


Base.metadata.create_all<span style="color: #fe8019;">(</span>engine<span style="color: #fe8019;">)</span>

</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #fb4934;">from</span> sqlalchemy <span style="color: #fb4934;">import</span> create_engine, Column, Integer, String, Float, ForeignKey, Table
<span style="color: #fb4934;">from</span> sqlalchemy.orm <span style="color: #fb4934;">import</span> sessionmaker, relationship
<span style="color: #fb4934;">from</span> sqlalchemy.ext.declarative <span style="color: #fb4934;">import</span> declarative_base

<span style="color: #83a598;">Base</span> = declarative_base<span style="color: #fe8019;">()</span>
<span style="color: #83a598;">engine</span> = create_engine<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'sqlite:///SQL_Alchemy_2/order_with_association.db'</span><span style="color: #fe8019;">)</span>

<span style="color: #83a598;">OrderProduct</span> = Table<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'order_product'</span>, Base.metadata,
    Column<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'product_id'</span>, Integer, ForeignKey<span style="color: #b8bb26;">(</span><span style="color: #b8bb26;">'product.id'</span><span style="color: #b8bb26;">)</span>, primary_key=<span style="color: #d3869b;">True</span><span style="color: #cc241d;">)</span>,
    Column<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'order_id'</span>, Integer, ForeignKey<span style="color: #b8bb26;">(</span><span style="color: #b8bb26;">'order.id'</span><span style="color: #b8bb26;">)</span>, primary_key=<span style="color: #d3869b;">True</span><span style="color: #cc241d;">)</span>,
    Column<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'quantity'</span>, Integer<span style="color: #cc241d;">)</span>
<span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Customer</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__=<span style="color: #b8bb26;">'customer'</span>
    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    f_name = Column<span style="color: #fe8019;">(</span>String<span style="color: #fe8019;">)</span>
    l_name = Column<span style="color: #fe8019;">(</span>String<span style="color: #fe8019;">)</span>
    email = Column<span style="color: #fe8019;">(</span>String<span style="color: #fe8019;">)</span>
    orders = relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Order"</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Order</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__=<span style="color: #b8bb26;">'order'</span>
    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    customer_id = Column<span style="color: #fe8019;">(</span>Integer, ForeignKey<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'customer.id'</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    date = Column<span style="color: #fe8019;">(</span>String<span style="color: #fe8019;">)</span>
    status_id = Column<span style="color: #fe8019;">(</span>Integer, ForeignKey<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'status.id'</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    products = relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Product"</span>, secondary=OrderProduct, back_populates=<span style="color: #b8bb26;">"orders"</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Status</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__=<span style="color: #b8bb26;">'status'</span>
    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    name = Column<span style="color: #fe8019;">(</span>String<span style="color: #fe8019;">)</span>
    orders = relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Order"</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Product</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__=<span style="color: #b8bb26;">'product'</span>
    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    name = Column<span style="color: #fe8019;">(</span>String<span style="color: #fe8019;">)</span>
    price = Column<span style="color: #fe8019;">(</span>Float<span style="color: #fe8019;">)</span>
    orders = relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Order"</span>, secondary=OrderProduct, back_populates=<span style="color: #b8bb26;">"products"</span><span style="color: #fe8019;">)</span>


Base.metadata.create_all<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
Session = sessionmaker<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
session = Session<span style="color: #fe8019;">()</span>

<span style="color: #928374;"># </span><span style="color: #928374;">add buyer</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">add_buyer</span><span style="color: #fe8019;">(</span>f_name, l_name, email<span style="color: #fe8019;">)</span>:
    customer = Customer<span style="color: #fe8019;">(</span>f_name=f_name, l_name=l_name, email=email<span style="color: #fe8019;">)</span>
    session.add<span style="color: #fe8019;">(</span>customer<span style="color: #fe8019;">)</span>
    session.commit<span style="color: #fe8019;">()</span>
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>f<span style="color: #b8bb26;">"Buyer </span>{f_name}<span style="color: #b8bb26;"> </span>{l_name}<span style="color: #b8bb26;"> with email </span>{email}<span style="color: #b8bb26;"> has been added."</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">Add a product</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">add_product</span><span style="color: #fe8019;">(</span>name, price<span style="color: #fe8019;">)</span>:
    product = Product<span style="color: #fe8019;">(</span>name=name, price=price<span style="color: #fe8019;">)</span>
    session.add<span style="color: #fe8019;">(</span>product<span style="color: #fe8019;">)</span>
    session.commit<span style="color: #fe8019;">()</span>
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>f<span style="color: #b8bb26;">"Product </span>{name}<span style="color: #b8bb26;"> with price </span>{price}<span style="color: #b8bb26;"> has been added."</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">Add status</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">add_status</span><span style="color: #fe8019;">(</span>name<span style="color: #fe8019;">)</span>:
    status = Status<span style="color: #fe8019;">(</span>name=name<span style="color: #fe8019;">)</span>
    session.add<span style="color: #fe8019;">(</span>status<span style="color: #fe8019;">)</span>
    session.commit<span style="color: #fe8019;">()</span>
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>f<span style="color: #b8bb26;">"status </span>{name}<span style="color: #b8bb26;"> has been added."</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">add_order</span><span style="color: #fe8019;">(</span>customer_id, date, status_id<span style="color: #fe8019;">)</span>:
    order = Order<span style="color: #fe8019;">(</span>customer_id=customer_id, date=date, status_id=status_id<span style="color: #fe8019;">)</span>
    session.add<span style="color: #fe8019;">(</span>order<span style="color: #fe8019;">)</span>
    session.commit<span style="color: #fe8019;">()</span>
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>f<span style="color: #b8bb26;">"Order with customer_id </span>{customer_id}<span style="color: #b8bb26;">, date </span>{date}<span style="color: #b8bb26;">, and status_id </span>{status_id}<span style="color: #b8bb26;"> has been added."</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">Withdraw order by id</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">withdraw_order</span><span style="color: #fe8019;">(</span>order_id<span style="color: #fe8019;">)</span>:
    session.query<span style="color: #fe8019;">(</span>Order<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">filter</span><span style="color: #fe8019;">(</span>Order.<span style="color: #fe8019;">id</span> == order_id<span style="color: #fe8019;">)</span>.delete<span style="color: #fe8019;">()</span>
    session.commit<span style="color: #fe8019;">()</span>
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>f<span style="color: #b8bb26;">"Order with id </span>{order_id}<span style="color: #b8bb26;"> has been withdrawn."</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">Change order status by order id</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">change_order_status</span><span style="color: #fe8019;">(</span>order_id, status_id<span style="color: #fe8019;">)</span>:
    session.query<span style="color: #fe8019;">(</span>Order<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">filter</span><span style="color: #fe8019;">(</span>Order.<span style="color: #fe8019;">id</span> == order_id<span style="color: #fe8019;">)</span>.update<span style="color: #fe8019;">(</span><span style="color: #cc241d;">{</span>Order.status_id: status_id<span style="color: #cc241d;">}</span><span style="color: #fe8019;">)</span>
    session.commit<span style="color: #fe8019;">()</span>
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>f<span style="color: #b8bb26;">"Order status of order with id </span>{order_id}<span style="color: #b8bb26;"> has been changed to </span>{status_id}<span style="color: #b8bb26;">."</span><span style="color: #fe8019;">)</span>

<span style="color: #928374;">#</span><span style="color: #928374;">Add product to order</span>
<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">add_product_to_order</span><span style="color: #fe8019;">(</span>product_id, order_id, quantity<span style="color: #fe8019;">)</span>:
    session.execute<span style="color: #fe8019;">(</span>OrderProduct.insert<span style="color: #cc241d;">()</span>.values<span style="color: #cc241d;">(</span>product_id=product_id, order_id=order_id, quantity=quantity<span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    session.commit<span style="color: #fe8019;">()</span>
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>f<span style="color: #b8bb26;">"Product with id </span>{product_id}<span style="color: #b8bb26;"> has been added to order"</span><span style="color: #fe8019;">)</span>


<span style="color: #928374;"># </span><span style="color: #928374;"># alternative</span>
<span style="color: #928374;"># </span><span style="color: #928374;">def add_product_to_order(product_id, order_id, quantity):</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">order_product = OrderProduct(product_id=product_id, order_id=order_id, quantity=quantity)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">session.add(order_product)</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">session.commit()</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">print(f"Product with id {product_id} has been added to order with id {order_id} with quantity {quantity}.")</span>


<span style="color: #928374;"># </span><span style="color: #928374;">add_buyer("Jurgas","Jurgelis","Test@gmail.com")</span>

<span style="color: #928374;"># </span><span style="color: #928374;">add_product("Telefonas5",450)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">add_status("Completed")</span>
<span style="color: #928374;"># </span><span style="color: #928374;">add_status("In Progress")</span>

<span style="color: #928374;"># </span><span style="color: #928374;">add_order(1,"2022-01-25",2)</span>

<span style="color: #928374;"># </span><span style="color: #928374;">add_product_to_order(4,1,450)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc0e93c9" class="outline-3">
<h3 id="orgc0e93c9"><span class="section-number-3">7.5.</span> Užduotys</h3>
<div class="outline-text-3" id="text-7-5">
</div>
<div id="outline-container-orgd90bde1" class="outline-4">
<h4 id="orgd90bde1"><span class="section-number-4">7.5.1.</span> <a href="https://github.com/robotautas/kursas/wiki/ORM-2-u%C5%BEduotis">1 užduotis</a></h4>
<div class="outline-text-4" id="text-7-5-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #928374;"># </span><span style="color: #928374;">crud.py</span>

<span style="color: #fb4934;">from</span> sqlalchemy.orm <span style="color: #fb4934;">import</span> sessionmaker
<span style="color: #fb4934;">from</span> model <span style="color: #fb4934;">import</span> Order, Customer, Product, Status, OrderProduct, engine

<span style="color: #83a598;">Session</span> = sessionmaker<span style="color: #fe8019;">(</span>bind=engine<span style="color: #fe8019;">)</span>
session = Session<span style="color: #fe8019;">()</span>

<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">options_list</span><span style="color: #fe8019;">(</span>class_<span style="color: #fe8019;">)</span>:
    options = session.query<span style="color: #fe8019;">(</span>class_<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">for</span> i <span style="color: #fb4934;">in</span> options:
        <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>i, end=<span style="color: #b8bb26;">' '</span><span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">create_customer</span><span style="color: #fe8019;">()</span>:
    f_name = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"First Name: "</span><span style="color: #fe8019;">)</span>
    l_name = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Last Name: "</span><span style="color: #fe8019;">)</span>
    email = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Email: "</span><span style="color: #fe8019;">)</span>
    customer = Customer<span style="color: #fe8019;">(</span>f_name=f_name, l_name=l_name, email=email<span style="color: #fe8019;">)</span>
    session.add<span style="color: #fe8019;">(</span>customer<span style="color: #fe8019;">)</span>
    session.commit<span style="color: #fe8019;">()</span>
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'created!\n'</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">create_status</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Existing statuses:'</span><span style="color: #fe8019;">)</span>
    options_list<span style="color: #fe8019;">(</span>Status<span style="color: #fe8019;">)</span>
    name = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"\nEnter new status: "</span><span style="color: #fe8019;">)</span>
    status = Status<span style="color: #fe8019;">(</span>name=name<span style="color: #fe8019;">)</span>
    session.add<span style="color: #fe8019;">(</span>status<span style="color: #fe8019;">)</span>
    session.commit<span style="color: #fe8019;">()</span>
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'created!\n'</span><span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">create_product</span><span style="color: #fe8019;">()</span>:
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Existing products:'</span><span style="color: #fe8019;">)</span>
    options_list<span style="color: #fe8019;">(</span>Product<span style="color: #fe8019;">)</span>
    name = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"\nName: "</span><span style="color: #fe8019;">)</span>
    price = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Price: "</span><span style="color: #fe8019;">)</span>
    product = Product<span style="color: #fe8019;">(</span>name=name, price=price<span style="color: #fe8019;">)</span>
    session.add<span style="color: #fe8019;">(</span>product<span style="color: #fe8019;">)</span>
    session.commit<span style="color: #fe8019;">()</span>
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'created!\n'</span><span style="color: #fe8019;">)</span>


<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">create_order</span><span style="color: #fe8019;">()</span>:
    options_list<span style="color: #fe8019;">(</span>Customer<span style="color: #fe8019;">)</span>
    customer_id = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"\nCustomer Id: "</span><span style="color: #fe8019;">)</span>
    order = Order<span style="color: #fe8019;">(</span>customer_id=customer_id, status_id=1<span style="color: #fe8019;">)</span>
    session.add<span style="color: #fe8019;">(</span>order<span style="color: #fe8019;">)</span>
    session.commit<span style="color: #fe8019;">()</span>
    last_order_id = session.query<span style="color: #fe8019;">(</span>Order<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()[</span>-1<span style="color: #fe8019;">]</span>.<span style="color: #fe8019;">id</span>
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Products available:'</span><span style="color: #fe8019;">)</span>
    options_list<span style="color: #fe8019;">(</span>Product<span style="color: #fe8019;">)</span>
    <span style="color: #fb4934;">while</span> <span style="color: #d3869b;">True</span>:
        product_id = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'\nProduct Id: '</span><span style="color: #fe8019;">)</span>
        quantity = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Quantity: '</span><span style="color: #fe8019;">)</span>
        <span style="color: #fb4934;">if</span> product_id <span style="color: #fb4934;">and</span> quantity:
            order_product = OrderProduct<span style="color: #fe8019;">(</span>order_id=last_order_id, product_id=product_id, quantity=quantity<span style="color: #fe8019;">)</span>
            session.add<span style="color: #fe8019;">(</span>order_product<span style="color: #fe8019;">)</span>
            session.commit<span style="color: #fe8019;">()</span>
        <span style="color: #fb4934;">else</span>:
            <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'created!\n'</span><span style="color: #fe8019;">)</span>
            <span style="color: #fb4934;">break</span>


<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">get_order</span><span style="color: #fe8019;">()</span>:
    last_order_id = session.query<span style="color: #fe8019;">(</span>Order<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()[</span>-1<span style="color: #fe8019;">]</span>.<span style="color: #fe8019;">id</span>
    id_ = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span>f<span style="color: #b8bb26;">'Order id (1-</span>{last_order_id}<span style="color: #b8bb26;">): '</span><span style="color: #fe8019;">)</span>
    order = session.query<span style="color: #fe8019;">(</span>Order<span style="color: #fe8019;">)</span>.get<span style="color: #fe8019;">(</span>id_<span style="color: #fe8019;">)</span>
    order_lines = session.query<span style="color: #fe8019;">(</span>OrderProduct<span style="color: #fe8019;">)</span>.filter_by<span style="color: #fe8019;">(</span>order_id=order.<span style="color: #fe8019;">id</span><span style="color: #fe8019;">)</span>
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>f<span style="color: #b8bb26;">'\nOrder #</span>{id_}<span style="color: #b8bb26;">, customer - </span>{order.customer.f_name}<span style="color: #b8bb26;"> </span>{order.customer.l_name}<span style="color: #b8bb26;">:'</span><span style="color: #fe8019;">)</span>
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'\nProduct\tQty\tPrice\tSum'</span><span style="color: #fe8019;">)</span>
    total = 0
    <span style="color: #fb4934;">for</span> line <span style="color: #fb4934;">in</span> order_lines:
        <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>f<span style="color: #b8bb26;">'</span>{line.product.name}<span style="color: #b8bb26;">\t</span>{line.quantity}<span style="color: #b8bb26;">\t</span>{line.product.price}<span style="color: #b8bb26;">\t</span>{line.quantity * line.product.price}<span style="color: #b8bb26;">'</span><span style="color: #fe8019;">)</span>
        total += line.product.price * line.quantity
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>f<span style="color: #b8bb26;">'\n\t\tTotal:\t</span>{total}<span style="color: #b8bb26;">'</span><span style="color: #fe8019;">)</span>
    <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span>f<span style="color: #b8bb26;">'\t\tStatus:\t</span>{order.status.name}<span style="color: #b8bb26;">'</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">change_status</span><span style="color: #fe8019;">()</span>:
    last_order_id = session.query<span style="color: #fe8019;">(</span>Order<span style="color: #fe8019;">)</span>.<span style="color: #fe8019;">all</span><span style="color: #fe8019;">()[</span>-1<span style="color: #fe8019;">]</span>.<span style="color: #fe8019;">id</span>
    id_ = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span>f<span style="color: #b8bb26;">'Order id (1-</span>{last_order_id}<span style="color: #b8bb26;">): '</span><span style="color: #fe8019;">)</span>
    order = session.query<span style="color: #fe8019;">(</span>Order<span style="color: #fe8019;">)</span>.get<span style="color: #fe8019;">(</span>id_<span style="color: #fe8019;">)</span>
    options_list<span style="color: #fe8019;">(</span>Status<span style="color: #fe8019;">)</span>
    status_id = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'\nSet status id:'</span><span style="color: #fe8019;">)</span>
    order.status_id = status_id
    session.commit<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">while</span> <span style="color: #d3869b;">True</span>:
    choice = <span style="color: #fe8019;">input</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'c Add Customer | p Add Product | s Add Status | o Add Order | g Get Order | cs Change Status | q Quit\nChoose action: '</span><span style="color: #fe8019;">)</span>
    <span style="color: #fb4934;">if</span> choice == <span style="color: #b8bb26;">'c'</span>:
        create_customer<span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">elif</span> choice == <span style="color: #b8bb26;">'p'</span>:
        create_product<span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">elif</span> choice == <span style="color: #b8bb26;">'s'</span>:
        create_status<span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">elif</span> choice == <span style="color: #b8bb26;">'o'</span>:
        create_order<span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">elif</span> choice == <span style="color: #b8bb26;">'g'</span>:
        get_order<span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">elif</span> choice == <span style="color: #b8bb26;">'cs'</span>:
        change_status<span style="color: #fe8019;">()</span>
    <span style="color: #fb4934;">elif</span> choice == <span style="color: #b8bb26;">'q'</span>:
        <span style="color: #fb4934;">break</span>
    <span style="color: #fb4934;">else</span>:
        <span style="color: #fe8019;">print</span><span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'Wrong input!'</span><span style="color: #fe8019;">)</span>

session.close<span style="color: #fe8019;">()</span>
</pre>
</div>


<div class="org-src-container">
<pre class="src src-python"><span style="color: #928374;"># </span><span style="color: #928374;">model.py</span>

<span style="color: #fb4934;">import</span> datetime
<span style="color: #fb4934;">from</span> sqlalchemy <span style="color: #fb4934;">import</span> Column, Integer, String, Float, DateTime, ForeignKey, Table, create_engine
<span style="color: #fb4934;">from</span> sqlalchemy.ext.declarative <span style="color: #fb4934;">import</span> declarative_base
<span style="color: #fb4934;">from</span> sqlalchemy.orm <span style="color: #fb4934;">import</span> relationship, sessionmaker

<span style="color: #83a598;">engine</span> = create_engine<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">'sqlite:///orders.db'</span><span style="color: #fe8019;">)</span>
<span style="color: #83a598;">Base</span> = declarative_base<span style="color: #fe8019;">()</span>


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Customer</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    <span style="color: #83a598;">__tablename__</span> = <span style="color: #b8bb26;">"customer"</span>
    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    f_name = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"f_name"</span>, String<span style="color: #fe8019;">)</span>
    l_name = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"l_name"</span>, String<span style="color: #fe8019;">)</span>
    email = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"email"</span>, String<span style="color: #fe8019;">)</span>
    orders = relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Order"</span><span style="color: #fe8019;">)</span>

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">'</span>{<span style="color: #fb4934;">self</span>.<span style="color: #fe8019;">id</span>}<span style="color: #b8bb26;"> </span>{<span style="color: #fb4934;">self</span>.f_name}<span style="color: #b8bb26;"> </span>{<span style="color: #fb4934;">self</span>.l_name}<span style="color: #b8bb26;">'</span>


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Status</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__ = <span style="color: #b8bb26;">"status"</span>
    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    name = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"name"</span>, String<span style="color: #fe8019;">)</span>
    orders = relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Order"</span><span style="color: #fe8019;">)</span>

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">'</span>{<span style="color: #fb4934;">self</span>.<span style="color: #fe8019;">id</span>}<span style="color: #b8bb26;"> </span>{<span style="color: #fb4934;">self</span>.name}<span style="color: #b8bb26;">'</span>


<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Product</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__ = <span style="color: #b8bb26;">"product"</span>
    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    name = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"name"</span>, String<span style="color: #fe8019;">)</span>
    price = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"price"</span>, Float<span style="color: #fe8019;">)</span>

    <span style="color: #fb4934;">def</span> <span style="color: #b8bb26;">__repr__</span><span style="color: #fe8019;">(</span><span style="color: #fb4934;">self</span><span style="color: #fe8019;">)</span>:
        <span style="color: #fb4934;">return</span> f<span style="color: #b8bb26;">'</span>{<span style="color: #fb4934;">self</span>.<span style="color: #fe8019;">id</span>}<span style="color: #b8bb26;"> </span>{<span style="color: #fb4934;">self</span>.name}<span style="color: #b8bb26;">'</span>

<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">Order</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__ = <span style="color: #b8bb26;">"order_"</span>
    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    date = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"date_"</span>, DateTime, default=datetime.datetime.utcnow<span style="color: #fe8019;">)</span>
    customer_id = Column<span style="color: #fe8019;">(</span>Integer, ForeignKey<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">"customer.id"</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    status_id = Column<span style="color: #fe8019;">(</span>Integer, ForeignKey<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">"status.id"</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    customer = relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Customer"</span><span style="color: #fe8019;">)</span>
    status = relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Status"</span><span style="color: #fe8019;">)</span>



<span style="color: #fb4934;">class</span> <span style="color: #fabd2f;">OrderProduct</span><span style="color: #fe8019;">(</span>Base<span style="color: #fe8019;">)</span>:
    __tablename__=<span style="color: #b8bb26;">'order_product'</span>
    <span style="color: #fe8019;">id</span> = Column<span style="color: #fe8019;">(</span>Integer, primary_key=<span style="color: #d3869b;">True</span><span style="color: #fe8019;">)</span>
    order_id = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"order_id"</span>, Integer, ForeignKey<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'order_.id'</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    product_id = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"project_id"</span>, Integer, ForeignKey<span style="color: #cc241d;">(</span><span style="color: #b8bb26;">'product.id'</span><span style="color: #cc241d;">)</span><span style="color: #fe8019;">)</span>
    quantity = Column<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"quantity"</span>, Integer<span style="color: #fe8019;">)</span>
    order = relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Order"</span><span style="color: #fe8019;">)</span>
    product = relationship<span style="color: #fe8019;">(</span><span style="color: #b8bb26;">"Product"</span><span style="color: #fe8019;">)</span>

<span style="color: #fb4934;">if</span> <span style="color: #fe8019;">__name__</span> == <span style="color: #b8bb26;">"__main__"</span>:
    Base.metadata.create_all<span style="color: #fe8019;">(</span>engine<span style="color: #fe8019;">)</span>


<span style="color: #928374;"># </span><span style="color: #928374;">email = Column(Integer, ForeignKey('vaikas.id'))</span>
<span style="color: #928374;">#     </span><span style="color: #928374;">vaikas = relationship("Vaikas")</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- bootstrap scripts -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script> -->
        </body>

</html>
